[{"id":"8abcb9c4.969e58","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"49f88b4f.625b74","type":"tab","label":"Flow 3","disabled":false,"info":""},{"id":"740b003f.0a2b","type":"tab","label":"Flow 6","disabled":false,"info":""},{"id":"15c9eaa7.3c0665","type":"tab","label":"Flow 7","disabled":false,"info":""},{"id":"f4c13dae.1fd7a","type":"tab","label":"Flow 8","disabled":false,"info":""},{"id":"740c75b5.a1e69c","type":"tab","label":"zigbee2mqtt","disabled":true,"info":""},{"id":"c4829f93.87cba","type":"tab","label":"Flow 10","disabled":false,"info":""},{"id":"4bc40f.33b24bf","type":"tab","label":"myhome","disabled":false,"info":""},{"id":"af357553.2f0528","type":"tab","label":"Flow 9","disabled":true,"info":""},{"id":"dfb681c3.814b5","type":"tab","label":"Flow 11","disabled":true,"info":""},{"id":"edd42ef7.16d9c","type":"tab","label":"Flow 13","disabled":true,"info":""},{"id":"1635ef5e.c89941","type":"tab","label":"Flow 14","disabled":false,"info":""},{"id":"a8befc30.c457","type":"tab","label":"Flow 17","disabled":false,"info":""},{"id":"67731296.6f183c","type":"tab","label":"Flow 18","disabled":false,"info":""},{"id":"6378da21.c9a314","type":"tab","label":"Flow 19","disabled":false,"info":""},{"id":"5b0c3533.c576cc","type":"tab","label":"Array","disabled":false,"info":""},{"id":"9ab1c0c7.d7f57","type":"tab","label":"Flow 2","disabled":false,"info":""},{"id":"f4459a62.9c06c8","type":"tab","label":"Flow 4","disabled":false,"info":""},{"id":"97eec2ac.3243f","type":"tab","label":"Flow 5","disabled":false,"info":""},{"id":"4a63d848.fb1dd8","type":"tab","label":"Flow 12","disabled":false,"info":""},{"id":"3d8c54f9.690a4c","type":"subflow","name":"WeekEnd","info":"","category":"","in":[{"x":180,"y":380,"wires":[{"id":"325ad707.8f5d88"}]}],"out":[{"x":1060,"y":340,"wires":[{"id":"d36b0ff8.9e958","port":0}]},{"x":1060,"y":420,"wires":[{"id":"d36b0ff8.9e958","port":1}]}],"env":[],"color":"#DDAA99","status":{"x":540,"y":480,"wires":[{"id":"141b4fdc.fac61","port":0}]}},{"id":"e04c9865.8f9be8","type":"subflow","name":"Subflow 1","info":"","category":"","in":[{"x":60,"y":140,"wires":[{"id":"412471ef.4b193"}]}],"out":[{"x":1040,"y":140,"wires":[{"id":"e8ec1e52.f3771","port":0}]}],"env":[],"color":"#DDAA99","status":{"x":360,"y":80,"wires":[{"id":"42c3002.e364d","port":0},{"id":"c21e00ba.b6976","port":0}]}},{"id":"d790ae81.b58ba","type":"ui_tab","z":"","name":"Home","icon":"home","order":2},{"id":"8b7266fe.98fd18","type":"ui_group","z":"","name":"Default","tab":"d790ae81.b58ba","order":1,"disp":true,"width":"6"},{"id":"8d3bbffb.1bda5","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"3c076744.c6a638","type":"ui_spacer","name":"spacer","group":"8b7266fe.98fd18","order":1,"width":1,"height":1},{"id":"672ff1be.ce75d","type":"websocket-client","z":"","path":"wss://echo.websocket.org","tls":"","wholemsg":"false"},{"id":"32def38f.02e0cc","type":"samsung-tv","z":"","name":"SamsungTV","address":"192.168.1.15"},{"id":"299502c0.c3cdae","type":"mqtt-broker","z":"","name":"MQTT-localhost","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"a556504d.417f6","type":"pushbullet-config","z":"","name":"main"},{"id":"8c00412c.036b5","type":"pushbullet-config","z":"","name":"main"},{"id":"d837e845.a0bc08","type":"darksky-credentials","z":"","key_identifier":"pogoda"},{"id":"bb198d2d.45c49","type":"telegram bot","z":"edd42ef7.16d9c","botname":"HeinzBot"},{"id":"ab7e128b.884e3","type":"telegram bot","z":"edd42ef7.16d9c","botname":"HeinzBot","usernames":"","chatids":""},{"id":"eb7f92d0.0d7fc","type":"ui_group","z":"a8befc30.c457","name":"Коридор","tab":"ce04ac9d.c7a88","order":1,"disp":true,"width":"12","collapse":false},{"id":"ce04ac9d.c7a88","type":"ui_tab","z":"a8befc30.c457","name":"Cameras","icon":"camera_alt","order":3},{"id":"49e44ce.d692eb4","type":"mqtt-broker","z":"","name":"","broker":"192.168.2.2","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"6f51b5e4.c2ec4c","type":"mqtt-broker","z":"","name":"","broker":"192.168.2.2","port":"1883","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"f7605e8b.4fc4c","type":"mqtt-broker","z":"","name":"","broker":"farmer.cloudmqtt.com","port":"16966","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"2763fb39.a89104","type":"mqtt-broker","z":"","name":"","broker":"farmer.cloudmqtt.com","port":"16966","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"ac7da121.c616b","type":"ui_group","z":"","name":"Control Panel","tab":"a70cc800.6af748","order":2,"disp":true,"width":6},{"id":"a70cc800.6af748","type":"ui_tab","z":"","name":"Button Panel","icon":"dashboard","order":4},{"id":"2b7fbbc4.52b474","type":"ui_group","z":"","name":"Default","tab":"72459764.923118","order":2,"disp":true,"width":"15","collapse":false},{"id":"72459764.923118","type":"ui_tab","name":"Tab 4","icon":"dashboard","order":1},{"id":"2fa00b13.f149a4","type":"mqtt-broker","z":"","name":"broker","broker":"localhost","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"c3cc33ea.87bb8","type":"telegram bot","z":"","botname":"","usernames":"","chatids":"","baseapiurl":"","updatemode":"polling","pollinterval":"600","usesocks":false,"sockshost":"","socksport":"6667","socksusername":"anonymous","sockspassword":"","bothost":"","localbotport":"8443","publicbotport":"8443","privatekey":"","certificate":"","useselfsignedcertificate":false,"verboselogging":false},{"id":"59d81e7a.0963d","type":"pushbullet-config","z":"","name":"main"},{"id":"a843ff36.26c3c","type":"remote-xy-dashboard","z":"","name":"OutPut","port":"6377","config":"/*\n   -- New project --\n   \n   This source code of graphical user interface \n   has been generated automatically by RemoteXY editor.\n   To compile this code using RemoteXY library 2.4.3 or later version \n   download by link http://remotexy.com/en/library/\n   To connect using RemoteXY mobile app by link http://remotexy.com/en/download/                   \n     - for ANDROID 4.5.1 or later version;\n     - for iOS 1.4.1 or later version;\n    \n   This source code is free software; you can redistribute it and/or\n   modify it under the terms of the GNU Lesser General Public\n   License as published by the Free Software Foundation; either\n   version 2.1 of the License, or (at your option) any later version.    \n*/\n\n//////////////////////////////////////////////\n//        RemoteXY include library          //\n//////////////////////////////////////////////\n\n// определение режима соединения и подключение библиотеки RemoteXY \n#define REMOTEXY_MODE__ETHERNET_LIB\n#include <Ethernet.h>\n/* Ethernet shield used pins: 10(SS) */\n#include <SPI.h>\n/* SPI interface used pins: 11(MOSI), 12(MISO), 13(SCK) */\n\n#include <RemoteXY.h>\n\n// настройки соединения \n#define REMOTEXY_ETHERNET_MAC \"DE:AD:BE:EF:EF:ED\"\n#define REMOTEXY_SERVER_PORT 6377\n\n\n// конфигурация интерфейса  \n#pragma pack(push, 1)\nuint8_t RemoteXY_CONF[] =\n  { 255,3,0,4,0,66,0,10,13,0,\n  1,0,22,7,12,12,2,31,88,0,\n  4,0,5,10,5,37,2,26,2,0,\n  21,27,18,8,2,26,31,31,79,78,\n  0,79,70,70,0,65,4,53,7,9,\n  9,65,2,67,7,9,9,66,1,87,\n  18,7,16,2,26,66,132,50,30,31,\n  24,2,24 };\n  \n// структура определяет все переменные и события вашего интерфейса управления \nstruct {\n\n    // input variables\n  uint8_t button_1; // =1 если кнопка нажата, иначе =0 \n  int8_t slider_1; // =0..100 положение слайдера \n  uint8_t switch_1; // =1 если переключатель включен и =0 если отключен \n\n    // output variables\n  uint8_t led_1_r; // =0..255 яркость красного цвета индикатора \n  uint8_t led_2_g; // =0..255 яркость зеленого цвета индикатора \n  int8_t level_1; // =0..100 положение уровня \n  int8_t level_2; // =0..100 положение уровня \n\n    // other variable\n  uint8_t connect_flag;  // =1 if wire connected, else =0 \n\n} RemoteXY;\n#pragma pack(pop)\n\n/////////////////////////////////////////////\n//           END RemoteXY include          //\n/////////////////////////////////////////////\n\n\n\nvoid setup() \n{\n  RemoteXY_Init (); \n  \n  \n  // TODO you setup code\n  \n}\n\nvoid loop() \n{ \n  RemoteXY_Handler ();\n  \n  \n  // TODO you loop code\n  // используйте структуру RemoteXY для передачи данных\n\n\n}"},{"id":"13042f9.bfc3cd","type":"ui_group","z":"9ab1c0c7.d7f57","name":"Default","tab":"8c905d58.4dd91","order":1,"disp":true,"width":"6"},{"id":"8c905d58.4dd91","type":"ui_tab","z":"9ab1c0c7.d7f57","name":"tab2","icon":"dashboard"},{"id":"a71c3d00.520a9","type":"tcp in","z":"8abcb9c4.969e58","name":"listen5555","server":"server","host":"","port":"5555","datamode":"stream","datatype":"buffer","newline":"","topic":"listen5555","base64":false,"x":116,"y":103,"wires":[["b0fd09bb.a35178","cebe805.57b888"]]},{"id":"cebe805.57b888","type":"debug","z":"8abcb9c4.969e58","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":321,"y":92,"wires":[]},{"id":"c29416ea.c14a28","type":"tcp out","z":"8abcb9c4.969e58","host":"127.0.0.1","port":"5555","beserver":"client","base64":false,"end":true,"name":"5555","x":428,"y":167,"wires":[]},{"id":"b0fd09bb.a35178","type":"function","z":"8abcb9c4.969e58","name":"","func":"msg.payload = 255;\n// Return the message so it can be sent on\nreturn msg;","outputs":1,"noerr":0,"x":280,"y":143,"wires":[["c29416ea.c14a28"]]},{"id":"31f3047c.3c6c3c","type":"inject","z":"49f88b4f.625b74","name":"make request","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":205,"y":264,"wires":[["82b08dee.7b79a"]]},{"id":"82b08dee.7b79a","type":"http request","z":"49f88b4f.625b74","name":"","method":"GET","ret":"txt","paytoqs":false,"url":"https://сатвика.рф","tls":"","proxy":"","x":369.5,"y":264,"wires":[["1fe6e0b9.affd9f"]]},{"id":"c131bee5.23ac2","type":"debug","z":"49f88b4f.625b74","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":810,"y":264,"wires":[]},{"id":"1fe6e0b9.affd9f","type":"html","z":"49f88b4f.625b74","name":"","property":"","outproperty":"","tag":".elementor-post__excerpt","ret":"text","as":"single","x":576.5,"y":264,"wires":[["c131bee5.23ac2"]]},{"id":"ece7cde6.f536","type":"websocket in","z":"8abcb9c4.969e58","name":"wss://echo.websocket.org","server":"","client":"672ff1be.ce75d","x":133,"y":205,"wires":[["9bf8b9b6.660158"]]},{"id":"efb184dc.1a1c88","type":"websocket out","z":"8abcb9c4.969e58","name":"wss://echo.websocket.org","server":"","client":"672ff1be.ce75d","x":471,"y":333,"wires":[]},{"id":"acfffb5f.a667e8","type":"debug","z":"8abcb9c4.969e58","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":523,"y":272,"wires":[]},{"id":"a08e086.23b75f8","type":"inject","z":"8abcb9c4.969e58","name":"","topic":"","payload":"Hello World!","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":143,"y":272,"wires":[["efb184dc.1a1c88"]]},{"id":"9bf8b9b6.660158","type":"function","z":"8abcb9c4.969e58","name":"","func":"msg.payload = \"My Answer: '\" + msg.payload;\n// Return the message so it can be sent on\nreturn msg;","outputs":1,"noerr":0,"x":352,"y":247,"wires":[["acfffb5f.a667e8"]]},{"id":"fc49d80f.935c88","type":"debug","z":"8abcb9c4.969e58","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":346,"y":436,"wires":[]},{"id":"776980b3.a9ff2","type":"inject","z":"8abcb9c4.969e58","name":"","topic":"","payload":"254","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":117,"y":377,"wires":[["fc49d80f.935c88"]]},{"id":"21b5b35c.ef055c","type":"debug","z":"8abcb9c4.969e58","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":861,"y":512,"wires":[]},{"id":"23b34802.d201f8","type":"http in","z":"8abcb9c4.969e58","name":"","url":"/hello","method":"get","upload":false,"swaggerDoc":"","x":407,"y":615,"wires":[["b448af0a.cc778"]]},{"id":"b448af0a.cc778","type":"template","z":"8abcb9c4.969e58","name":"page","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<html>100</html>","x":629,"y":546,"wires":[["2264b56c.1bceaa","21b5b35c.ef055c"]]},{"id":"2264b56c.1bceaa","type":"http response","z":"8abcb9c4.969e58","name":"","statusCode":"","headers":{},"x":846,"y":362,"wires":[]},{"id":"34d855b4.f0161a","type":"http response","z":"740b003f.0a2b","name":"","statusCode":"","headers":{},"x":573,"y":132,"wires":[]},{"id":"861a9e50.81778","type":"template","z":"740b003f.0a2b","name":"page","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head></head>\n    <body>\n        <h1>Hello {{req.params.name}}!</h1>\n    </body>\n</html>","x":420,"y":137,"wires":[["34d855b4.f0161a","a60054a6.5032b8"]]},{"id":"8e071679.fd0298","type":"http in","z":"740b003f.0a2b","name":"","url":"/rnd","method":"get","upload":false,"swaggerDoc":"","x":218,"y":108,"wires":[["861a9e50.81778","b4c91869.d20a48"]]},{"id":"a60054a6.5032b8","type":"debug","z":"740b003f.0a2b","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":705,"y":251,"wires":[]},{"id":"d9ef4eb.6ed3cb","type":"template","z":"740b003f.0a2b","name":"page","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head></head>\n    <body>\n        <h1>Hello {{req.query.name}}</h1>\n        <h1>Color {{req.query.color}}</h1>\n    </body>\n</html>","x":454,"y":417,"wires":[["dc78e7bd.d02e48","fdc3e7fc.a0cb68"]]},{"id":"f30419a.bda5be8","type":"http in","z":"740b003f.0a2b","name":"","url":"/hello-query","method":"get","upload":false,"swaggerDoc":"","x":236,"y":414,"wires":[["d9ef4eb.6ed3cb"]]},{"id":"dc78e7bd.d02e48","type":"http response","z":"740b003f.0a2b","name":"","statusCode":"","headers":{},"x":695,"y":417,"wires":[]},{"id":"fdc3e7fc.a0cb68","type":"debug","z":"740b003f.0a2b","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":686,"y":522,"wires":[]},{"id":"b4c91869.d20a48","type":"debug","z":"740b003f.0a2b","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":650,"y":44,"wires":[]},{"id":"4ec5c163.5b939","type":"switch","z":"15c9eaa7.3c0665","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"num"},{"t":"eq","v":"2","vt":"str"},{"t":"eq","v":"3","vt":"str"},{"t":"eq","v":"4","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":712,"y":345,"wires":[["ba8839aa.725c28","7a73e685.4b1ed8"],["ba8839aa.725c28","5662ee3a.fcc9d"],["ba8839aa.725c28","1768ecd.5859e13"],["ba8839aa.725c28","a7567be0.dd0ab8"]]},{"id":"8433ce41.da17f","type":"delay","z":"15c9eaa7.3c0665","name":"","pauseType":"delay","timeout":"10","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":414,"y":235,"wires":[["40ae3a88.297854","e5bcabdc.c879c8"]]},{"id":"8fab048b.2b32d8","type":"inject","z":"15c9eaa7.3c0665","name":"start","topic":"","payload":"START","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":124,"y":312,"wires":[["4fac443b.45c78c","e5bcabdc.c879c8"]]},{"id":"ba8839aa.725c28","type":"debug","z":"15c9eaa7.3c0665","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":941,"y":393,"wires":[]},{"id":"40ae3a88.297854","type":"function","z":"15c9eaa7.3c0665","name":"for 1-4","func":"msg.payload = msg.payload + 1\nif (msg.payload == 5) {\n    msg.payload = 1\n}\nreturn msg;","outputs":1,"noerr":0,"x":406,"y":94,"wires":[["1b4a6897.97d7d7","8433ce41.da17f"]]},{"id":"12d39206.2c9e5e","type":"debug","z":"15c9eaa7.3c0665","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1030,"y":89,"wires":[]},{"id":"7a73e685.4b1ed8","type":"http request","z":"15c9eaa7.3c0665","name":"green","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.127/green","tls":"","proxy":"","authType":"basic","x":777,"y":80,"wires":[[]]},{"id":"3138bb74.040714","type":"html","z":"15c9eaa7.3c0665","name":"","property":"","outproperty":"","tag":"html","ret":"text","as":"single","x":953,"y":231,"wires":[["12d39206.2c9e5e"]]},{"id":"5662ee3a.fcc9d","type":"http request","z":"15c9eaa7.3c0665","name":"red","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.127/ON","tls":"","proxy":"","authType":"basic","x":778,"y":126,"wires":[[]]},{"id":"1768ecd.5859e13","type":"http request","z":"15c9eaa7.3c0665","name":"blue","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.127/blue","tls":"","proxy":"","authType":"basic","x":776,"y":174,"wires":[[]]},{"id":"a7567be0.dd0ab8","type":"http request","z":"15c9eaa7.3c0665","name":"rnd","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.127/rnd","tls":"","proxy":"","authType":"basic","x":782,"y":220,"wires":[["3138bb74.040714"]]},{"id":"c4b503a1.b163a","type":"inject","z":"15c9eaa7.3c0665","name":"stop","topic":"","payload":"STOP","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":121,"y":406,"wires":[["e5bcabdc.c879c8"]]},{"id":"4fac443b.45c78c","type":"function","z":"15c9eaa7.3c0665","name":"set 0","func":"msg.payload = 0\nreturn msg;","outputs":1,"noerr":0,"x":173,"y":22,"wires":[["40ae3a88.297854","1b4a6897.97d7d7"]]},{"id":"1b4a6897.97d7d7","type":"debug","z":"15c9eaa7.3c0665","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":634,"y":20,"wires":[]},{"id":"227bdd8.520df22","type":"debug","z":"15c9eaa7.3c0665","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":795,"y":617,"wires":[]},{"id":"e5bcabdc.c879c8","type":"traffic","z":"15c9eaa7.3c0665","name":"","property_allow":"payload","filter_allow":"START","ignore_case_allow":false,"negate_allow":false,"send_allow":false,"property_stop":"payload","filter_stop":"STOP","ignore_case_stop":false,"negate_stop":false,"send_stop":false,"default_start":false,"differ":false,"x":504,"y":347,"wires":[["227bdd8.520df22","4ec5c163.5b939","d0d52611.e8cb08"]]},{"id":"74bb04bb.111b0c","type":"function","z":"15c9eaa7.3c0665","name":"> 45?","func":"newmsg = Object();\nif (msg.payload > 0.44) {\n newmsg.payload = \"STOP\";\n} else {\n newmsg.payload = \"Not Yet\";\n}\nreturn newmsg;","outputs":1,"noerr":0,"x":270,"y":641,"wires":[[]]},{"id":"d0d52611.e8cb08","type":"ui_numeric","z":"15c9eaa7.3c0665","name":"","label":"numeric","tooltip":"","group":"8b7266fe.98fd18","order":1,"width":0,"height":0,"passthru":true,"topic":"","format":"{{value}}","min":0,"max":10,"step":1,"x":612,"y":235,"wires":[["4ec5c163.5b939"]]},{"id":"14279721.73d9e9","type":"inject","z":"f4c13dae.1fd7a","name":"","topic":"","payload":"1","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":245,"y":329,"wires":[["60930c1.6e743f4"]]},{"id":"7214aa5a.b75504","type":"inject","z":"f4c13dae.1fd7a","name":"","topic":"","payload":"2","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":245,"y":389,"wires":[["60930c1.6e743f4"]]},{"id":"60930c1.6e743f4","type":"join","z":"f4c13dae.1fd7a","name":"","mode":"custom","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":485,"y":349,"wires":[["a1d129ab.f74148"]]},{"id":"a1d129ab.f74148","type":"debug","z":"f4c13dae.1fd7a","name":"","active":true,"tosidebar":false,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":695,"y":369,"wires":[]},{"id":"46a14e01.58295","type":"function","z":"f4c13dae.1fd7a","name":"IN ZONE","func":"var msg1 = {};\nvar msg2 = {};\nvar msg3 = {};\nvar msg4 = {};\nif (msg.location.inarea === true) {\n    msg1.payload = 1;\n    msg2.payload = msg.location.isat[0]\n    msg3.payload = msg.location.distances.work\n    msg4.payload = \"Вы находитесь на расстоянии \" + msg.location.distances.work + \"м от работы \"\n} \nelse {\n    msg1.payload = 0;\n    msg2.payload = \"вне зоны\"\n    msg3.payload = msg.location.distances.work\n    msg4.payload = \"Вы находитесь на расстоянии \" + msg.location.distances.work + \"м от работы \" \n}\n//msg.location.distances[msg.location.isat[0]]\nreturn [msg1,msg2,msg3,msg4]","outputs":4,"noerr":0,"x":448,"y":459,"wires":[[],[],[],[]]},{"id":"92b23f72.fef87","type":"mqtt in","z":"740c75b5.a1e69c","name":"zigbee2mqtt","topic":"zigbee2mqtt/#","qos":"2","broker":"299502c0.c3cdae","x":135,"y":119,"wires":[["47b19992.896228","f0015a64.e1e5e8"]]},{"id":"3dda1d0e.bd20c2","type":"inject","z":"740c75b5.a1e69c","name":"MotionHall_OFF","topic":"","payload":"{ \"idx\" : 18, \"nvalue\" : 0}","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":667,"y":320,"wires":[["d58af45.545c508"]]},{"id":"d58af45.545c508","type":"mqtt out","z":"740c75b5.a1e69c","name":"domoticz/in","topic":"domoticz/in","qos":"2","retain":"","broker":"299502c0.c3cdae","x":919,"y":413,"wires":[]},{"id":"49ea9af3.867754","type":"inject","z":"740c75b5.a1e69c","name":"MotionHall_ON","topic":"","payload":"{ \"idx\" : 18, \"nvalue\" : 1}","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":699,"y":233,"wires":[["d58af45.545c508"]]},{"id":"91e991ab.25231","type":"function","z":"740c75b5.a1e69c","name":"GetStatus","func":"if (msg.topic == \"zigbee2mqtt/bridge/state\" && msg.payload == \"offline\") {\n    msg.idx = null;\n    node.status({text: \"zigbee2mqtt state OFFLINE\"});\n    return msg;\n}\n\n// -----------------------------------------------------------------------------\n\nif(msg.DeviceType == \"Button\") {\n    \n    node.status({text: \"Button msg.payload: \" + msg.payload.click});\n    \n    if (msg.payload.click == \"single\") {\n        node.status({text: \"Кнопка: одиночный клик; idx=\" + msg.idx});\n        return {payload:{command: \"switchlight\", idx: msg.idx, switchcmd: \"Set Level\", level:10}};\n    }\n    else if (msg.payload.click == \"double\") {\n        node.status({text: \"Кнопка: двойной клик; idx=\" + msg.idx});\n        return {payload:{command: \"switchlight\", idx: msg.idx, switchcmd: \"Set Level\", level:20}};\n    }\n    else if (msg.payload.click == \"long\") {\n        node.status({text: \"Кнопка: длинный клик; idx=\" + msg.idx});\n        return {payload:{command: \"switchlight\", idx: msg.idx, switchcmd: \"Set Level\", level:30}};\n    }\n    else if (msg.payload.click == \"long_release\") {\n        node.status({text: \"Кнопка: отпущен длинный клик; idx=\" + msg.idx});\n        return {payload:{command: \"switchlight\", idx: msg.idx, switchcmd: \"Set Level\", level:40}};\n    }\n}\n\n// -----------------------------------------------------------------------------\n\nif(msg.DeviceType == \"Motion\") {\n    \n    isNewValue = false;\n    \n    if (typeof context.occupancy === 'undefined') {\n        context.occupancy = [];\n        context.occupancy[msg.idx] = -1;\n    }\n    \n    if (typeof msg.payload.occupancy !== 'undefined') {\n        if(msg.payload.occupancy) {\n            if (context.occupancy[msg.idx] != 1) {\n                context.occupancy[msg.idx] = 1;\n                isNewValue = true;\n            }\n        }\n        else if(!msg.payload.occupancy) {\n            if (context.occupancy[msg.idx] !== 0) {\n                context.occupancy[msg.idx] = 0;\n                isNewValue = true;\n            }\n        }\n    }\n        \n    if (isNewValue) {\n        node.status({text: \"Наличие движения: \" + context.occupancy[msg.idx] + \"; idx=\" + msg.idx});\n        return {payload:{ idx: msg.idx , nvalue:context.occupancy[msg.idx]}};\n    }\n}\n\n// -----------------------------------------------------------------------------\n\nif(msg.DeviceType == \"Door\") {\n    \n    if(msg.payload.contact) {\n        node.status({text: \"Дверь: открыта; idx=\" + msg.idx});\n        return {payload:{ idx: msg.idx , nvalue:0}};\n    }\n    else {\n        node.status({text: \"Дверь: закрыта; idx=\" + msg.idx});\n        return {payload:{ idx: msg.idx , nvalue:1}};\n    }\n}\n\n// -----------------------------------------------------------------------------\n\nif(msg.DeviceType == \"Temp\") {\n    \n    //isNewValue = false;\n    \n    if (typeof context.temperature === 'undefined') {\n        context.temperature = [];\n        context.temperature[msg.idx] = 0;\n    }\n    \n    if (typeof context.humidity === 'undefined') {\n        context.humidity = [];\n        context.humidity[msg.idx] = 0;\n    }\n    \n    if (typeof msg.payload.temperature !== 'undefined') {\n        context.temperature[msg.idx] = msg.payload.temperature;\n        isNewValue = true;\n    }\n    if (typeof msg.payload.humidity !== 'undefined') {\n        context.humidity[msg.idx] = msg.payload.humidity;\n        isNewValue = true;\n    }\n    \n    if (isNewValue && context.temperature[msg.idx] !== 0 && context.humidity[msg.idx] !== 0) \n    {\n        node.status({text: \"температура: \" + context.temperature[msg.idx] + \"°С, влажность: \" +  context.humidity[msg.idx] + \"%; idx=\" + msg.idx});\n        return {payload:{ idx: msg.idx , nvalue:0, svalue:context.temperature[msg.idx] +\";\"+ context.humidity[msg.idx] +\";1\"}};\n    }\n}\n\n// -----------------------------------------------------------------------------\n\nmsg.idx = null;\nnode.status(\"Сообщение не обработано\");\nreturn msg;","outputs":1,"noerr":0,"x":589,"y":453,"wires":[["9eb67c8d.cb816"]]},{"id":"9eb67c8d.cb816","type":"switch","z":"740c75b5.a1e69c","name":"IsIdxFound","property":"payload.idx","propertyType":"msg","rules":[{"t":"nnull"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":759,"y":453,"wires":[["d58af45.545c508"],["a59cde61.0d2ec"]]},{"id":"b32c5379.34475","type":"switch","z":"740c75b5.a1e69c","name":"","property":"topic","propertyType":"msg","rules":[{"t":"cont","v":"0x00158d0001","vt":"str"},{"t":"cont","v":"0x00158d0002","vt":"str"},{"t":"cont","v":"0x00158d0003","vt":"str"},{"t":"cont","v":"0x00158d0004","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":5,"x":239,"y":433,"wires":[["8b1544b.4e295b8"],["2875b73.317bb48"],["bd31c56e.526cc8"],["86c65e63.66c65"],["f0e84826.16d578"]]},{"id":"8b1544b.4e295b8","type":"change","z":"740c75b5.a1e69c","name":"MotionHall","rules":[{"t":"set","p":"idx","pt":"msg","to":"18","tot":"num"},{"t":"set","p":"DeviceType","pt":"msg","to":"Motion","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":413,"y":285,"wires":[["91e991ab.25231"]]},{"id":"2875b73.317bb48","type":"change","z":"740c75b5.a1e69c","name":"TempHall","rules":[{"t":"set","p":"idx","pt":"msg","to":"21","tot":"num"},{"t":"set","p":"DeviceType","pt":"msg","to":"Temp","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":416,"y":349,"wires":[["91e991ab.25231"]]},{"id":"bd31c56e.526cc8","type":"change","z":"740c75b5.a1e69c","name":"ButtonHall","rules":[{"t":"set","p":"idx","pt":"msg","to":"13","tot":"num"},{"t":"set","p":"DeviceType","pt":"msg","to":"Button","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":408,"y":405,"wires":[["91e991ab.25231"]]},{"id":"7f580d82.5e40c4","type":"json","z":"740c75b5.a1e69c","name":"","property":"payload","action":"","pretty":false,"x":135,"y":346,"wires":[["b32c5379.34475"]]},{"id":"f0015a64.e1e5e8","type":"debug","z":"740c75b5.a1e69c","name":"Input","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":329,"y":75,"wires":[]},{"id":"47b19992.896228","type":"switch","z":"740c75b5.a1e69c","name":"IsJson","property":"payload","propertyType":"msg","rules":[{"t":"cont","v":"{","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":298,"y":168,"wires":[["7f580d82.5e40c4"]]},{"id":"86c65e63.66c65","type":"change","z":"740c75b5.a1e69c","name":"Door","rules":[{"t":"set","p":"idx","pt":"msg","to":"10","tot":"num"},{"t":"set","p":"DeviceType","pt":"msg","to":"Door","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":416,"y":466,"wires":[["91e991ab.25231"]]},{"id":"652db949.4f0e88","type":"inject","z":"740c75b5.a1e69c","name":"","topic":"zigbee2mqtt/0x00158d0006","payload":"{\"battery\":\"100.00\",\"voltage\":3025,\"temperature\":24.22,\"humidity\":42.96}","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":113,"y":209,"wires":[["47b19992.896228"]]},{"id":"f0e84826.16d578","type":"debug","z":"740c75b5.a1e69c","name":"ID not found","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":399,"y":533,"wires":[]},{"id":"a59cde61.0d2ec","type":"debug","z":"740c75b5.a1e69c","name":"GetStatus error","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","x":929,"y":493,"wires":[]},{"id":"9da0e9ef.e8bfc8","type":"debug","z":"c4829f93.87cba","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":950,"y":260,"wires":[]},{"id":"857d8563.065f38","type":"inject","z":"c4829f93.87cba","name":"start","topic":"","payload":"test1","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":180,"wires":[["29c813ed.ce439c"]]},{"id":"79cac4fc.d163ac","type":"inject","z":"c4829f93.87cba","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":280,"y":320,"wires":[["906e8c72.7ee2e"]]},{"id":"19f86868.fc7538","type":"change","z":"c4829f93.87cba","name":"setOn","rules":[{"t":"set","p":"lamp1","pt":"flow","to":"true","tot":"bool"},{"t":"set","p":"lamp2","pt":"flow","to":"Сработало","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":120,"wires":[[]]},{"id":"538acebb.7f9e4","type":"function","z":"c4829f93.87cba","name":"","func":"msg.payload = \"сработало\"\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":220,"wires":[["9da0e9ef.e8bfc8"]]},{"id":"906e8c72.7ee2e","type":"switch","z":"c4829f93.87cba","name":"","property":"lamp1","propertyType":"flow","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":550,"y":320,"wires":[["538acebb.7f9e4"],["d7aa192f.056dd8"]]},{"id":"d7aa192f.056dd8","type":"function","z":"c4829f93.87cba","name":"","func":"msg.payload = \"нет\"\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":300,"wires":[["9da0e9ef.e8bfc8"]]},{"id":"4e8860bd.57c8","type":"inject","z":"c4829f93.87cba","name":"","topic":"","payload":"test","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":120,"wires":[["19f86868.fc7538"]]},{"id":"29c813ed.ce439c","type":"change","z":"c4829f93.87cba","name":"setOff","rules":[{"t":"set","p":"lamp1","pt":"flow","to":"false","tot":"bool"},{"t":"set","p":"lamp2","pt":"flow","to":"Нет","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":180,"wires":[[]]},{"id":"6046281.73eded8","type":"http in","z":"4bc40f.33b24bf","name":"","url":"/myhome","method":"post","upload":false,"swaggerDoc":"","x":100,"y":200,"wires":[["1f73ccbe.ea7183"]]},{"id":"1f73ccbe.ea7183","type":"switch","z":"4bc40f.33b24bf","name":"not ping","property":"payload.request.command","propertyType":"msg","rules":[{"t":"neq","v":"ping","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":300,"y":260,"wires":[["b4e19d69.36618","2c0e30fb.0fb79"]]},{"id":"1fe7f00e.00bd2","type":"debug","z":"4bc40f.33b24bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":590,"y":360,"wires":[]},{"id":"b4e19d69.36618","type":"template","z":"4bc40f.33b24bf","name":"page","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"User agent: {{req.headers.user-agent}}","x":410,"y":360,"wires":[["1fe7f00e.00bd2"]]},{"id":"e93f8a84.8a2508","type":"http response","z":"4bc40f.33b24bf","name":"","statusCode":"","headers":{},"x":1970,"y":300,"wires":[]},{"id":"bccb15c2.6d8ed8","type":"debug","z":"4bc40f.33b24bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":690,"y":180,"wires":[]},{"id":"fc566d53.495b1","type":"switch","z":"4bc40f.33b24bf","name":"user","property":"payload.session.user_id","propertyType":"msg","rules":[{"t":"eq","v":"myhome.userId[0]","vt":"flow"},{"t":"eq","v":"myhome.userId[1]","vt":"flow"},{"t":"eq","v":"myhome.userId[2]","vt":"flow"},{"t":"else"}],"checkall":"true","repair":false,"outputs":4,"x":710,"y":260,"wires":[["8cf4a925.47afd8"],["8cf4a925.47afd8"],["8cf4a925.47afd8"],["e2c89944.c8baa8","af1b25ef.46fff8"]]},{"id":"e2c89944.c8baa8","type":"template","z":"4bc40f.33b24bf","name":"go away","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"response\": {\n    \"text\": \"{{payload.const.intruderText}}\",\n    \"end_session\": false\n        },\n    \"session\": {\n        \"session_id\": \"{{payload.session.session_id}}\",\n        \"message_id\": 4,\n        \"user_id\": \"{{payload.session.user_id}}\"\n        },\n    \"version\": \"1.0\"\n}","output":"json","x":1500,"y":320,"wires":[["e93f8a84.8a2508"]]},{"id":"8cf4a925.47afd8","type":"switch","z":"4bc40f.33b24bf","name":"entity","property":"payload.request.command","propertyType":"msg","rules":[{"t":"cont","v":"myhome.entities.Lamp","vt":"flow"},{"t":"empty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":910,"y":180,"wires":[["aa196ca.308189"],["ac5a7f6d.c079c","456b58e2.4c4e58"],["e95a8079.83a7","1d0b5cad.a83d53"]]},{"id":"aa196ca.308189","type":"switch","z":"4bc40f.33b24bf","name":"turn on/off","property":"payload.request.command","propertyType":"msg","rules":[{"t":"cont","v":"включ","vt":"str"},{"t":"cont","v":"выключ","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1080,"y":100,"wires":[["3ba11b5b.8fb894","184fa964.1f0a67"],["e0285b1.db5aca8","746a89f5.6faa78"]]},{"id":"df4dfcb2.51b2e","type":"template","z":"4bc40f.33b24bf","name":"turn on","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"response\": {\n    \"text\": \"{{payload.const.turnOnText}}\",\n    \"end_session\": false\n        },\n    \"session\": {\n        \"session_id\": \"{{payload.session.session_id}}\",\n        \"message_id\": 4,\n        \"user_id\": \"{{payload.session.user_id}}\"\n        },\n    \"version\": \"1.0\"\n}","output":"json","x":1720,"y":80,"wires":[["e93f8a84.8a2508"]]},{"id":"e95a8079.83a7","type":"template","z":"4bc40f.33b24bf","name":"not found","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"response\": {\n    \"text\": \"{{payload.const.notFoundText}}\",\n    \"end_session\": false\n        },\n    \"session\": {\n        \"session_id\": \"{{payload.session.session_id}}\",\n        \"message_id\": 4,\n        \"user_id\": \"{{payload.session.user_id}}\"\n        },\n    \"version\": \"1.0\"\n}","output":"json","x":1500,"y":280,"wires":[["e93f8a84.8a2508"]]},{"id":"c1c8c9ef.fd9358","type":"template","z":"4bc40f.33b24bf","name":"turn off","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"response\": {\n    \"text\": \"{{payload.const.turnOffText}}\",\n    \"end_session\": false\n        },\n    \"session\": {\n        \"session_id\": \"{{payload.session.session_id}}\",\n        \"message_id\": 4,\n        \"user_id\": \"{{payload.session.user_id}}\"\n        },\n    \"version\": \"1.0\"\n}","output":"json","x":1710,"y":140,"wires":[["e93f8a84.8a2508"]]},{"id":"db24d1e7.91f34","type":"template","z":"4bc40f.33b24bf","name":"Settings object","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"helloWord\": \"Здравствуйте, дом приветствует вас!\",\n    \"intruderText\": \"Что-то не похож ты на моего хозяина. А ну-ка вон отсюда!\",\n    \"notFoundText\": \"Устройство не найдено!\",\n    \"userId\": [\"00023C4E21BEB515A93DC99824FDE96B59F2A7FD69F40E4BCC645E7D8FB37CFD\",\n               \"95F6936A770A9DD5DC4A1DC3BA63049E7DA4FC1AD90E2DB77DA108B1D8CBF6E5\",\n               \"673E752B3F689338D0DBCCF6425D9187A3CFD4CD072CA4C0639FF80AAEB45AA1\"],\n    \"turnOnText\": \"Включаю\",\n    \"turnOffText\": \"Выключаю\",\n    \"turnOnTooText\": \"Уже включен\",\n    \"turnOffTooText\": \"Уже выключен\",\n    \"entities\": {\n        \"Lamp\": \"свет\"\n    }\n}\n","output":"json","x":440,"y":120,"wires":[["82e181fb.1092f"]]},{"id":"ac5a7f6d.c079c","type":"template","z":"4bc40f.33b24bf","name":"hello word","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"response\": {\n    \"text\": \"{{payload.const.helloWord}}\",\n    \"end_session\": false\n        },\n    \"session\": {\n        \"session_id\": \"{{payload.session.session_id}}\",\n        \"message_id\": 4,\n        \"user_id\": \"{{payload.session.user_id}}\"\n        },\n    \"version\": \"1.0\"\n}","output":"json","x":1510,"y":240,"wires":[["e93f8a84.8a2508"]]},{"id":"d3f27b49.45ea28","type":"inject","z":"4bc40f.33b24bf","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"10","x":250,"y":120,"wires":[["db24d1e7.91f34","6cf756a.b7da9a8","27d57469.0df47c"]]},{"id":"82e181fb.1092f","type":"function","z":"4bc40f.33b24bf","name":"Settings myhome","func":"flow.set(\"myhome\", msg.payload)","outputs":1,"noerr":0,"x":650,"y":120,"wires":[[]]},{"id":"2c0e30fb.0fb79","type":"function","z":"4bc40f.33b24bf","name":"Settings const","func":"msg.payload.const = flow.get(\"myhome\")\nreturn msg","outputs":1,"noerr":0,"x":500,"y":260,"wires":[["bccb15c2.6d8ed8","fc566d53.495b1"]]},{"id":"7b13a7ac.7d6ff8","type":"comment","z":"4bc40f.33b24bf","name":"Задаем наши статичные параметры (не забываем после изменения нажимать на синюю кнопку timestamp)","info":"","x":460,"y":80,"wires":[]},{"id":"edd75b75.a7f808","type":"debug","z":"4bc40f.33b24bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1990,"y":460,"wires":[]},{"id":"3ba11b5b.8fb894","type":"template","z":"4bc40f.33b24bf","name":"Включить","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Включить","output":"str","x":1500,"y":380,"wires":[["edd75b75.a7f808"]]},{"id":"e0285b1.db5aca8","type":"template","z":"4bc40f.33b24bf","name":"Выключить","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Выключить","output":"str","x":1510,"y":420,"wires":[["edd75b75.a7f808"]]},{"id":"456b58e2.4c4e58","type":"template","z":"4bc40f.33b24bf","name":"Привет","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Привет","output":"str","x":1500,"y":460,"wires":[["edd75b75.a7f808"]]},{"id":"1d0b5cad.a83d53","type":"template","z":"4bc40f.33b24bf","name":"не найдено","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"не найдено","output":"str","x":1510,"y":500,"wires":[["edd75b75.a7f808"]]},{"id":"af1b25ef.46fff8","type":"template","z":"4bc40f.33b24bf","name":"Прощай","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Прощай","output":"str","x":1500,"y":540,"wires":[["edd75b75.a7f808"]]},{"id":"6cf756a.b7da9a8","type":"debug","z":"4bc40f.33b24bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":490,"y":200,"wires":[]},{"id":"184fa964.1f0a67","type":"switch","z":"4bc40f.33b24bf","name":"Lamp is on/off","property":"lamp","propertyType":"flow","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1280,"y":60,"wires":[["b3774d5c.3bc4d"],["9d65f7ac.ee7c48"]]},{"id":"b3774d5c.3bc4d","type":"template","z":"4bc40f.33b24bf","name":"turn on too","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"response\": {\n    \"text\": \"{{payload.const.turnOnTooText}}\",\n    \"end_session\": false\n        },\n    \"session\": {\n        \"session_id\": \"{{payload.session.session_id}}\",\n        \"message_id\": 4,\n        \"user_id\": \"{{payload.session.user_id}}\"\n        },\n    \"version\": \"1.0\"\n}","output":"json","x":1510,"y":40,"wires":[["e93f8a84.8a2508"]]},{"id":"3d6f892d.7101b6","type":"template","z":"4bc40f.33b24bf","name":"turn off too","field":"payload","fieldType":"msg","format":"json","syntax":"mustache","template":"{\n    \"response\": {\n    \"text\": \"{{payload.const.turnOffTooText}}\",\n    \"end_session\": false\n        },\n    \"session\": {\n        \"session_id\": \"{{payload.session.session_id}}\",\n        \"message_id\": 4,\n        \"user_id\": \"{{payload.session.user_id}}\"\n        },\n    \"version\": \"1.0\"\n}","output":"json","x":1510,"y":200,"wires":[["e93f8a84.8a2508"]]},{"id":"746a89f5.6faa78","type":"switch","z":"4bc40f.33b24bf","name":"Lamp is on/off","property":"lamp","propertyType":"flow","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1280,"y":160,"wires":[["1fd096ae.8b9539"],["3d6f892d.7101b6"]]},{"id":"1fd096ae.8b9539","type":"change","z":"4bc40f.33b24bf","name":"Lamp set Off","rules":[{"t":"set","p":"lamp","pt":"flow","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1510,"y":140,"wires":[["c1c8c9ef.fd9358"]]},{"id":"9d65f7ac.ee7c48","type":"change","z":"4bc40f.33b24bf","name":"Lamp set On","rules":[{"t":"set","p":"lamp","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1510,"y":80,"wires":[["df4dfcb2.51b2e"]]},{"id":"22983a5f.867896","type":"debug","z":"4bc40f.33b24bf","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1490,"y":640,"wires":[]},{"id":"342b2d18.7952f2","type":"inject","z":"4bc40f.33b24bf","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":860,"y":640,"wires":[["c0d2fa61.3bfa68"]]},{"id":"c487c9a4.a523a8","type":"function","z":"4bc40f.33b24bf","name":"","func":"msg.payload = \"сработало\"\nreturn msg;","outputs":1,"noerr":0,"x":1230,"y":660,"wires":[["22983a5f.867896"]]},{"id":"c0d2fa61.3bfa68","type":"switch","z":"4bc40f.33b24bf","name":"","property":"lamp","propertyType":"flow","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":1090,"y":700,"wires":[["c487c9a4.a523a8"],["cbfea12.c8f7a6"]]},{"id":"cbfea12.c8f7a6","type":"function","z":"4bc40f.33b24bf","name":"","func":"msg.payload = \"нет\"\nreturn msg;","outputs":1,"noerr":0,"x":1230,"y":740,"wires":[["22983a5f.867896"]]},{"id":"65472752.ef5af8","type":"change","z":"4bc40f.33b24bf","name":"setOn","rules":[{"t":"set","p":"lamp","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":1090,"y":560,"wires":[[]]},{"id":"7688be3f.6a067","type":"inject","z":"4bc40f.33b24bf","name":"","topic":"","payload":"test","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":830,"y":560,"wires":[["65472752.ef5af8"]]},{"id":"27d57469.0df47c","type":"change","z":"4bc40f.33b24bf","name":"Lamp setOff","rules":[{"t":"set","p":"lamp","pt":"flow","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":40,"wires":[[]]},{"id":"1dda1ebb.767ff1","type":"switch","z":"c4829f93.87cba","name":"","property":"lamp2","propertyType":"flow","rules":[{"t":"cont","v":"Сработало","vt":"str"},{"t":"cont","v":"Нет","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":550,"y":240,"wires":[["538acebb.7f9e4"],["d7aa192f.056dd8"]]},{"id":"e812e652.9305e8","type":"inject","z":"c4829f93.87cba","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":280,"y":240,"wires":[["1dda1ebb.767ff1"]]},{"id":"85b56b86.e69e68","type":"http in","z":"c4829f93.87cba","name":"lamp","url":"/lamp","method":"get","upload":false,"swaggerDoc":"","x":190,"y":520,"wires":[["83e8d41.7f89928","488d7b62.f8f134","dfff0986.d679d8"]]},{"id":"844c3fcc.019bf","type":"debug","z":"c4829f93.87cba","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1110,"y":420,"wires":[]},{"id":"69cc421a.5de9dc","type":"inject","z":"c4829f93.87cba","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":360,"y":640,"wires":[["8c58e3a6.b995d"]]},{"id":"b2163995.c61188","type":"debug","z":"c4829f93.87cba","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":980,"y":640,"wires":[]},{"id":"8c58e3a6.b995d","type":"change","z":"c4829f93.87cba","name":"LampON","rules":[{"t":"set","p":"url","pt":"msg","to":"http://192.168.1.71/gpio?st=1&pin=15","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":640,"wires":[["6fac80bb.5ebb"]]},{"id":"6fac80bb.5ebb","type":"http request","z":"c4829f93.87cba","name":"","method":"GET","ret":"txt","paytoqs":false,"url":"","tls":"","proxy":"","x":770,"y":640,"wires":[["b2163995.c61188"]]},{"id":"4f654a8a.fbe014","type":"inject","z":"c4829f93.87cba","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"5","x":360,"y":700,"wires":[["b66e0e9.0fb34f"]]},{"id":"9efe2ed1.f5c1f","type":"function","z":"c4829f93.87cba","name":"ESP_Get to JSON Check and Save","func":"if(typeof(msg.payload) == \"string\" && msg.payload[0] != \"{\"){\n    msg.payload = \"{\\\"\" + msg.payload + \"\\\"}\"; \n    return [msg, null];\n    \n}\nelse if(typeof(msg.payload) == \"object\"){\n    if(msg.payload.userhost == \"dfghbf\"){\n        if(msg.payload.bmet < -40 || msg.payload.bmet > 55){\n            msg.payload.bmet = -555;\n        }\n        if(msg.payload.bmeh < 0 || msg.payload.bmeh > 100){\n            msg.payload.bmeh = -555;\n        }\n        if(msg.payload.bmep < 650 || msg.payload.bmep > 800){\n            msg.payload.bmep = -555;\n        }\n        if(msg.payload.bh < 0 || msg.payload.bh > 36600){\n            msg.payoad.bh = -555;\n        }\n    }\n    msg.payload.time = getTime();\n    return [null, msg];\n}\nelse if(typeof(msg.payload) == \"string\" && msg.payload[0] == \"{\"){\n    context.global.ulica2 = msg.payload;\n}","outputs":2,"noerr":0,"x":440,"y":960,"wires":[["367e4851.813cd8"],["1f97b56f.0f778b"]]},{"id":"367e4851.813cd8","type":"change","z":"c4829f93.87cba","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":":","fromt":"str","to":"\":\"","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":";","fromt":"str","to":"\",\"","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":",\"\"","fromt":"str","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":300,"y":840,"wires":[["30d1b633.3fee3a"]]},{"id":"1f97b56f.0f778b","type":"json","z":"c4829f93.87cba","name":"","property":"payload","action":"","pretty":false,"x":450,"y":1100,"wires":[["9efe2ed1.f5c1f"]]},{"id":"30d1b633.3fee3a","type":"json","z":"c4829f93.87cba","name":"","property":"payload","action":"","pretty":false,"x":570,"y":840,"wires":[["9efe2ed1.f5c1f"]]},{"id":"83e8d41.7f89928","type":"function","z":"c4829f93.87cba","name":"get pin15","func":"msg.payload = msg.payload.gpiout15\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":520,"wires":[["1018f0d1.da23af"]]},{"id":"be3c7951.9cc7c8","type":"inject","z":"c4829f93.87cba","name":"make request","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":310,"y":760,"wires":[["f960974.da17268"]]},{"id":"f960974.da17268","type":"http request","z":"c4829f93.87cba","name":"","method":"GET","ret":"txt","paytoqs":false,"url":"http://192.168.1.71/readjson","tls":"","proxy":"","x":550,"y":760,"wires":[["f7157d58.7db4f"]]},{"id":"8b344075.b19cc","type":"debug","z":"c4829f93.87cba","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1090,"y":760,"wires":[]},{"id":"4f7e4fe8.221e1","type":"change","z":"c4829f93.87cba","name":"","rules":[{"t":"set","p":"test","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":710,"y":420,"wires":[["7694abc6.ff4484"]]},{"id":"1018f0d1.da23af","type":"switch","z":"c4829f93.87cba","name":"on - off","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"str"},{"t":"eq","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":510,"y":520,"wires":[["4f7e4fe8.221e1"],["574679e2.18cd18"]]},{"id":"574679e2.18cd18","type":"change","z":"c4829f93.87cba","name":"","rules":[{"t":"set","p":"test","pt":"flow","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":710,"y":460,"wires":[["7694abc6.ff4484"]]},{"id":"7694abc6.ff4484","type":"change","z":"c4829f93.87cba","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"test","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":920,"y":440,"wires":[["844c3fcc.019bf"]]},{"id":"68a8ec5e.a77bd4","type":"http in","z":"c4829f93.87cba","name":"lamp1","url":"/lamp1","method":"get","upload":false,"swaggerDoc":"","x":190,"y":440,"wires":[["2d6079d8.3f5a96","dfff0986.d679d8","488d7b62.f8f134"]]},{"id":"2d6079d8.3f5a96","type":"switch","z":"c4829f93.87cba","name":"","property":"payload.lamp","propertyType":"msg","rules":[{"t":"eq","v":"1","vt":"str"},{"t":"eq","v":"0","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":370,"y":440,"wires":[["4f7e4fe8.221e1"],["574679e2.18cd18"]]},{"id":"b66e0e9.0fb34f","type":"change","z":"c4829f93.87cba","name":"LampOff","rules":[{"t":"set","p":"url","pt":"msg","to":"http://192.168.1.71/gpio?st=0&pin=15","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":700,"wires":[["6fac80bb.5ebb"]]},{"id":"43bbe178.9ded1","type":"debug","z":"c4829f93.87cba","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":540,"wires":[]},{"id":"62c6bd00.896814","type":"inject","z":"f4c13dae.1fd7a","name":"inject","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":210,"y":680,"wires":[["89c51e44.8e449"]]},{"id":"89c51e44.8e449","type":"template","z":"f4c13dae.1fd7a","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"one;two;three;four;five","x":340,"y":680,"wires":[["560b217a.bbe1a"]]},{"id":"560b217a.bbe1a","type":"split","z":"f4c13dae.1fd7a","name":"","splt":";","spltType":"str","arraySplt":"1","arraySpltType":"len","stream":false,"addname":"","x":290,"y":740,"wires":[["67c93570.a7023c","719eb1a3.ac0e7"]]},{"id":"67c93570.a7023c","type":"change","z":"f4c13dae.1fd7a","name":"Prepend line number","rules":[{"t":"set","p":"payload","pt":"msg","to":"(parts.index+1) & \": \" & payload","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":740,"wires":[["72eb15ef.b67b4c","3f60fdc1.706dc2"]]},{"id":"72eb15ef.b67b4c","type":"join","z":"f4c13dae.1fd7a","name":"","mode":"auto","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","timeout":"","count":"","x":650,"y":660,"wires":[["3c3841ad.0b9c9e"]]},{"id":"3c3841ad.0b9c9e","type":"debug","z":"f4c13dae.1fd7a","name":"debug","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":750,"y":740,"wires":[]},{"id":"719eb1a3.ac0e7","type":"debug","z":"f4c13dae.1fd7a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":560,"y":940,"wires":[]},{"id":"3f60fdc1.706dc2","type":"debug","z":"f4c13dae.1fd7a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":800,"y":940,"wires":[]},{"id":"f7157d58.7db4f","type":"json","z":"c4829f93.87cba","name":"","property":"payload","action":"","pretty":false,"x":730,"y":760,"wires":[["3e3596a.6dd7b6a"]]},{"id":"3e3596a.6dd7b6a","type":"function","z":"c4829f93.87cba","name":"Pin15 status","func":"var value = msg.payload.gpio[\"15\"];\nmsg.payload = value;\nreturn msg;","outputs":1,"noerr":0,"x":910,"y":760,"wires":[["8b344075.b19cc"]]},{"id":"488d7b62.f8f134","type":"template","z":"c4829f93.87cba","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"This is the payload: {{payload}} !","output":"str","x":400,"y":580,"wires":[["43bbe178.9ded1","469e84cd.43403c"]]},{"id":"469e84cd.43403c","type":"http response","z":"c4829f93.87cba","name":"","statusCode":"","headers":{},"x":700,"y":600,"wires":[]},{"id":"dfff0986.d679d8","type":"debug","z":"c4829f93.87cba","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":400,"y":400,"wires":[]},{"id":"bec9b13d.a859f","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"0,36,48,60,72,84,90,120,240,600","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":40,"wires":[["cdaad243.66727","f7e2edcc.4197f"]]},{"id":"cdaad243.66727","type":"split","z":"af357553.2f0528","name":"","splt":",","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":270,"y":60,"wires":[["7d0ce3c.862e01c"]]},{"id":"9e4a9f66.be3fe","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":350,"y":620,"wires":[]},{"id":"f2efe5f7.236468","type":"switch","z":"af357553.2f0528","name":"<14","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"14","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":260,"wires":[["4047e4d6.ced48c"],["d1912fa7.3ae3e"]]},{"id":"4047e4d6.ced48c","type":"change","z":"af357553.2f0528","name":"+28","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload + 28","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":230,"y":320,"wires":[["5985cc84.fa7814"]]},{"id":"5985cc84.fa7814","type":"change","z":"af357553.2f0528","name":"*4","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload * 4","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":230,"y":400,"wires":[["35a85221.47118e"]]},{"id":"7d0ce3c.862e01c","type":"change","z":"af357553.2f0528","name":"number","rules":[{"t":"set","p":"payload","pt":"msg","to":"$number(payload)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":420,"y":100,"wires":[["fa9c9c0.3e0e868"]]},{"id":"fa9c9c0.3e0e868","type":"change","z":"af357553.2f0528","name":"/6","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload / 6","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":180,"wires":[["f2efe5f7.236468"]]},{"id":"d1912fa7.3ae3e","type":"change","z":"af357553.2f0528","name":"-8","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload - 8","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":320,"wires":[["f7e1050.7b840f8"]]},{"id":"f7e1050.7b840f8","type":"change","z":"af357553.2f0528","name":"*9","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload * 9","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":610,"y":400,"wires":[["35a85221.47118e"]]},{"id":"35a85221.47118e","type":"join","z":"af357553.2f0528","name":"","mode":"auto","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":"false","timeout":"","count":"","reduceRight":false,"x":450,"y":500,"wires":[["9e4a9f66.be3fe"]]},{"id":"f7e2edcc.4197f","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":130,"y":120,"wires":[]},{"id":"b694653d.e163d8","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":360,"y":960,"wires":[["a725682f.417928"]]},{"id":"a725682f.417928","type":"function","z":"af357553.2f0528","name":"","func":"var par0 = Object();\npar0 = {items:[{id: 456, \n                owner_id: -123\n                },\n            ]}\nmsg.payload = par0; \nreturn msg;","outputs":1,"noerr":0,"x":580,"y":980,"wires":[["538d97b5.05a7c8","10179250.67ed8e"]]},{"id":"10179250.67ed8e","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":980,"wires":[]},{"id":"538d97b5.05a7c8","type":"function","z":"af357553.2f0528","name":"","func":"par0 = msg.payload.items[0].owner_id;\nmsg.payload = par0; \nreturn msg;","outputs":1,"noerr":0,"x":610,"y":1080,"wires":[["66b2215d.777e4"]]},{"id":"66b2215d.777e4","type":"change","z":"af357553.2f0528","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"$abs(payload)\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":780,"y":1080,"wires":[["10179250.67ed8e"]]},{"id":"e7f8fa44.75d158","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"123","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":350,"y":860,"wires":[["eb744e5.1b14cb"]]},{"id":"eb744e5.1b14cb","type":"function","z":"af357553.2f0528","name":"","func":"msg.payload = JSON.stringify({\"param\": msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":860,"wires":[["7ea45df4.d8df74"]]},{"id":"7ea45df4.d8df74","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":860,"wires":[]},{"id":"ece92b0b.4fb168","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"","x":360,"y":1200,"wires":[["e074632.a155ba"]]},{"id":"e074632.a155ba","type":"delay","z":"af357553.2f0528","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":580,"y":1200,"wires":[["fd40cb2d.c80c38"]]},{"id":"830f44c4.3fa1c8","type":"status","z":"af357553.2f0528","name":"","scope":["e074632.a155ba","fd40cb2d.c80c38"],"x":360,"y":1280,"wires":[["f376909c.46947","c9fe8a9f.f472d8"]],"info":"# Status"},{"id":"f376909c.46947","type":"function","z":"af357553.2f0528","name":"check status","func":"msg.payload = msg.status\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":1280,"wires":[["6c7bb8f.c2fac48"]]},{"id":"fd40cb2d.c80c38","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":830,"y":1200,"wires":[]},{"id":"f6ea331f.1e798","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":790,"y":1360,"wires":[]},{"id":"c9fe8a9f.f472d8","type":"function","z":"af357553.2f0528","name":"check status","func":"if (msg.status.fill === \"blue\")\n{msg.payload = 'delaying'}\nelse\n{msg.payload = 'not delaying'}\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":1360,"wires":[["f6ea331f.1e798"]]},{"id":"6c7bb8f.c2fac48","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":810,"y":1280,"wires":[]},{"id":"a543ec02.13979","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":1700,"wires":[["53e0f522.20534c"]]},{"id":"10f265df.d57c8a","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":1760,"wires":[["53e0f522.20534c"]]},{"id":"91317c.026f5e88","type":"catch","z":"af357553.2f0528","name":"","scope":["22f5bdb7.ae4af2","e6ab54af.a7ca98"],"uncaught":false,"x":150,"y":1460,"wires":[["8a833ad9.e7d518"]]},{"id":"e6ab54af.a7ca98","type":"function","z":"af357553.2f0528","name":"Throw Error","func":"node.error(\"an example error\", msg);   ","outputs":1,"noerr":0,"x":330,"y":1400,"wires":[[]]},{"id":"8a833ad9.e7d518","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"error","targetType":"msg","x":320,"y":1460,"wires":[]},{"id":"84d5b9d2.76ed68","type":"inject","z":"af357553.2f0528","name":"Trigger error","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":1400,"wires":[["e6ab54af.a7ca98"]]},{"id":"53e0f522.20534c","type":"function","z":"af357553.2f0528","name":"setInterval/clearInterval","func":"var timerId = context.get(\"timerId\") || 0;\n\nfunction start() {\n    if (timerId) stop();// clear the timer if it is already running\n    timerId = setInterval(function() {\n        node.warn(\"Attention\");\n        context.set(\"timerId\", timerId);\n}, 2000);}\n\nfunction stop() {\n    node.warn(\"stop\");\n    clearInterval(timerId);\n    context.set(\"timerId\", 0)\n}\n\nif(msg.payload && timerId === 0){start();}\nif(!msg.payload){stop();}\n\n// setTimeout(function() {\n//   stop();\n//   node.warn(\"off\");\n// }, 20000);\n\n","outputs":1,"noerr":0,"x":390,"y":1720,"wires":[[]]},{"id":"25a8fcb1.8bdc74","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":650,"y":1700,"wires":[["bf3c43ed.d47ce"]]},{"id":"6c5d472e.40f6a8","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":650,"y":1740,"wires":[["bf3c43ed.d47ce"]]},{"id":"bf3c43ed.d47ce","type":"function","z":"af357553.2f0528","name":"setInterval/clearInterval","func":"var timerId = 0;\n\nfunction start() {\nthis.timerId = setInterval(function() {\n  node.warn(\"Attention\");\n}, 2000);}\n\nfunction stop() {\n    node.warn(\"stop\");\n  clearInterval(this.timerId);}\n\nif(msg.payload && timerId === 0){start();}\nif(!msg.payload){stop();}\n\n// setTimeout(function() {\n//   stop();\n//   node.warn(\"off\");\n// }, 20000);\n\n","outputs":1,"noerr":0,"x":890,"y":1720,"wires":[[]]},{"id":"7746d61b.538218","type":"function","z":"af357553.2f0528","name":"flow keys","func":"// flow.set(\"foo\", \"bar\");\n// //msg.payload = flow.keys();\nmsg.payload = flow.get(flow.keys());\nnode.log(\"Something happened\");\nreturn msg;\n\n\n// var outputMsgs = [];\n// var words =  flow.get(flow.keys());\n// for (var w in words) {\n//     outputMsgs.push({payload:words[w]});\n// }\n// return [ outputMsgs ];","outputs":1,"noerr":0,"x":700,"y":1880,"wires":[["80024546.7b0f18"]]},{"id":"80024546.7b0f18","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":910,"y":1880,"wires":[]},{"id":"bf629b98.5a6088","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":500,"y":1880,"wires":[["7746d61b.538218"]]},{"id":"de7e0aa6.834638","type":"function","z":"af357553.2f0528","name":"count in context","func":"// initialise the counter to 0 if it doesn't exist already\nvar count = context.get('count')||0;\ncount += 1;\n// store the value back\ncontext.set('count',count);\n// make it part of the outgoing msg object\nmsg.count = count;\nreturn msg;","outputs":1,"noerr":0,"x":680,"y":1960,"wires":[["80024546.7b0f18","89eb4fbe.54a3a"]]},{"id":"c1b4709d.c6372","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":500,"y":1960,"wires":[["de7e0aa6.834638"]]},{"id":"44064b20.ffb5e4","type":"function","z":"af357553.2f0528","name":"context keys","func":"context.set(\"foo\", \"bar\");\ncontext.set(\"foo1\", \"bar1\");\nmsg.payload = context.keys();\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":2060,"wires":[["80024546.7b0f18"]]},{"id":"ced6389c.6e5ed8","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":480,"y":2060,"wires":[["44064b20.ffb5e4"]]},{"id":"709bab8b.622794","type":"function","z":"af357553.2f0528","name":"","func":"msg.values = \"values\";\nmsg.hours = \"hours\";\nmsg.min = 1;\nmsg.max = 10;\nmsg.states = \"states\";\n//msg.hour = new Date().getHours();\nmsg.unique = 1;\nmsg.shiftup = Math.floor(msg.max/10);\nreturn msg;","outputs":1,"noerr":0,"x":700,"y":2380,"wires":[["a4a79052.d9dd8"]]},{"id":"9b533f96.32969","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":540,"y":2380,"wires":[["709bab8b.622794"]]},{"id":"a4a79052.d9dd8","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":890,"y":2380,"wires":[]},{"id":"891a673e.b4cb18","type":"inject","z":"af357553.2f0528","name":"","topic":"","payload":"5","payloadType":"str","repeat":"","crontab":"","once":false,"x":390,"y":2560,"wires":[["11d2cb8d.8dfd24"]]},{"id":"11d2cb8d.8dfd24","type":"function","z":"af357553.2f0528","name":"BLINK n","func":"var o = false;\nfor (var i=0; i<(msg.payload*2); i++) {\n    node.send( {payload:+(o=!o)} )\n}\n\nreturn null;","outputs":1,"noerr":0,"x":547,"y":2592,"wires":[["80011832.13f0a8"]]},{"id":"80011832.13f0a8","type":"delay","z":"af357553.2f0528","name":"","pauseType":"rate","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":678,"y":2541,"wires":[["bcd2ba5a.456f98"]]},{"id":"bcd2ba5a.456f98","type":"debug","z":"af357553.2f0528","name":"","active":true,"console":"false","complete":"false","x":830,"y":2596,"wires":[]},{"id":"89eb4fbe.54a3a","type":"link out","z":"af357553.2f0528","name":"","links":["69be5f4e.fbead"],"x":940,"y":2040,"wires":[]},{"id":"2807cebd.38be02","type":"catch","z":"af357553.2f0528","name":"","scope":["22f5bdb7.ae4af2"],"uncaught":false,"x":150,"y":1520,"wires":[["deac528c.5ea54"]]},{"id":"deac528c.5ea54","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"error.message","targetType":"msg","x":350,"y":1520,"wires":[]},{"id":"273133a4.0e78ac","type":"inject","z":"af357553.2f0528","name":"Trigger error","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":1580,"wires":[["22f5bdb7.ae4af2"]]},{"id":"22f5bdb7.ae4af2","type":"http request","z":"af357553.2f0528","name":"","method":"GET","ret":"txt","paytoqs":false,"url":"qqqqqq.gg","tls":"","proxy":"","authType":"basic","x":310,"y":1580,"wires":[[]]},{"id":"5de6fd.f9e9d904","type":"trigger","z":"af357553.2f0528","op1":"","op2":"Датчик","op1type":"nul","op2type":"str","duration":"500","extend":false,"units":"ms","reset":"","bytopic":"all","name":"","x":840,"y":580,"wires":[["2f5cf78e.0ecaa8"]]},{"id":"c0b77985.a306b8","type":"inject","z":"af357553.2f0528","name":"Датчик","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":650,"y":580,"wires":[["5de6fd.f9e9d904"]]},{"id":"2f5cf78e.0ecaa8","type":"debug","z":"af357553.2f0528","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1050,"y":580,"wires":[]},{"id":"8a38e14f.4644e","type":"file in","z":"dfb681c3.814b5","name":"subtit.txt","filename":"C:\\Users\\Домашний\\Documents\\subtitr.txt","format":"utf8","chunk":false,"sendError":false,"encoding":"cp1251","x":320,"y":780,"wires":[["cd00ea53.dd0b18"]]},{"id":"cd00ea53.dd0b18","type":"split","z":"dfb681c3.814b5","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":470,"y":860,"wires":[["f701d1.49825e3"]]},{"id":"b65249f0.b9ba18","type":"debug","z":"dfb681c3.814b5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":960,"y":1000,"wires":[]},{"id":"4de02a85.aa8cd4","type":"inject","z":"dfb681c3.814b5","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":660,"wires":[["54366116.ddba7"]]},{"id":"c8428cd4.96935","type":"file","z":"dfb681c3.814b5","name":"subtitout.txt","filename":"C:\\Users\\Домашний\\Documents\\subtitoutr.txt","appendNewline":false,"createDir":false,"overwriteFile":"false","encoding":"utf8","x":1000,"y":920,"wires":[["b65249f0.b9ba18"]]},{"id":"f701d1.49825e3","type":"switch","z":"dfb681c3.814b5","name":"","property":"payload","propertyType":"msg","rules":[{"t":"regex","v":"^(\\d{2}:){2}\\d{2}","vt":"str","case":false},{"t":"regex","v":"^\\d{1,4}\\s","vt":"str","case":false},{"t":"regex","v":"^\\s","vt":"str","case":false},{"t":"else"}],"checkall":"true","repair":false,"outputs":4,"x":640,"y":900,"wires":[[],[],[],["d6fa82ea.38e11"]]},{"id":"d6fa82ea.38e11","type":"switch","z":"dfb681c3.814b5","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":820,"y":920,"wires":[["c8428cd4.96935"]]},{"id":"54366116.ddba7","type":"file in","z":"dfb681c3.814b5","name":"read","filename":"C:\\Users\\Домашний\\Documents\\subtitoutr.txt","format":"utf8","chunk":false,"sendError":true,"encoding":"none","x":150,"y":720,"wires":[["5a840e5a.c6e56"]]},{"id":"5a840e5a.c6e56","type":"switch","z":"dfb681c3.814b5","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":310,"y":720,"wires":[["d9334084.fba29"]]},{"id":"d9334084.fba29","type":"file","z":"dfb681c3.814b5","name":"del","filename":"C:\\Users\\Домашний\\Documents\\subtitoutr.txt","appendNewline":true,"createDir":false,"overwriteFile":"delete","encoding":"none","x":470,"y":720,"wires":[["8a38e14f.4644e"]]},{"id":"3e470e08.551302","type":"catch","z":"dfb681c3.814b5","name":"","scope":["54366116.ddba7"],"uncaught":false,"x":210,"y":860,"wires":[["8a38e14f.4644e"]]},{"id":"27a1680d.bcffc8","type":"inject","z":"dfb681c3.814b5","name":"URL every 15 min","topic":"Кунгуров","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":"30","x":130,"y":220,"wires":[["623c997f.18c338","73ceb3be.81b2ec","b2ec1e76.7829b"]]},{"id":"3a17cb24.3357e4","type":"nbrowser","z":"dfb681c3.814b5","name":"Кунгуров","methods":[{"name":"gotoURL","func":"goto","params":[{"type":"msg","value":"payload","typeDefault":"str"}]}],"prop":"nbrowser","propout":"site","object":"msg","objectout":"flow","close":true,"show":false,"ssl":true,"outputs":0,"x":420,"y":60,"wires":[]},{"id":"bb60cd4d.f1609","type":"html","z":"dfb681c3.814b5","name":"Select all post","property":"payload","outproperty":"payload","tag":".entry","ret":"attr","as":"multi","x":640,"y":220,"wires":[["377e3ecd.8b5d82"]]},{"id":"ea7fb6d6.276098","type":"change","z":"dfb681c3.814b5","name":"content from site","rules":[{"t":"set","p":"payload","pt":"msg","to":"site","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":300,"wires":[["bb60cd4d.f1609"]]},{"id":"377e3ecd.8b5d82","type":"switch","z":"dfb681c3.814b5","name":"first post select","property":"payload","propertyType":"msg","rules":[{"t":"head","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":640,"y":140,"wires":[["4a91b023.805d7"]]},{"id":"623c997f.18c338","type":"delay","z":"dfb681c3.814b5","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":420,"y":260,"wires":[["ea7fb6d6.276098"]]},{"id":"2ccb4ef3.e6bca2","type":"pushbullet","z":"dfb681c3.814b5","config":"8c00412c.036b5","pushtype":"","title":"Node-Red","chan":"","name":"Node-Red notification","x":980,"y":380,"wires":[]},{"id":"639e1a5b.703724","type":"inject","z":"dfb681c3.814b5","name":"","topic":"","payload":"test pushbullet","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":670,"y":380,"wires":[["2ccb4ef3.e6bca2"]]},{"id":"501d5e52.a16a3","type":"catch","z":"dfb681c3.814b5","name":"site","scope":["377e3ecd.8b5d82","3a17cb24.3357e4"],"uncaught":false,"x":110,"y":60,"wires":[["1bfc3b11.c7a905"]]},{"id":"1bfc3b11.c7a905","type":"delay","z":"dfb681c3.814b5","name":"repit","pauseType":"rate","timeout":"5","timeoutUnits":"minutes","rate":"3","nbRateUnits":"10","rateUnits":"minute","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":90,"y":140,"wires":[["623c997f.18c338","d1e36f7e.011e2"]]},{"id":"fcda7b6e.799d38","type":"inject","z":"dfb681c3.814b5","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":420,"y":340,"wires":[["ea7fb6d6.276098"]]},{"id":"51de216e.9e475","type":"change","z":"dfb681c3.814b5","name":"save post","rules":[{"t":"set","p":"#:(file)::post","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":300,"wires":[["2ccb4ef3.e6bca2"]]},{"id":"fcea04a3.df2658","type":"switch","z":"dfb681c3.814b5","name":"compare post","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"#:(file)::post","vt":"flow"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":960,"y":220,"wires":[[],["51de216e.9e475"]]},{"id":"73ceb3be.81b2ec","type":"switch","z":"dfb681c3.814b5","name":"post init","property":"#:(file)::post","propertyType":"flow","rules":[{"t":"nempty"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":200,"y":300,"wires":[[],["989c8a2f.d858e8"]]},{"id":"989c8a2f.d858e8","type":"change","z":"dfb681c3.814b5","name":"","rules":[{"t":"set","p":"#:(file)::post","pt":"flow","to":"\" \"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":210,"y":380,"wires":[[]]},{"id":"c3686050.b0f03","type":"inject","z":"dfb681c3.814b5","name":"init post","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":460,"wires":[["989c8a2f.d858e8"]]},{"id":"4a91b023.805d7","type":"change","z":"dfb681c3.814b5","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.id","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":960,"y":140,"wires":[["fcea04a3.df2658"]]},{"id":"b2ec1e76.7829b","type":"function","z":"dfb681c3.814b5","name":"URL","func":"msg.payload = \"https://kungurov.livejournal.com/\"\nreturn msg;","outputs":1,"noerr":0,"x":450,"y":140,"wires":[["3a17cb24.3357e4"]]},{"id":"d1e36f7e.011e2","type":"delay","z":"dfb681c3.814b5","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":280,"y":140,"wires":[["b2ec1e76.7829b"]]},{"id":"aa2132af.0f515","type":"inject","z":"dfb681c3.814b5","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":680,"y":640,"wires":[["ef5282b9.ef9a"]]},{"id":"199c9f89.602a2","type":"debug","z":"dfb681c3.814b5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1030,"y":640,"wires":[]},{"id":"ef5282b9.ef9a","type":"function","z":"dfb681c3.814b5","name":"obj to array","func":"const obj = {one: 1, two: 2, three: 3};\nmsg.payload = (Object.entries(obj));    \nreturn msg;","outputs":1,"noerr":0,"x":850,"y":640,"wires":[["199c9f89.602a2"]]},{"id":"4d7cb4a0.89ba6c","type":"function","z":"dfb681c3.814b5","name":"array","func":"const array = [['one', 1], ['two', 2], ['three', 3]];\nmsg.payload = array;\nreturn msg;","outputs":1,"noerr":0,"x":830,"y":520,"wires":[["d085da2d.b16578","ba633e66.a9001"]]},{"id":"d085da2d.b16578","type":"debug","z":"dfb681c3.814b5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1030,"y":520,"wires":[]},{"id":"e903a22f.4d5f5","type":"inject","z":"dfb681c3.814b5","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":660,"y":520,"wires":[["4d7cb4a0.89ba6c"]]},{"id":"ba633e66.a9001","type":"function","z":"dfb681c3.814b5","name":"array to obj","func":"msg.payload = Object.fromEntries(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":850,"y":580,"wires":[["e3878a85.672668","ef5282b9.ef9a"]]},{"id":"e3878a85.672668","type":"debug","z":"dfb681c3.814b5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1030,"y":580,"wires":[]},{"id":"edb3b5ec.748168","type":"debug","z":"dfb681c3.814b5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":670,"y":1340,"wires":[]},{"id":"741502f4.9cd7dc","type":"darksky","z":"dfb681c3.814b5","darksky":"d837e845.a0bc08","name":"","lon":"50.192255","lat":"53.248253","date":"","time":"","mode":"message","lang":"ru","units":"si","x":500,"y":1340,"wires":[["edb3b5ec.748168","f23ff1a5.b3c4"]]},{"id":"4b76f384.ab4ebc","type":"inject","z":"dfb681c3.814b5","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":1340,"wires":[["741502f4.9cd7dc"]]},{"id":"f23ff1a5.b3c4","type":"function","z":"dfb681c3.814b5","name":"sunrise","func":"function getYoutubeLikeToDisplay(millisec) {\n    var seconds = (millisec / 100000).toFixed(0);\n    var minutes = Math.floor(seconds / 60);\n    var hours = \"\";\n    if (minutes > 59) {\n        hours = Math.floor(minutes / 60);\n        hours = (hours >= 10) ? hours : \"0\" + hours;\n        minutes = minutes - (hours * 60);\n        minutes = (minutes >= 10) ? minutes : \"0\" + minutes;\n    }\n\n    seconds = Math.floor(seconds % 60);\n    seconds = (seconds >= 10) ? seconds : \"0\" + seconds;\n    if (hours !== \"\") {\n        return hours + \":\" + minutes + \":\" + seconds;\n    }\n    return minutes + \":\" + seconds;\n}\nvar sunrise = getYoutubeLikeToDisplay(msg.payload.sunrise);\nmsg.payload = sunrise;\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":1500,"wires":[["58872589.cc492c"]]},{"id":"58872589.cc492c","type":"debug","z":"dfb681c3.814b5","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":780,"y":1500,"wires":[]},{"id":"34785986.504006","type":"switch","z":"edd42ef7.16d9c","name":"","property":"payload.type","propertyType":"msg","rules":[{"t":"cont","v":"photo","vt":"str"},{"t":"cont","v":"message","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":750,"y":340,"wires":[["1c869274.a9147e"],["cf01f827.f3b908"],["356e11ec.a7aa4e"]]},{"id":"bceb6ff5.1c06c","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":220,"wires":[["adabe97a.c40058"]]},{"id":"55de2e6f.e30b6","type":"function","z":"edd42ef7.16d9c","name":"send message","func":"msg.payload = {\n    \"chatId\": 123456789,\n    \"messageId\": 2,\n    \"type\": \"message\",\n    \"content\": \"какой то текст\"\n}\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":300,"wires":[["fc5e4e8.1756bb","34785986.504006"]]},{"id":"e50214db.b12558","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":300,"wires":[["55de2e6f.e30b6"]]},{"id":"1c869274.a9147e","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":340,"wires":[]},{"id":"cf01f827.f3b908","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":380,"wires":[]},{"id":"356e11ec.a7aa4e","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":420,"wires":[]},{"id":"f673944f.608848","type":"function","z":"edd42ef7.16d9c","name":"send audio","func":"msg.payload = {\n    \"chatId\": 123456789,\n    \"messageId\": 3,\n    \"type\": \"audio\",\n    \"content\": \"audio.mp3\"\n}\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":360,"wires":[["fc5e4e8.1756bb","34785986.504006"]]},{"id":"9182b521.e6f788","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":360,"wires":[["f673944f.608848"]]},{"id":"af7a93b2.8f3cf","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.content","targetType":"msg","x":1000,"y":220,"wires":[]},{"id":"c616833f.8e07f","type":"change","z":"edd42ef7.16d9c","name":"content","rules":[{"t":"set","p":"payload","pt":"msg","to":"telega.content","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":60,"wires":[["7c298b10.d521b4"]]},{"id":"fc5e4e8.1756bb","type":"function","z":"edd42ef7.16d9c","name":"switch","func":"if (msg.payload.type === 'photo') {\n    return [msg, null, null];\n} else if (msg.payload.type === 'message') {\n    return [null, msg, null];\n} else \nreturn [null, null, msg];","outputs":3,"noerr":0,"x":750,"y":280,"wires":[["af7a93b2.8f3cf"],["6c85708b.09034"],["42d7282.fe5a4d8"]]},{"id":"3cdb72e9.dfa99e","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":120,"wires":[]},{"id":"6c85708b.09034","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.content","targetType":"msg","x":1000,"y":260,"wires":[]},{"id":"42d7282.fe5a4d8","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.content","targetType":"msg","x":1000,"y":300,"wires":[]},{"id":"337303cf.831c4c","type":"function","z":"edd42ef7.16d9c","name":"add field to flow.obj","func":"var myCount = flow.get(\"telega\");\nmyCount.content = \"New Content\";\nmyCount.newfield = \"new field\";\nflow.set(\"telega\", myCount);\nmsg.payload = flow.get(\"telega\");\nreturn msg;","outputs":1,"noerr":0,"x":710,"y":180,"wires":[["5787d33b.99d25c","3b84bf24.80dc3"]]},{"id":"7c298b10.d521b4","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":60,"wires":[]},{"id":"5787d33b.99d25c","type":"function","z":"edd42ef7.16d9c","name":"Object assign with flow.obj","func":"var myCount = flow.get(\"telega\");\nconst newObj = Object.create(null);\n//const newObj = new Object({});\nnewObj.newDateField = new Date().toLocaleString('en-US', { timeZone: \"Etc/GMT-4\" });\nObject.assign(myCount, newObj)\nflow.set(\"telega\", myCount);\nmsg.payload = flow.get(\"telega\");\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":120,"wires":[["3cdb72e9.dfa99e"]]},{"id":"3b84bf24.80dc3","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":180,"wires":[]},{"id":"64ea268f.8a70c8","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"one","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":480,"wires":[["48c3b90f.ea6238"]]},{"id":"da80157e.62a308","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"three","payload":"{\"data1\":123,\"data2\":567}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":210,"y":640,"wires":[["8c017dad.64644","ca0bf80e.b6ff58","ecd4fbfa.f67d28","b055297f.60e0e8"]]},{"id":"9212e58c.e15658","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"two","payload":"какое то описание","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":560,"wires":[["8c017dad.64644"]]},{"id":"8c017dad.64644","type":"function","z":"edd42ef7.16d9c","name":"Set field to flow.obj from msg","func":"var myCount = flow.get(\"telega\");\nmyCount[msg.topic] = msg.payload;\nflow.set(\"telega\", myCount);\nmsg.payload = flow.get(\"telega\");\nreturn msg;","outputs":1,"noerr":0,"x":700,"y":480,"wires":[["b01c5ddf.87c7b"]]},{"id":"b01c5ddf.87c7b","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":480,"wires":[]},{"id":"48c3b90f.ea6238","type":"function","z":"edd42ef7.16d9c","name":"convert date","func":"const date = new Date();\ndate.setTime(msg.payload);\nmsg.payload = date.toLocaleString('en-US', { timeZone: \"Etc/GMT-4\" });\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":480,"wires":[["8c017dad.64644"]]},{"id":"ca0bf80e.b6ff58","type":"function","z":"edd42ef7.16d9c","name":"obj to array","func":"const obj = msg.payload;\nmsg.payload = Object.entries(obj);    \nreturn msg;","outputs":1,"noerr":0,"x":650,"y":560,"wires":[["b03e4d75.e3174","cf4b69a9.3fd868"]]},{"id":"b03e4d75.e3174","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":560,"wires":[]},{"id":"cf4b69a9.3fd868","type":"function","z":"edd42ef7.16d9c","name":"new array from data","func":"const msg1 = {payload: msg.payload.map(([,item]) => item)};\nconst msg2 = {payload: msg.payload.map(([key]) => key)};\nreturn [msg1, msg2];","outputs":2,"noerr":0,"x":680,"y":620,"wires":[["5394cc97.9435d4"],["2a68fbc0.8cb0f4"]]},{"id":"5394cc97.9435d4","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":600,"wires":[]},{"id":"bf6534c2.f7ec88","type":"function","z":"edd42ef7.16d9c","name":"sum*2","func":"const transform = (item) => {\n    return item * 2;\n}\n\nconst obj = msg.payload;\nmsg.payload = [...obj].map(transform).reduce((acc, item) => acc + item, 0);    \nreturn msg;\n\n","outputs":1,"noerr":0,"x":630,"y":780,"wires":[["113dd8b6.6ece87"]]},{"id":"113dd8b6.6ece87","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":780,"wires":[]},{"id":"429c271e.1ac4b8","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"12345","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":780,"wires":[["bf6534c2.f7ec88","ce4245b0.419c58","b055297f.60e0e8"]]},{"id":"adabe97a.c40058","type":"function","z":"edd42ef7.16d9c","name":"create obj (send picture)","func":"msg.payload = {\n    \"chatId\": 123456789,\n    \"messageId\": 1,\n    \"type\": \"photo\",\n    \"content\": \"foo.jpeg\"\n}\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":220,"wires":[["cde01bd1.a6fbc8","fc5e4e8.1756bb","34785986.504006"]]},{"id":"cde01bd1.a6fbc8","type":"change","z":"edd42ef7.16d9c","name":"set flow.obj","rules":[{"t":"set","p":"telega","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":60,"wires":[["c616833f.8e07f","337303cf.831c4c"]]},{"id":"aec4103.c1de6f","type":"function","z":"edd42ef7.16d9c","name":"2 Object create","func":"const newObj1 = Object.create(null);\nconst newObj2 = new Object({});\nnewObj1.newDateField1 = new Date().toLocaleString('en-US', { timeZone: \"Etc/GMT-4\" });\nnewObj2.newDateField2 = new Date().toLocaleString('en-US', { timeZone: \"Etc/GMT-4\" });\nconst msg1 = { payload: newObj1 };\nconst msg2 = { payload: newObj2 };\nreturn [msg1, msg2];","outputs":2,"noerr":0,"x":660,"y":860,"wires":[["442508ba.fe8438"],["1ef19a4f.29dea6"]]},{"id":"f021c256.aff6d","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":860,"wires":[["aec4103.c1de6f"]]},{"id":"442508ba.fe8438","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":820,"wires":[]},{"id":"1ef19a4f.29dea6","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":860,"wires":[]},{"id":"2a68fbc0.8cb0f4","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":640,"wires":[]},{"id":"ce4245b0.419c58","type":"function","z":"edd42ef7.16d9c","name":"length","func":"const newMsg = { payload: msg.payload.length };\nreturn [msg, newMsg];","outputs":2,"noerr":0,"x":630,"y":820,"wires":[["442508ba.fe8438"],["1ef19a4f.29dea6"]]},{"id":"143f26cf.e25839","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":390,"y":1020,"wires":[["78ebacb3.859124"]]},{"id":"dc50d74.44de328","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":1040,"wires":[]},{"id":"78ebacb3.859124","type":"switch","z":"edd42ef7.16d9c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":670,"y":1040,"wires":[["dc50d74.44de328"],["dc50d74.44de328"]]},{"id":"6d6b1c1b.9e6644","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":390,"y":1060,"wires":[["78ebacb3.859124"]]},{"id":"877593a5.4d66a","type":"change","z":"edd42ef7.16d9c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.state","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":700,"y":1160,"wires":[["4529c171.37a21"]]},{"id":"4529c171.37a21","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":950,"y":1160,"wires":[]},{"id":"adc363ba.78488","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"{\"state\":false}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":590,"y":1220,"wires":[["877593a5.4d66a","4529c171.37a21"]]},{"id":"bd56279f.8b6928","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"{\"state\":true}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":590,"y":1100,"wires":[["4529c171.37a21","877593a5.4d66a"]]},{"id":"b98c7ba9.4b36a8","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":240,"y":1300,"wires":[["97181ea9.777f"]]},{"id":"d26fd132.b2922","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":690,"y":1300,"wires":[]},{"id":"97181ea9.777f","type":"function","z":"edd42ef7.16d9c","name":"for","func":"for(let i=0; i<10; i++) {\n    node.send({payload:i});\n}\n \n    ","outputs":1,"noerr":0,"x":460,"y":1300,"wires":[["d26fd132.b2922"]]},{"id":"7c942574.26c1fc","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":330,"y":1440,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"688f9b49.bcc9a4","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":330,"y":1500,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"72523555.371b3c","type":"debug","z":"edd42ef7.16d9c","name":"результат","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":980,"y":1560,"wires":[]},{"id":"9689a147.50cd9","type":"function","z":"edd42ef7.16d9c","name":"x = !x (0,1)","func":"if ((typeof msg.payload === 'number') && (msg.payload === 0 || msg.payload === 1 )) {\n    msg.payload = +!msg.payload\n    return [msg, null]\n} else {\n    msg.payload = 'Ошибка данных';\n    return [null, msg]\n}","outputs":2,"noerr":0,"x":810,"y":1660,"wires":[["72523555.371b3c"],["d6344068.b58c5"]]},{"id":"3d97cfd5.7d8de","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":450,"y":1800,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"7799c837.7b5f18","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"false","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":450,"y":1740,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"8c170156.3a7d7","type":"inject","z":"edd42ef7.16d9c","name":"String 0","topic":"","payload":"0","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":450,"y":1860,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"d6344068.b58c5","type":"debug","z":"edd42ef7.16d9c","name":"ошибка","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":1000,"y":1680,"wires":[]},{"id":"1ec06711.12afd9","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":450,"y":1680,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"cd38e67b.e373d8","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":440,"y":1620,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"6827e0d4.6e023","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"1.001","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":450,"y":1920,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"5f368809.501f98","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"1.00","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":330,"y":1560,"wires":[["9689a147.50cd9","c8688f07.c192f"]]},{"id":"c8688f07.c192f","type":"function","z":"edd42ef7.16d9c","name":"if","func":"if (msg.payload) {msg.payload=0;}\nelse {msg.payload=1;}\n\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":1540,"wires":[["72523555.371b3c"]]},{"id":"ecd4fbfa.f67d28","type":"split","z":"edd42ef7.16d9c","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":630,"y":680,"wires":[["6cb8ab31.4bfa34"]]},{"id":"6cb8ab31.4bfa34","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":680,"wires":[]},{"id":"b055297f.60e0e8","type":"function","z":"edd42ef7.16d9c","name":"","func":"msg.payload = [...msg.payload];\n//msg.payload = msg.payload.split(', ')\nreturn msg;","outputs":1,"noerr":0,"x":630,"y":720,"wires":[["13b57fe1.0c8fa"]]},{"id":"13b57fe1.0c8fa","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":720,"wires":[]},{"id":"7a5fc770.0fe678","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"{\"obj1\":{\"data1\":111,\"data2\":222},\"obj2\":{\"data3\":333,\"data4\":444}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":610,"y":1960,"wires":[["3baf5af2.166e46","1c69fd2f.150eb3"]]},{"id":"3baf5af2.166e46","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":1820,"wires":[]},{"id":"1c69fd2f.150eb3","type":"split","z":"edd42ef7.16d9c","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":750,"y":2040,"wires":[["d0334065.46bd4","57b3d745.d9e8f8"]]},{"id":"d0334065.46bd4","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":1940,"wires":[]},{"id":"57b3d745.d9e8f8","type":"split","z":"edd42ef7.16d9c","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":770,"y":2140,"wires":[["6dbc343e.c2379c"]]},{"id":"6dbc343e.c2379c","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":2060,"wires":[]},{"id":"581eaa80.ba1924","type":"function","z":"edd42ef7.16d9c","name":"","func":"var a = 0.004790;\nvar b = 23;\nvar c = -37;\nvar d = 90;\nvar e = 70;\nvar f = 0.3;\nvar g = msg.payload;\n\nvar h = (b-g) / (b-c);\n//msg.payload = h;\nvar t = Math.pow(b+0.5*(d-e)*h+0.5*(d+e-2*d)*h, 1/(1+f));\nmsg.payload = t;\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":2320,"wires":[["8fc401fc.4beff"]]},{"id":"8fc401fc.4beff","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1000,"y":2320,"wires":[]},{"id":"1e3e2295.170ded","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"24.19","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":550,"y":2320,"wires":[["581eaa80.ba1924"]]},{"id":"8d7ee637.a31ad8","type":"inject","z":"edd42ef7.16d9c","name":"decrement","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":2220,"wires":[["d75f81df.113cd"]]},{"id":"9c79cdab.1c619","type":"inject","z":"edd42ef7.16d9c","name":"increment","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":140,"y":2180,"wires":[["5bce7a34.9ef7d4"]]},{"id":"de4af59e.bd6248","type":"inject","z":"edd42ef7.16d9c","name":"reset","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":130,"y":2260,"wires":[["63e5a9cd.5ee3b8"]]},{"id":"5bce7a34.9ef7d4","type":"function","z":"edd42ef7.16d9c","name":"msg object","func":"msg.increment = 2;\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":2180,"wires":[["805bf66a.42ac28"]]},{"id":"63e5a9cd.5ee3b8","type":"function","z":"edd42ef7.16d9c","name":"msg object","func":"msg.reset = true;\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":2260,"wires":[["805bf66a.42ac28"]]},{"id":"d75f81df.113cd","type":"function","z":"edd42ef7.16d9c","name":"msg object","func":"msg.decrement = 1;\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":2220,"wires":[["805bf66a.42ac28"]]},{"id":"805bf66a.42ac28","type":"counter","z":"edd42ef7.16d9c","name":"","init":"0","step":1,"lower":null,"upper":null,"mode":"increment","outputs":"1","x":500,"y":2200,"wires":[["9016220.7ef3be"]]},{"id":"86996da3.b3c9f","type":"inject","z":"edd42ef7.16d9c","name":"normal msg without control parameter","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"x":230,"y":2140,"wires":[["805bf66a.42ac28"]]},{"id":"9016220.7ef3be","type":"debug","z":"edd42ef7.16d9c","name":"message","active":true,"console":"false","complete":"true","x":660,"y":2200,"wires":[]},{"id":"82446996.b4d518","type":"function","z":"edd42ef7.16d9c","name":"","func":"var now     = new Date(); \nvar hour    = now.getHours();\nvar tPrefix = \"zway/\";\nvar tPostfix = \"/set\";\nif(hour >= 9 && hour < 23 )  \n{\n    if (msg)\n    {   \n        var i = context.get('light_counter')||0;\n        i += 1;\n        if (i >= 100) i = 1;\n        context.set('light_counter', i);\n    }\nmsg =\n    [\n        {topic: tPrefix + \"coldLight\" + tPostfix, payload:i},\n        {topic: tPrefix + \"warmLight\" + tPostfix, payload:100-i}\n    ]; \n   return [msg];\n}","outputs":1,"noerr":0,"x":780,"y":2400,"wires":[["5ca5d8af.b3a2d8"]]},{"id":"5ca5d8af.b3a2d8","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1020,"y":2400,"wires":[]},{"id":"9506b67c.233fa8","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":540,"y":2400,"wires":[["82446996.b4d518"]]},{"id":"1a8c79da.9cd9c6","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":440,"y":2560,"wires":[["ea0ff19a.4706"]]},{"id":"ea0ff19a.4706","type":"function","z":"edd42ef7.16d9c","name":"counter","func":"var now     = new Date(); \nvar hour    = now.getHours();\n\nif(hour.toString() > 9 && hour.toString() < 18 )  \n{\n    if (msg)\n    {   \n        context.flow.counter = context.flow.counter + 1\n        if (context.flow.counter === 5)\n            {\n                context.flow.counter = 0\n                \n            }\n    }\n    msg.payload = {\"counter\":context.flow.counter, \"hour\":hour.toString()}\n    return msg\n}\n","outputs":1,"noerr":0,"x":660,"y":2560,"wires":[["7e779ef.c12c26"]]},{"id":"7e779ef.c12c26","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":2620,"wires":[]},{"id":"891772ca.76012","type":"function","z":"edd42ef7.16d9c","name":"Init counter global","func":"\n//flow.set(\"counter\", 2);\ncontext.flow.counter = 1;\n//msg.payload = flow.get(\"counter\");//context.flow.counter;\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":2500,"wires":[["40c793f4.34cbcc"]]},{"id":"f922f8ef.ac4628","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":450,"y":2500,"wires":[["891772ca.76012"]]},{"id":"b7312e11.7849b","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":2480,"wires":[]},{"id":"40c793f4.34cbcc","type":"switch","z":"edd42ef7.16d9c","name":"","property":"counter","propertyType":"flow","rules":[{"t":"eq","v":"1","vt":"str"},{"t":"eq","v":"2","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":830,"y":2500,"wires":[["b7312e11.7849b"],["bf7f3fe3.ec35d"],["5a3cdf57.58416"]]},{"id":"bf7f3fe3.ec35d","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":2520,"wires":[]},{"id":"4955d567.e015dc","type":"inject","z":"edd42ef7.16d9c","name":"","topic":"","payload":"counter","payloadType":"flow","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":670,"y":2700,"wires":[["30b4603f.3feab"]]},{"id":"30b4603f.3feab","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":900,"y":2700,"wires":[]},{"id":"5a3cdf57.58416","type":"debug","z":"edd42ef7.16d9c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":2560,"wires":[]},{"id":"a3f6f70a.4ebdb8","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":80,"wires":[["40efc64a.579b38"]]},{"id":"c7d546e4.6433a8","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":500,"y":80,"wires":[]},{"id":"40efc64a.579b38","type":"function","z":"1635ef5e.c89941","name":"","func":"var start = 80;\nvar end = 20;\nvar i = start;\n\nvar timerId = setInterval(\n    () => {\n        i--;\n        node.send({topic:\"dimmer\", payload: i});\n        if (i == end)\n            clearInterval(timerId);\n    }, \n    200\n);\n\nreturn;","outputs":1,"noerr":0,"x":320,"y":100,"wires":[["c7d546e4.6433a8"]]},{"id":"e0a4a7d5.7886d8","type":"http in","z":"1635ef5e.c89941","name":"","url":"/react","method":"post","upload":false,"swaggerDoc":"","x":500,"y":260,"wires":[["9c74ccb8.a2252","eafe0a68.6a6b28"]]},{"id":"9c74ccb8.a2252","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":760,"y":280,"wires":[]},{"id":"eafe0a68.6a6b28","type":"template","z":"1635ef5e.c89941","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"This is the payload: {{payload}} !","output":"str","x":700,"y":380,"wires":[["e1872acb.76b248","9c74ccb8.a2252"]]},{"id":"e1872acb.76b248","type":"http response","z":"1635ef5e.c89941","name":"","statusCode":"","headers":{},"x":940,"y":380,"wires":[]},{"id":"facf42f0.ee1c9","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":540,"wires":[["8da74522.f41d48"]]},{"id":"e628ebd4.0ff828","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":800,"y":680,"wires":[]},{"id":"8da74522.f41d48","type":"function","z":"1635ef5e.c89941","name":"","func":"var columns = [`btn-info`, `btn-info`, `btn-danger`, `btn-info`, `btn-info`];\nvar events = [];\nvar rows = [5, 3, 9, 2, 1];\n\n\nvar result =  rows.map(function(result, field, index) {\n    result[`index ${index} field ${field}`];\n    return result\n  }, {});\n  \nvar resultmap = Object.entries(result) \n\nrows.map((item, index) => {\n    events.push(`index ${item} field ${columns[index]}`)\n    \n})\n\n//events.map(event=><Item key={event.id} title={event.name} />)\n\nmsg.payload = events;\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":620,"wires":[["e628ebd4.0ff828"]]},{"id":"fd289ccb.f979a","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":260,"y":940,"wires":[["7266f739.fc3eb8"]]},{"id":"96da316c.eb4eb","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":840,"y":860,"wires":[]},{"id":"9948c5e5.db7268","type":"function","z":"1635ef5e.c89941","name":"","func":"msg.payload = msg.payload(1, 2);\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":860,"wires":[["96da316c.eb4eb"]]},{"id":"58a1a7af.7be158","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":670,"y":1040,"wires":[]},{"id":"35ec348e.f43dec","type":"function","z":"1635ef5e.c89941","name":"","func":"msg.payload = (a, b) => ( a + b + 4 );\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":780,"wires":[["9948c5e5.db7268"]]},{"id":"3036f015.8ec08","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":340,"y":780,"wires":[["35ec348e.f43dec"]]},{"id":"c5d428f7.279b68","type":"function","z":"1635ef5e.c89941","name":"","func":"var sum = new Function(msg.payload[0], msg.payload[1]);\nvar a = 1, b = 2;\nmsg.payload = sum(a, b);\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":940,"wires":[["96da316c.eb4eb"]]},{"id":"7266f739.fc3eb8","type":"function","z":"1635ef5e.c89941","name":"","func":"var sum = [\"a, b\",\" return a + b; \"];\nmsg.payload = sum;\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":940,"wires":[["58a1a7af.7be158","c5d428f7.279b68"]]},{"id":"f73ef93b.0d0678","type":"inject","z":"1635ef5e.c89941","name":"Init 10","topic":"","payload":"10","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":550,"y":1220,"wires":[["47029472.ffdd8c"]]},{"id":"47029472.ffdd8c","type":"function","z":"1635ef5e.c89941","name":"Счетчик","func":"function makeCounter() {\n  var currentCount = 1;\n\n  // возвращаемся к функции\n  function counter() {\n    return currentCount;\n  }\n\n  // ...и добавляем ей методы!\n  counter.set = function(value) {\n    currentCount = value;\n  };\n\n  counter.inc = function() {\n    currentCount++;\n  };\n  \n  counter.dec = function() {\n    currentCount--;\n  };\n  \n  counter.reset = function() {\n    currentCount = 1;\n  };\n\n  return counter;\n}\n\nvar counter =  makeCounter();\ncounter.set(msg.payload);\nflow.set(\"counter\", counter);\n\nmsg.payload = counter();\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":1220,"wires":[["d23ba4c4.3ce758"]]},{"id":"d23ba4c4.3ce758","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":1220,"wires":[]},{"id":"fc87691e.8a9588","type":"inject","z":"1635ef5e.c89941","name":"Inc","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":550,"y":1280,"wires":[["cf9b3079.c0ec"]]},{"id":"cf9b3079.c0ec","type":"function","z":"1635ef5e.c89941","name":"Inc","func":"var counter = flow.get(\"counter\");\ncounter.inc();\nmsg.payload = counter();\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":1280,"wires":[["d23ba4c4.3ce758"]]},{"id":"92442130.8f187","type":"function","z":"1635ef5e.c89941","name":"reset","func":"var counter = flow.get(\"counter\");\ncounter.reset();\nmsg.payload = counter();\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":1400,"wires":[["d23ba4c4.3ce758"]]},{"id":"873df8ce.ef6798","type":"inject","z":"1635ef5e.c89941","name":"Reset","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":550,"y":1400,"wires":[["92442130.8f187"]]},{"id":"a36c57ed.797948","type":"inject","z":"1635ef5e.c89941","name":"Dec","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":550,"y":1340,"wires":[["1eb54bcd.4521f4"]]},{"id":"1eb54bcd.4521f4","type":"function","z":"1635ef5e.c89941","name":"Dec","func":"var counter = flow.get(\"counter\");\ncounter.dec();\nmsg.payload = counter();\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":1340,"wires":[["d23ba4c4.3ce758"]]},{"id":"e6fcff07.1882f","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":580,"y":520,"wires":[["156278b0.a81057"]]},{"id":"681a62dc.65038c","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":520,"wires":[]},{"id":"156278b0.a81057","type":"function","z":"1635ef5e.c89941","name":"n = !n","func":"flow.set(\"state\", !flow.get(\"state\") || false);\nmsg.payload = flow.get(\"state\");\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":520,"wires":[["681a62dc.65038c"]]},{"id":"83704243.0ed8a","type":"function","z":"1635ef5e.c89941","name":"n = !n","func":"flow.set(\"state\", !flow.get(\"state\") || false);\nmsg.payload = {...msg.payload, set: flow.get(\"state\")};\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":1600,"wires":[["4057a5d1.f39b4c"]]},{"id":"d18366da.a24188","type":"function","z":"1635ef5e.c89941","name":"set text button","func":"msg.payload = {\n    \"on\": \"Открыто\",\n    \"off\": \"Закрыто\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":1600,"wires":[["83704243.0ed8a"]]},{"id":"4057a5d1.f39b4c","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.set","targetType":"msg","x":820,"y":1600,"wires":[]},{"id":"40bcbc5d.47a764","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":200,"y":1600,"wires":[["d18366da.a24188"]]},{"id":"330073fd.69e0dc","type":"function","z":"1635ef5e.c89941","name":"n = !n","func":"flow.set(\"state\", !flow.get(\"state\") || false);\nmsg.payload = flow.get(\"state\");\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":1480,"wires":[[]]},{"id":"d348ad2.8c7fb5","type":"function","z":"1635ef5e.c89941","name":"n = !n","func":"flow.set(\"state\", !flow.get(\"state\") || false);\n//Object.assign(msg.payload, {\"set\": flow.get(\"state\")})\nmsg.payload = {...msg.payload, set: flow.get(\"state\")};\nreturn msg;","outputs":1,"noerr":0,"x":670,"y":1480,"wires":[[]]},{"id":"631b079a.0cfda8","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":260,"y":1760,"wires":[["56c3bda0.e91d44"]]},{"id":"1720467b.363c9a","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":870,"y":1800,"wires":[]},{"id":"924a2fcd.505e3","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":870,"y":1880,"wires":[]},{"id":"2f2bdd55.54c102","type":"function","z":"1635ef5e.c89941","name":"spread","func":"msg.payload = {...msg.payload, set: 100};\nreturn msg;","outputs":1,"noerr":0,"x":700,"y":1840,"wires":[["924a2fcd.505e3"]]},{"id":"56c3bda0.e91d44","type":"function","z":"1635ef5e.c89941","name":"create obj (send picture)","func":"msg.payload = {\n    \"chatId\": 123456789,\n    \"messageId\": 1,\n    \"type\": \"photo\",\n    \"content\": \"foo.jpeg\"\n}\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"x":490,"y":1800,"wires":[["2f2bdd55.54c102","1720467b.363c9a"]]},{"id":"1fb8488e.442757","type":"http request","z":"a8befc30.c457","name":"","method":"GET","ret":"bin","paytoqs":false,"url":"http://192.168.1.99/cgi-bin/snapshot.cgi","tls":"","proxy":"","authType":"basic","x":330,"y":60,"wires":[["970d2765.550a48"]]},{"id":"a67bf397.83501","type":"ui_template","z":"a8befc30.c457","group":"eb7f92d0.0d7fc","name":"Display image","order":1,"width":"0","height":"0","format":"<img width=\"816\" height=\"612\" alt=\"mjpeg test...\" src=\"data:image/jpg;base64,{{msg.payload}}\" />\n","storeOutMessages":true,"fwdInMessages":true,"templateScope":"local","x":712.3645515441895,"y":60.60416030883789,"wires":[[]]},{"id":"970d2765.550a48","type":"base64","z":"a8befc30.c457","name":"Encode","action":"","property":"payload","x":532.3645515441895,"y":60.60416030883789,"wires":[["a67bf397.83501"]]},{"id":"254fcc0c.9c10f4","type":"inject","z":"a8befc30.c457","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":112.36455154418945,"y":60.60416030883789,"wires":[["1fb8488e.442757"]]},{"id":"2a56d36a.05052c","type":"function","z":"1635ef5e.c89941","name":"","func":"var o = { then: function(){return 5} };\n// связать `v` через `[[Prototype]]` с `o`\nvar v = Object.create( o );\nv.someStuff = \"cool\";\n\nv.otherStuff = \"not so cool\";\n\n\nmsg.payload = v.then();\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":2080,"wires":[["e640feb9.a3898"]]},{"id":"e640feb9.a3898","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":860,"y":2080,"wires":[]},{"id":"1dc2f1da.15c51e","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":440,"y":2080,"wires":[["2a56d36a.05052c"]]},{"id":"24302885.abf958","type":"http in","z":"a8befc30.c457","name":"","url":"/products","method":"get","upload":false,"swaggerDoc":"","x":82.36455154418945,"y":200.6041603088379,"wires":[["bdf1042b.f0a278"]]},{"id":"63b86b28.c6a6e4","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":782.3645515441895,"y":200.6041603088379,"wires":[]},{"id":"bdf1042b.f0a278","type":"file in","z":"a8befc30.c457","name":"products","filename":"C:\\OpenServer\\domains\\react\\primer-api\\products\\products.data","format":"utf8","chunk":false,"sendError":false,"encoding":"none","x":292.36455154418945,"y":200.6041603088379,"wires":[["3fe357bc.ee53d8"]]},{"id":"3fe357bc.ee53d8","type":"json","z":"a8befc30.c457","name":"","property":"payload","action":"","pretty":false,"x":462.36455154418945,"y":200.6041603088379,"wires":[["63b86b28.c6a6e4","b37d79fb.6e6848"]]},{"id":"b37d79fb.6e6848","type":"http response","z":"a8befc30.c457","name":"","statusCode":"","headers":{},"x":782.3645515441895,"y":140.6041603088379,"wires":[]},{"id":"8e30e19a.34e2a","type":"http in","z":"a8befc30.c457","name":"","url":"/hello-form","method":"get","upload":false,"swaggerDoc":"","x":92.36455154418945,"y":280.6041603088379,"wires":[["3befc5dc.6641ea"]]},{"id":"1f0ea173.c32b3f","type":"http in","z":"a8befc30.c457","name":"","url":"/hello-form","method":"post","swaggerDoc":"","x":92.36455154418945,"y":360.6041603088379,"wires":[["94fc7661.cd71c8"]]},{"id":"3befc5dc.6641ea","type":"template","z":"a8befc30.c457","name":"page","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head></head>\n    <body>\n        <h1>Hello {{ payload.name }}!</h1>\n        <form id=\"form\" action=\"http://localhost:1880/hello-form\" method=\"post\">\n            <input id=\"a1\" name=\"name\" value={{ payload.name }}>\n            <button>Say hello</button>\n        </form>\n    </body>\n</html>","x":502.36455154418945,"y":360.6041603088379,"wires":[["e741bf87.5a50e"]]},{"id":"e741bf87.5a50e","type":"http response","z":"a8befc30.c457","name":"","x":722.3645515441895,"y":360.6041603088379,"wires":[]},{"id":"94fc7661.cd71c8","type":"function","z":"a8befc30.c457","name":"stupid","func":"msg.payload.name = \"stupid \" + msg.payload.name\nreturn msg;","outputs":1,"noerr":0,"x":282.36455154418945,"y":360.6041603088379,"wires":[["3befc5dc.6641ea"]]},{"id":"a012e4ca.1e6318","type":"template","z":"a8befc30.c457","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<form id=\"formElem\">\n  <input type=\"text\" name=\"name\" value=\"John\">\n  <input type=\"text\" name=\"surname\" value=\"Smith\">\n  <input type=\"submit\">\n</form>\n\n<script>\nformElem.onsubmit = async (e) => { \n    e.preventDefault(); \nlet response = await fetch('/post/user', {\n    method: 'POST',\n    contentType : \"application/json\",\n    body: new FormData(formElem)\n});\n\nreturn await response.json()}\n</script>\n\n","output":"str","x":492.36455154418945,"y":460.6041603088379,"wires":[["5086eca8.debae4"]]},{"id":"c075de0d.23fe7","type":"http in","z":"a8befc30.c457","name":"","url":"/form","method":"get","upload":false,"swaggerDoc":"","x":272.36455154418945,"y":460.6041603088379,"wires":[["a012e4ca.1e6318"]]},{"id":"5086eca8.debae4","type":"http response","z":"a8befc30.c457","name":"","statusCode":"","headers":{},"x":742.3645515441895,"y":460.6041603088379,"wires":[]},{"id":"bdb4fbcd.be8308","type":"http in","z":"a8befc30.c457","name":"","url":"/post/user","method":"post","upload":false,"swaggerDoc":"","x":492.36455154418945,"y":540.6041603088379,"wires":[["5086eca8.debae4","14e1bb47.7bcee5"]]},{"id":"b7d004b3.0a12d8","type":"nbrowser","z":"a8befc30.c457","name":"","methods":[{"name":"gotoURL","func":"goto","params":[{"type":"msg","value":"payload","typeDefault":"str"}]},{"name":"wait","func":"wait","params":[{"type":"str","value":"3","typeDefault":"str"}]},{"name":"select","func":"select","params":[{"type":"str","value":"#formElem > input[type=text]:nth-child(1)","typeDefault":"str"},{"type":"str","value":"","typeDefault":"str"}]},{"name":"insert","func":"insert","params":[{"type":"str","value":"#formElem > input[type=text]:nth-child(1)","typeDefault":"str"},{"type":"str","value":"Garry","typeDefault":"str"}]},{"name":"wait","func":"wait","params":[{"type":"str","value":"1","typeDefault":"str"}]},{"name":"select","func":"select","params":[{"type":"str","value":"#formElem > input[type=text]:nth-child(2)","typeDefault":"str"},{"type":"str","value":"","typeDefault":"str"}]},{"name":"insert","func":"insert","params":[{"type":"str","value":"#formElem > input[type=text]:nth-child(2)","typeDefault":"str"},{"type":"str","value":"Potter","typeDefault":"str"}]},{"name":"click","func":"click","params":[{"type":"str","value":"#formElem > input[type=submit]:nth-child(3)","typeDefault":"str"}]},{"name":"wait","func":"wait","params":[{"type":"str","value":"5","typeDefault":"str"}]}],"prop":"nbrowser","propout":"payload","object":"msg","objectout":"msg","close":true,"show":true,"ssl":false,"outputs":0,"x":700,"y":700,"wires":[]},{"id":"5d55f12c.6e17","type":"inject","z":"a8befc30.c457","name":"","topic":"","payload":"http://localhost:1880/form","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":470,"y":700,"wires":[["b7d004b3.0a12d8"]]},{"id":"14e1bb47.7bcee5","type":"split","z":"a8befc30.c457","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":702.3645515441895,"y":540.6041603088379,"wires":[["36d28905.ec7e36"]]},{"id":"36d28905.ec7e36","type":"switch","z":"a8befc30.c457","name":"","property":"payload","propertyType":"msg","rules":[{"t":"index","v":"3","vt":"num","v2":"3","v2t":"num"},{"t":"index","v":"7","vt":"num","v2":"7","v2t":"num"}],"checkall":"true","repair":false,"outputs":2,"x":462.36455154418945,"y":620.6041603088379,"wires":[["faccdf7c.fb6f2"],["faccdf7c.fb6f2"]]},{"id":"ebd2e167.9e7c","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":922.3645515441895,"y":620.6041603088379,"wires":[]},{"id":"faccdf7c.fb6f2","type":"function","z":"a8befc30.c457","name":"Buffer","func":"msg.payload = Buffer.from(msg.payload);\nmsg.payload = msg.payload.toString().trim();\nreturn msg;\n","outputs":1,"noerr":0,"x":702.3645515441895,"y":620.6041603088379,"wires":[["ebd2e167.9e7c"]]},{"id":"ad3f74cc.9729b8","type":"color-convert","z":"a8befc30.c457","input":"hsv","output":"rgb","outputType":"object","scaleInput":false,"x":610,"y":840,"wires":[["e389f6db.d41ab8","e50e7777.49e4e8"]]},{"id":"236d176e.ef5c78","type":"inject","z":"a8befc30.c457","name":"","topic":"","payload":"{\"h\":6,\"s\":80,\"v\":100}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":370,"y":960,"wires":[["7944dc5d.1922c4","817b7d94.32efa"]]},{"id":"e389f6db.d41ab8","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":990,"y":840,"wires":[]},{"id":"7944dc5d.1922c4","type":"function","z":"a8befc30.c457","name":"new array from data","func":"var msg1 = {payload: Object.entries(msg.payload).map(([,item]) => item)};\nreturn msg1;","outputs":1,"noerr":0,"x":400,"y":840,"wires":[["ad3f74cc.9729b8"]]},{"id":"e50e7777.49e4e8","type":"function","z":"a8befc30.c457","name":"split RGB","func":"let red = { payload: msg.payload.red };\nlet green = { payload: msg.payload.green };\nlet blue = { payload: msg.payload.blue };\nreturn [red, green, blue];","outputs":3,"noerr":0,"x":620,"y":960,"wires":[["2114d77e.7cea28"],["7d8e27a5.cad1f8"],["ce6b6632.8140f8"]]},{"id":"7566731a.24aa2c","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":900,"wires":[]},{"id":"6b8c53d7.f0545c","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":960,"wires":[]},{"id":"d020f59d.c59378","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":1020,"wires":[]},{"id":"ce6b6632.8140f8","type":"function","z":"a8befc30.c457","name":"BLUE","func":"msg.payload = Math.round(msg.payload/2.55);\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":1020,"wires":[["d020f59d.c59378"]]},{"id":"2114d77e.7cea28","type":"function","z":"a8befc30.c457","name":"RED","func":"msg.payload = Math.round(msg.payload/2.55);\nreturn msg;","outputs":1,"noerr":0,"x":790,"y":900,"wires":[["7566731a.24aa2c"]]},{"id":"7d8e27a5.cad1f8","type":"function","z":"a8befc30.c457","name":"GREEN","func":"msg.payload = Math.round(msg.payload/2.55);\nreturn msg;","outputs":1,"noerr":0,"x":800,"y":960,"wires":[["6b8c53d7.f0545c"]]},{"id":"817b7d94.32efa","type":"function","z":"a8befc30.c457","name":"","func":"msg.payload = Array.from({x:1,y:2,z:3})\nreturn msg;","outputs":1,"noerr":0,"x":620,"y":1100,"wires":[["6f1979ee.ffc6c8"]]},{"id":"6f1979ee.ffc6c8","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1000,"y":1120,"wires":[]},{"id":"504bcd0f.461304","type":"batch","z":"a8befc30.c457","name":"","mode":"concat","count":10,"overlap":0,"interval":10,"allowEmptySequence":false,"topics":[{"topic":"1"},{"topic":"2"}],"x":610,"y":1300,"wires":[["d567d99.1d7ea28"]]},{"id":"4985f42a.a7da1c","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":1240,"wires":[]},{"id":"944ebba5.04e198","type":"split","z":"a8befc30.c457","name":"","splt":"1","spltType":"len","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":490,"y":1240,"wires":[["504bcd0f.461304"]]},{"id":"db7c531.48ac1b","type":"join","z":"a8befc30.c457","name":"","mode":"auto","build":"string","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":"false","timeout":"","count":"","reduceRight":false,"x":850,"y":1300,"wires":[["4985f42a.a7da1c"]]},{"id":"d567d99.1d7ea28","type":"sort","z":"a8befc30.c457","name":"","order":"ascending","as_num":true,"target":"","targetType":"seq","msgKey":"","msgKeyType":"elem","seqKey":"payload","seqKeyType":"msg","x":730,"y":1240,"wires":[["db7c531.48ac1b"]]},{"id":"93586062.7988a","type":"change","z":"a8befc30.c457","name":"6239","rules":[{"t":"set","p":"topic","pt":"msg","to":"2","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"6239","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":1280,"wires":[["944ebba5.04e198"]]},{"id":"b96149b6.b195a8","type":"change","z":"a8befc30.c457","name":"51784","rules":[{"t":"set","p":"topic","pt":"msg","to":"1","tot":"str"},{"t":"set","p":"payload","pt":"msg","to":"51784","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":1200,"wires":[["944ebba5.04e198"]]},{"id":"befb0ddc.31f47","type":"inject","z":"a8befc30.c457","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1240,"wires":[["b96149b6.b195a8","93586062.7988a"]]},{"id":"15f3ec80.6983f4","type":"exec","z":"a8befc30.c457","command":"\"C:/Program Files/MKVToolNix\\mkvmerge.exe\"","addpay":true,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"mkvtoolnix","x":810,"y":1680,"wires":[["9a4e3334.c9a64"],[],[]]},{"id":"104a8927.1b2f27","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":470,"y":1540,"wires":[]},{"id":"9d99293.a3741d8","type":"template","z":"a8befc30.c457","name":"","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"--ui-language ru --output ^\"C:\\\\home\\\\{{payload}}^\" --no-audio --language 0:und ^\"^(^\" ^\"C:\\\\home\\\\00_Трейлер^(1^).mp4^\" ^\"^)^\"","output":"str","x":700,"y":2020,"wires":[["744e9b19.362dd4"]]},{"id":"62f4a37d.cff73c","type":"watch","z":"a8befc30.c457","name":"","files":"C:\\\\home","recursive":"","x":100,"y":1500,"wires":[["937c57c4.918928"]]},{"id":"70dc72fc.a2220c","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":470,"y":1600,"wires":[]},{"id":"937c57c4.918928","type":"function","z":"a8befc30.c457","name":"select name","func":"const reg = /([^\\\\]+$)/;\nvar msg1, msg2;\nif (flow.get(\"nameFile\") === msg.payload) {\n    msg1 = { payload: \"load\"};\n    msg2 = { payload: msg.payload.match(reg)[0]};\n} \nelse flow.set(\"nameFile\", msg.payload)\nreturn [msg, msg1, msg2];","outputs":3,"noerr":0,"x":230,"y":1600,"wires":[["104a8927.1b2f27"],["70dc72fc.a2220c"],["68e75151.9e906","38294a8f.c00e06","282c27ea.0bca38"]]},{"id":"68e75151.9e906","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":470,"y":1660,"wires":[]},{"id":"744e9b19.362dd4","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":930,"y":2020,"wires":[]},{"id":"9a4e3334.c9a64","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1040,"y":1700,"wires":[]},{"id":"151b9371.6d09dd","type":"split","z":0,"name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":230,"y":180,"wires":[["35b2653e.efdfba"]]},{"id":"39d59c22.c1d154","type":"inject","z":0,"name":"","topic":"","payload":"{\"script\":\"espdata\",\"idesp\":\"ESP826600d30a89\",\"hostname\":\"Power\",\"dhtt1\":\"27.7\",\"dhth1\":\"66.5\",\"pmv\":\"206.6\",\"pmc\":\"1.14\",\"pmw\":\"219\",\"pmwh\":\"3025526\",\"uptime\":\"53700\",\"errconn\":\"2\",\"wanip\":\"192.168.1.204\",\"freemem\":\"34768\",\"ver\":\"0.1.1_23:59:46_26.05.2018\",\"vdd\":\"3330\",\"rssi\":\"-55\",\"gpio4\":\"1\",\"gpio12\":\"1\",\"gpio13\":\"0\",\"gpioint1\":\"0\",\"gpioint2\":\"0\",\"gpioint3\":\"0\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":100,"wires":[["151b9371.6d09dd"]]},{"id":"9375657f.e38318","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":910,"y":180,"wires":[]},{"id":"35b2653e.efdfba","type":"change","z":0,"name":"Ставим топик на место","rules":[{"t":"set","p":"topic","pt":"msg","to":"parts.key","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":430,"y":180,"wires":[["3988213f.655bfe"]]},{"id":"3988213f.655bfe","type":"change","z":0,"name":"Добавляем мыло и имя","rules":[{"t":"set","p":"topic","pt":"msg","to":"'мыло/имя/что-угодно/' & topic","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":690,"y":180,"wires":[["9375657f.e38318"]]},{"id":"f0458d46.3bfeb","type":"split","z":0,"name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"topic","x":410,"y":320,"wires":[["a0e70be8.e0dc88"]]},{"id":"a4e24d19.2e243","type":"inject","z":0,"name":"","topic":"","payload":"{\"script\":\"espdata\",\"idesp\":\"ESP826600d30a89\",\"hostname\":\"Power\",\"dhtt1\":\"27.7\",\"dhth1\":\"66.5\",\"pmv\":\"206.6\",\"pmc\":\"1.14\",\"pmw\":\"219\",\"pmwh\":\"3025526\",\"uptime\":\"53700\",\"errconn\":\"2\",\"wanip\":\"192.168.1.204\",\"freemem\":\"34768\",\"ver\":\"0.1.1_23:59:46_26.05.2018\",\"vdd\":\"3330\",\"rssi\":\"-55\",\"gpio4\":\"1\",\"gpio12\":\"1\",\"gpio13\":\"0\",\"gpioint1\":\"0\",\"gpioint2\":\"0\",\"gpioint3\":\"0\"}","payloadType":"json","repeat":"","crontab":"","once":false,"x":279,"y":319.99999713897705,"wires":[["f0458d46.3bfeb"]]},{"id":"a0e70be8.e0dc88","type":"change","z":0,"name":"Добавляем мыло и имя","rules":[{"t":"set","p":"topic","pt":"msg","to":"'мыло/имя/что-угодно/' & topic","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":599.9999923706055,"y":320.9998960494995,"wires":[["cb4a319e.d3a05"]]},{"id":"cb4a319e.d3a05","type":"debug","z":0,"name":"","active":true,"console":false,"complete":"payload","x":823.9999923706055,"y":320.9998960494995,"wires":[]},{"id":"bdf1a946.99b858","type":"inject","z":0,"name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":150,"y":420,"wires":[["6c76a4d2.14cfbc"]]},{"id":"c603f94c.444dc8","type":"change","z":0,"name":"!payload","rules":[{"t":"set","p":"payload","pt":"msg","to":"$not(payload)\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":420,"wires":[["e662a403.7ad878"]]},{"id":"2c840e01.772242","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":420,"wires":[]},{"id":"e662a403.7ad878","type":"change","z":0,"name":"","rules":[{"t":"set","p":"trigger","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":760,"y":420,"wires":[["2c840e01.772242"]]},{"id":"6c76a4d2.14cfbc","type":"change","z":0,"name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"trigger","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":320,"y":420,"wires":[["c603f94c.444dc8"]]},{"id":"8cbbfbcc.151b68","type":"inject","z":0,"name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"x":270,"y":500,"wires":[["4cd2d491.aba4bc"]]},{"id":"4cd2d491.aba4bc","type":"change","z":0,"name":"trigger","rules":[{"t":"set","p":"trigger","pt":"flow","to":"$not($flowContext(\"trigger\"))\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":500,"wires":[["772abef5.df75a"]]},{"id":"93c6daa7.cb64d8","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":950,"y":500,"wires":[]},{"id":"772abef5.df75a","type":"change","z":0,"name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"trigger","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":500,"wires":[["93c6daa7.cb64d8"]]},{"id":"a852332d.cc854","type":"change","z":"a8befc30.c457","name":"","rules":[{"t":"set","p":"names","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":1840,"wires":[["6dfa48ab.db57d8"]]},{"id":"87bbdbad.81d288","type":"inject","z":"a8befc30.c457","name":"","topic":"","payload":"[\"Первый\",\"Второй\"]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":1680,"wires":[["a852332d.cc854"]]},{"id":"abdc7979.e1e558","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":690,"y":1920,"wires":[]},{"id":"a8511e42.cb6f","type":"switch","z":"a8befc30.c457","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"name","vt":"flow"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":490,"y":1940,"wires":[["abdc7979.e1e558"],["4ead8fed.80cf","9d99293.a3741d8"]]},{"id":"6dfa48ab.db57d8","type":"split","z":"a8befc30.c457","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":430,"y":1840,"wires":[["a8511e42.cb6f"]]},{"id":"4ead8fed.80cf","type":"debug","z":"a8befc30.c457","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":690,"y":1960,"wires":[]},{"id":"38294a8f.c00e06","type":"change","z":"a8befc30.c457","name":"","rules":[{"t":"set","p":"name","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":460,"y":1760,"wires":[[]]},{"id":"282c27ea.0bca38","type":"delay","z":"a8befc30.c457","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":240,"y":1760,"wires":[["a852332d.cc854"]]},{"id":"4935f050.8baea","type":"inject","z":"67731296.6f183c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":260,"y":220,"wires":[["159c0c70.36de54"]]},{"id":"4bc746cb.b79ef8","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":220,"wires":[]},{"id":"4438a79c.82c768","type":"complete","z":"67731296.6f183c","name":"","scope":["4bc746cb.b79ef8"],"uncaught":false,"x":340,"y":360,"wires":[["b1e6408.dcdd6c","a8e46313.3c1ef"]]},{"id":"6ce441d6.141d5","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":790,"y":440,"wires":[]},{"id":"159c0c70.36de54","type":"trigger","z":"67731296.6f183c","op1":"1","op2":"0","op1type":"num","op2type":"num","duration":"5","extend":false,"units":"s","reset":"","bytopic":"all","name":"","x":480,"y":180,"wires":[["4bc746cb.b79ef8"]]},{"id":"b1e6408.dcdd6c","type":"function","z":"67731296.6f183c","name":"+10","func":"msg.payload = +msg.payload + 10;\nreturn msg;","outputs":1,"noerr":0,"x":570,"y":400,"wires":[["6ce441d6.141d5"]]},{"id":"a8e46313.3c1ef","type":"rbe","z":"67731296.6f183c","name":"","func":"rbe","gap":"","start":"","inout":"out","property":"payload","x":560,"y":540,"wires":[["fa1bdf0a.ffe17"]]},{"id":"fa1bdf0a.ffe17","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":780,"y":600,"wires":[]},{"id":"23b5f0ac.1c0d4","type":"inject","z":"67731296.6f183c","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":270,"y":520,"wires":[["a8e46313.3c1ef"]]},{"id":"75397d66.0f3934","type":"inject","z":"67731296.6f183c","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":270,"y":580,"wires":[["a8e46313.3c1ef"]]},{"id":"7d86ef2a.d33d","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":910,"y":700,"wires":[]},{"id":"a7fcfc79.cd53","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":700,"wires":[["f12d1bad.eff588","a787a59b.fa9118","5960bda6.e03424"]]},{"id":"5dc3de04.5e2ec","type":"inject","z":"67731296.6f183c","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":700,"wires":[["a7fcfc79.cd53","25e9ac4e.4f16e4"]]},{"id":"25e9ac4e.4f16e4","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":350,"y":840,"wires":[]},{"id":"f12d1bad.eff588","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":700,"wires":[["7d86ef2a.d33d"]]},{"id":"a787a59b.fa9118","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":650,"y":840,"wires":[]},{"id":"c0cd5178.d7cf8","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":910,"y":780,"wires":[]},{"id":"5960bda6.e03424","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":780,"wires":[["c0cd5178.d7cf8"]]},{"id":"2581601f.a8f0c","type":"change","z":"67731296.6f183c","name":"","rules":[{"t":"set","p":"payload","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":400,"y":1120,"wires":[["1e511f62.22bfc1","6d7d48ac.9ed428","76d76af7.49ad44"]]},{"id":"24e6188f.98a178","type":"inject","z":"67731296.6f183c","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":1120,"wires":[["2581601f.a8f0c","10634731.927759"]]},{"id":"10634731.927759","type":"debug","z":"67731296.6f183c","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":380,"y":1220,"wires":[]},{"id":"1e511f62.22bfc1","type":"debug","z":"67731296.6f183c","name":"2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":590,"y":1220,"wires":[]},{"id":"d1a02082.62156","type":"debug","z":"67731296.6f183c","name":"4","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":950,"y":1080,"wires":[]},{"id":"f7de701f.2b351","type":"debug","z":"67731296.6f183c","name":"3","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":950,"y":1160,"wires":[]},{"id":"6d7d48ac.9ed428","type":"change","z":"67731296.6f183c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":1160,"wires":[["f7de701f.2b351"]]},{"id":"76d76af7.49ad44","type":"change","z":"67731296.6f183c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":600,"y":1080,"wires":[["e6cb982d.d48e08","daff6899.15c088"]]},{"id":"41954133.74a5","type":"change","z":"67731296.6f183c","name":"set 30","rules":[{"t":"set","p":"payload","pt":"flow","to":"30","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":1400,"wires":[["55be892d.a31aa8","f95115.4d42fee8"]]},{"id":"3af47a74.23e896","type":"inject","z":"67731296.6f183c","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":1400,"wires":[["74184a00.963e84","41954133.74a5"]]},{"id":"74184a00.963e84","type":"debug","z":"67731296.6f183c","name":"1","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":270,"y":1500,"wires":[]},{"id":"1ef4ad6a.c470e3","type":"debug","z":"67731296.6f183c","name":"3","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":910,"y":1440,"wires":[]},{"id":"b873b147.0f2d3","type":"debug","z":"67731296.6f183c","name":"2","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":910,"y":1360,"wires":[]},{"id":"e6cb982d.d48e08","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload + 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":790,"y":1080,"wires":[["d1a02082.62156"]]},{"id":"a77cdc89.eef69","type":"change","z":"67731296.6f183c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":1360,"wires":[["b873b147.0f2d3"]]},{"id":"5740ea68.9bd194","type":"change","z":"67731296.6f183c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":1440,"wires":[["1ef4ad6a.c470e3"]]},{"id":"daff6899.15c088","type":"debug","z":"67731296.6f183c","name":"Last","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":690,"y":980,"wires":[]},{"id":"93012d16.98b7d","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"msg","to":"$flowContext(\"payload\")\t+ 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":630,"y":1640,"wires":[["89e690a9.ef5e3"]]},{"id":"d84f81c.5a8ea8","type":"inject","z":"67731296.6f183c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":440,"y":1640,"wires":[["93012d16.98b7d"]]},{"id":"9d52ca6f.5f4968","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":950,"y":1640,"wires":[]},{"id":"89e690a9.ef5e3","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"flow","to":"$flowContext(\"payload\")\t+ 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":770,"y":1640,"wires":[["9d52ca6f.5f4968"]]},{"id":"f95115.4d42fee8","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"flow","to":"$flowContext(\"payload\")\t+ 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":550,"y":1440,"wires":[["5740ea68.9bd194"]]},{"id":"55be892d.a31aa8","type":"change","z":"67731296.6f183c","name":"+1","rules":[{"t":"set","p":"payload","pt":"flow","to":"$flowContext(\"payload\")\t+ 1","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":550,"y":1360,"wires":[["a77cdc89.eef69"]]},{"id":"765028f0.6e3498","type":"http in","z":"6378da21.c9a314","name":"","url":"/translate","method":"get","upload":false,"swaggerDoc":"","x":130,"y":140,"wires":[["14fb0646.ebb6ca"]]},{"id":"f9e5d8d4.47e958","type":"http response","z":"6378da21.c9a314","name":"","statusCode":"","headers":{"Access-Control-Allow-Origin":"*"},"x":610,"y":140,"wires":[]},{"id":"f02b5eff.4da6e","type":"inject","z":"6378da21.c9a314","name":"","topic":"","payload":"{\"text\":\"[1+2]\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":210,"y":240,"wires":[["14fb0646.ebb6ca"]]},{"id":"c7d01b9c.7562b8","type":"debug","z":"6378da21.c9a314","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":530,"y":240,"wires":[]},{"id":"14fb0646.ebb6ca","type":"Blockly","z":"6378da21.c9a314","language":"en","func":"var message;\n\n\nmessage = (msg['payload']['text']);\n// Remove [ and/or ]\nif (message.charAt(0) == '[') {\n  message = message.slice(1, message.length);\n}\nif (message.slice(-1) == ']') {\n  message = message.slice(0, message.length - 1);\n}\n// Use eval to process the message\nmessage = String(eval(message));\n// Re-package result to pass back to Scratch 3\nmessage = ['{\"result\":\"',message,'\"}'].join('');\nmsg['payload'] = message;\nreturn msg;\n","workspaceXml":"<xml xmlns=\"http://www.w3.org/1999/xhtml\"><variables><variable type=\"\" id=\"tRt)J6ju,#c{x[U1pP.I\">message</variable></variables><block type=\"variables_set\" id=\"1#8[z=8c+=_~=Q0ULr#K\" x=\"-462\" y=\"-212\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field><value name=\"VALUE\"><block type=\"node_object_get\" id=\"}Lha(ev5jipd*2wwf|9t\"><mutation action=\"GET\"></mutation><field name=\"action\">GET</field><value name=\"object\"><shadow type=\"node_msg\" id=\"?5)PeuSYW/w|6npl8soI\"></shadow></value><value name=\"field_name\"><shadow type=\"text\" id=\"+?KfAUp_a6($,t/G+LYe\"><field name=\"TEXT\">payload.text</field></shadow></value></block></value><next><block type=\"misc_comment\" id=\"WIRVzXH+hmlI*+.9d@KW\"><value name=\"TEXT\"><shadow type=\"text\" id=\"G-BR-,XLXr{67lem9w#q\"><field name=\"TEXT\">Remove [ and/or ]</field></shadow></value><next><block type=\"controls_if\" id=\"KUOuZO+imQGNU3(xJB[!\"><value name=\"IF0\"><block type=\"logic_compare\" id=\"@$Ud+/EKOZn9QqlZ%5Ak\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"text_charAt\" id=\"EiPm~/*k27j{Sc|M{^FJ\"><mutation at=\"false\"></mutation><field name=\"WHERE\">FIRST</field><value name=\"VALUE\"><block type=\"variables_get\" id=\".uh:5ru_m0//-%tNx!,O\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field></block></value></block></value><value name=\"B\"><block type=\"text\" id=\"qq]Q`wDc5-~cIFGEKL-c\"><field name=\"TEXT\">[</field></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\" id=\"CQVibNOb9ME$!PIRvzb;\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field><value name=\"VALUE\"><block type=\"text_getSubstring\" id=\"x}/1BSlZSQNp~79,NQXJ\"><mutation at1=\"true\" at2=\"false\"></mutation><field name=\"WHERE1\">FROM_START</field><field name=\"WHERE2\">LAST</field><value name=\"STRING\"><block type=\"variables_get\" id=\"@S?i8O{S=;P7b$4J::sp\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field></block></value><value name=\"AT1\"><block type=\"math_number\" id=\"@)t-J;cEnYs_-$9CLP!c\"><field name=\"NUM\">2</field></block></value></block></value></block></statement><next><block type=\"controls_if\" id=\"|!@53E@~Z~5Prk)S^$JJ\"><value name=\"IF0\"><block type=\"logic_compare\" id=\"*t/tA0Mfw?ddyac*0Fv5\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"text_charAt\" id=\"KQ?:{LT2aPn-rbd?uS-h\"><mutation at=\"false\"></mutation><field name=\"WHERE\">LAST</field><value name=\"VALUE\"><block type=\"variables_get\" id=\"Chy1ta2u|LVv`Amvc{@l\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field></block></value></block></value><value name=\"B\"><block type=\"text\" id=\"0kMv[heEgcW}`Z.5j+lr\"><field name=\"TEXT\">]</field></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\" id=\"?fhsb}acBq%{Zf1rQtfp\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field><value name=\"VALUE\"><block type=\"text_getSubstring\" id=\"^z%Dflr1)K1=HJF7**3X\"><mutation at1=\"false\" at2=\"true\"></mutation><field name=\"WHERE1\">FIRST</field><field name=\"WHERE2\">FROM_END</field><value name=\"STRING\"><block type=\"variables_get\" id=\"g,wc2-M{/!4ZCUM.~C`|\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field></block></value><value name=\"AT2\"><block type=\"math_number\" id=\"Y/bQQ.a*EM!h@~m~DKtD\"><field name=\"NUM\">2</field></block></value></block></value></block></statement><next><block type=\"misc_comment\" id=\"pL$%3)!S*F*h/uyFFWfL\"><value name=\"TEXT\"><shadow type=\"text\" id=\"KbV6=2]L9vIQ$,?|K(OU\"><field name=\"TEXT\">Use eval to process the message</field></shadow></value><next><block type=\"misc_javascript\" id=\"[:eX51yxUnbyhl7-cz$m\"><value name=\"STATEMENT\"><shadow type=\"text\" id=\"1t?Vp%SuQ@bN2~$M3J]L\"><field name=\"TEXT\">message = String(eval(message))</field></shadow></value><next><block type=\"misc_comment\" id=\"(]5Y3@2N/E%w#4UqgDI}\"><value name=\"TEXT\"><shadow type=\"text\" id=\"c|R*SbW396,l}$_7g9,~\"><field name=\"TEXT\">Re-package result to pass back to Scratch 3</field></shadow></value><next><block type=\"variables_set\" id=\"nRdt[H56mc#x$jb_m6tH\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field><value name=\"VALUE\"><block type=\"text_join\" id=\"{5aa^yGeaA}e#+mHhiEw\" inline=\"true\"><mutation items=\"3\"></mutation><value name=\"ADD0\"><block type=\"text\" id=\"g9y^B`=d6]Fq^D+n.{ts\"><field name=\"TEXT\">{\"result\":\"</field></block></value><value name=\"ADD1\"><block type=\"variables_get\" id=\"@7lQ*N}w.49T,9~Zbu*5\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field></block></value><value name=\"ADD2\"><block type=\"text\" id=\";XB3H60nOwE:#%=pC%@M\"><field name=\"TEXT\">\"}</field></block></value></block></value><next><block type=\"node_object_set\" id=\"TtY/%g}HQ.thV[!)[)+?\" inline=\"true\"><value name=\"object_field\"><shadow type=\"node_msg\" id=\"M).kpUd-=P`$-@}AiR47\"></shadow></value><value name=\"field_name\"><shadow type=\"text\" id=\"$8B#TMu?Jk,_S~VWy{2L\"><field name=\"TEXT\">payload</field></shadow></value><value name=\"value_field\"><shadow type=\"text\" id=\"l%C_@co}{eglIH!)%.D[\"><field name=\"TEXT\"></field></shadow><block type=\"variables_get\" id=\"`(1IxXS^hiy;uAiLtNRT\"><field name=\"VAR\" id=\"tRt)J6ju,#c{x[U1pP.I\" variabletype=\"\">message</field></block></value><next><block type=\"node_return_message\" id=\"*bbcmWYcM1SuE^[3$)+_\"><field name=\"OUTPUT_NR\">1</field><value name=\"MESSAGE_INPUT\"><shadow type=\"node_msg\" id=\"SYNR|[0}wO3nN5A(,1yq\"></shadow></value></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></xml>","outputs":1,"name":"","x":360,"y":140,"wires":[["f9e5d8d4.47e958","c7d01b9c.7562b8"]]},{"id":"4cc9cfde.567c7","type":"delay","z":"67731296.6f183c","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":true,"x":540,"y":1880,"wires":[["d49c091.e10c8f8"]]},{"id":"58a853d1.02aabc","type":"inject","z":"67731296.6f183c","name":"","topic":"msg.delay","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":1760,"wires":[["39ca8b3c.3b5774"]]},{"id":"d49c091.e10c8f8","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":720,"y":1880,"wires":[]},{"id":"2a6eebf6.2415d4","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":720,"y":1820,"wires":[]},{"id":"39ca8b3c.3b5774","type":"change","z":"67731296.6f183c","name":"","rules":[{"t":"set","p":"delay","pt":"msg","to":"payload * 1000","tot":"jsonata"},{"t":"set","p":"topic","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":1820,"wires":[["4cc9cfde.567c7","2a6eebf6.2415d4"]]},{"id":"d685cb0f.e01058","type":"inject","z":"67731296.6f183c","name":"","topic":"msg.delay","payload":"4","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":1820,"wires":[["39ca8b3c.3b5774"]]},{"id":"8de749d2.be3948","type":"inject","z":"67731296.6f183c","name":"JSON","topic":"","payload":"{\"system\":{\"hostname\":\"ssensor\",\"uptime\":5208,\"rssi\":-54,\"freemem\":30208},\"sensors\":{},\"gpio\":{\"4\":1}}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":2040,"wires":[["ef3c94a0.b30db8","8a36114d.638ed"]]},{"id":"ef3c94a0.b30db8","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":390,"y":2040,"wires":[]},{"id":"926f4bbe.105408","type":"debug","z":"67731296.6f183c","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":390,"y":2140,"wires":[]},{"id":"8a36114d.638ed","type":"change","z":"67731296.6f183c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.gpio[\"4\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":180,"y":2140,"wires":[["926f4bbe.105408"]]},{"id":"2b0323e1.8ed6dc","type":"http in","z":"6378da21.c9a314","name":"","url":"/html","method":"get","upload":false,"swaggerDoc":"","x":100,"y":460,"wires":[["aa61d780.628268"]]},{"id":"4164b363.e25ddc","type":"http in","z":"6378da21.c9a314","name":"","url":"/mysit","method":"post","upload":false,"swaggerDoc":"","x":270,"y":540,"wires":[["e514aa1c.3e61f8","1f7df934.df3d47"]]},{"id":"aa61d780.628268","type":"function","z":"6378da21.c9a314","name":"msg.url = \"mysitepost\";","func":"msg.url = \"mysit\";\nreturn msg;","outputs":1,"noerr":0,"x":300,"y":460,"wires":[["f82a83a6.53ba"]]},{"id":"e514aa1c.3e61f8","type":"debug","z":"6378da21.c9a314","name":"mysitepost","active":false,"console":"false","complete":"payload","x":920,"y":540,"wires":[]},{"id":"a22281db.0d95","type":"http response","z":"6378da21.c9a314","name":"","x":940,"y":500,"wires":[]},{"id":"892de59c.aeade8","type":"template","z":"6378da21.c9a314","name":"CSS","field":"payload.style","fieldType":"msg","format":"css","syntax":"mustache","template":"input[type=text], select {\n    width: 100%;\n    padding: 12px 20px;\n    margin: 8px 0;\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 4px;\n    box-sizing: border-box;\n}\n\ninput[type=submit] {\n    width: 100%;\n    background-color: #4CAF50;\n    color: white;\n    padding: 14px 20px;\n    margin: 8px 0;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\n\ninput[type=submit]:hover {\n    background-color: #45a049;\n}\n\ndiv {\n    border-radius: 5px;\n    background-color: #f2f2f2;\n    padding: 20px;\n}","x":660,"y":460,"wires":[["97db5c95.05a75"]]},{"id":"f82a83a6.53ba","type":"template","z":"6378da21.c9a314","name":"JavaScript","field":"payload.script","fieldType":"msg","format":"javascript","syntax":"plain","template":"$(document).ready(function(e) {\n    $(\"form[ajax=true]\").submit(function(e) {\n       e.preventDefault();\n        var form_data = $(this).serialize();\n        var form_url = $(this).attr(\"action\");\n        var form_method = $(this).attr(\"method\").toUpperCase();\n        $(\"#loadingimg\").show();\n        $.ajax({\n            url: form_url, \n            type: form_method,      \n            data: form_data,     \n            cache: false,\n            success: function(returnhtml){                          \n                $(\"#result\").html(returnhtml); \n                $(\"#loadingimg\").hide();                    \n            }           \n        });\n    });\n});","x":500,"y":460,"wires":[["892de59c.aeade8"]]},{"id":"25bf70aa.4a9ce","type":"http response","z":"6378da21.c9a314","name":"","x":940,"y":460,"wires":[]},{"id":"97db5c95.05a75","type":"template","z":"6378da21.c9a314","name":"HTML","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<html>\n  <head>\n    <title>Node-red</title>\n    <meta name=\"viewport\" content=\"initial-scale=1.0, user-scalable=no\">\n    <meta charset=\"utf-8\">\n    <script src=\"http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js\"></script>\n    <style>{{{payload.style}}}</style>\n  </head>\n  \n\n    <h2>Пример написания Сайта на Node-RED</h2>\n    <h4><a href=\"http://nodered.flymon.net:1880/#\">nodered.flymon.net</a></h4>\n\n<div>\n<form method=\"post\" action=\"/{{url}}\" ajax=\"true\">\n    <label for=\"fname\">Логин</label>\n    <input type=\"text\" id=\"fname\" name=\"firstname\"><label for=\"lname\">Пароль</label>\n    <input type=\"text\" id=\"lname\" name=\"lastname\"> <label for=\"country\">Страна</label>\n    \n    <select id=\"country\" name=\"country\">\n      <option value=\"rus\">Россия</option>  \n      <option value=\"uk\">Украина</option>\n    </select>\n    \n    <input type=\"submit\" value=\"Submit\">\n  </form>\n</div>\n<div>\n    <span id=\"result\"></span>\n</div>\n\n</body>\n</html>\n<script>{{{payload.script}}}</script>","x":800,"y":460,"wires":[["25bf70aa.4a9ce"]]},{"id":"1159bb47.6a4315","type":"function","z":"6378da21.c9a314","name":"return msg.payload to client","func":"msg.payload = 'А это ответ:'+msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":700,"y":500,"wires":[["a22281db.0d95"]]},{"id":"1f7df934.df3d47","type":"json","z":"6378da21.c9a314","name":"","property":"payload","action":"","pretty":false,"x":480,"y":500,"wires":[["1159bb47.6a4315"]]},{"id":"efec44d7.9c7708","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"state\":\"ON\",\"power\":0,\"voltage\":null,\"consumption\":57.1,\"temperature\":45,\"linkquality\":70}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":230,"y":1960,"wires":[["7db682f.ae91b7c","63c658b6.90bc48","a3f664b5.d2dd38"]]},{"id":"63c658b6.90bc48","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":790,"y":1960,"wires":[]},{"id":"7db682f.ae91b7c","type":"function","z":"1635ef5e.c89941","name":"rest","func":"const {temperature, ...rest} = msg.payload;\nmsg.payload = rest;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":2000,"wires":[["63c658b6.90bc48"]]},{"id":"ecc11d83.47eb6","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"[1,2,3,4,5]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":220,"y":2200,"wires":[["cf46e900.a637a8","a3bd6c5b.04f13"]]},{"id":"a3bd6c5b.04f13","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":590,"y":2200,"wires":[]},{"id":"cf46e900.a637a8","type":"function","z":"1635ef5e.c89941","name":"rest","func":"const [test, ...rest] = msg.payload;\nmsg.payload = rest;\nreturn msg;","outputs":1,"noerr":0,"x":390,"y":2240,"wires":[["a3bd6c5b.04f13"]]},{"id":"a3f664b5.d2dd38","type":"change","z":"1635ef5e.c89941","name":"delete temperatute","rules":[{"t":"delete","p":"payload.temperature","pt":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":430,"y":1920,"wires":[["63c658b6.90bc48"]]},{"id":"c3aab23a.06a55","type":"inject","z":"1635ef5e.c89941","name":"make request","topic":"","payload":"Node-Red","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"100","x":130,"y":2360,"wires":[["7baa76dc.479028"]]},{"id":"7baa76dc.479028","type":"http request","z":"1635ef5e.c89941","name":"","method":"GET","ret":"txt","paytoqs":false,"url":"https://www.npmjs.com/package/node-red","tls":"","persist":false,"proxy":"","authType":"","x":330,"y":2360,"wires":[["c4f8d2a0.b34a3"]]},{"id":"c4f8d2a0.b34a3","type":"html","z":"1635ef5e.c89941","name":"select version NR","property":"","outproperty":"","tag":"#top > div.w-100.ph0-l.ph3.ph4-m > span:nth-child(2)","ret":"text","as":"single","x":530,"y":2360,"wires":[["2dd427d7.aaf038"]]},{"id":"8ed6c4ce.8c1a18","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":2360,"wires":[]},{"id":"2dd427d7.aaf038","type":"change","z":"1635ef5e.c89941","name":"select 5 simbols","rules":[{"t":"set","p":"payload","pt":"msg","to":"$substring(payload[0], 0, 5)","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":760,"y":2360,"wires":[["8ed6c4ce.8c1a18"]]},{"id":"e1123cc2.b55d","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"Brightness\":100}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":2480,"wires":[["bd7a637b.a9266"]]},{"id":"78f3c402.1dcecc","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"Brightness\":50}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":2540,"wires":[["bd7a637b.a9266"]]},{"id":"cdf919bf.f5f158","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"On\":false}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":2660,"wires":[["9b7671f.02bd49"]]},{"id":"1382eb9d.b0cb64","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"On\":true}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":2720,"wires":[["9b7671f.02bd49"]]},{"id":"9e43141f.a381c8","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"Brightness\":0}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":2600,"wires":[["bd7a637b.a9266"]]},{"id":"abf2b780.70b5f8","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1050,"y":2600,"wires":[]},{"id":"28c8e8c9.9714b8","type":"change","z":"1635ef5e.c89941","name":"Brightness: 0","rules":[{"t":"set","p":"payload.Brightness","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":850,"y":2660,"wires":[["abf2b780.70b5f8"]]},{"id":"bd7a637b.a9266","type":"change","z":"1635ef5e.c89941","name":"","rules":[{"t":"set","p":"Brightness","pt":"flow","to":"payload.Brightness","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":430,"y":2540,"wires":[["b6ee678d.1f0d08"]]},{"id":"5d61edf1.78d814","type":"change","z":"1635ef5e.c89941","name":"set Brightness","rules":[{"t":"set","p":"payload.Brightness","pt":"msg","to":"Brightness","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":860,"y":2540,"wires":[["abf2b780.70b5f8"]]},{"id":"9b7671f.02bd49","type":"change","z":"1635ef5e.c89941","name":"","rules":[{"t":"set","p":"On","pt":"flow","to":"payload.On","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":2660,"wires":[["b6ee678d.1f0d08"]]},{"id":"b6ee678d.1f0d08","type":"switch","z":"1635ef5e.c89941","name":"On","property":"On","propertyType":"flow","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":650,"y":2600,"wires":[["5d61edf1.78d814"],["28c8e8c9.9714b8"]]},{"id":"29877013.a6c8e","type":"change","z":"1635ef5e.c89941","name":"set On false","rules":[{"t":"set","p":"On","pt":"flow","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":2480,"wires":[[]]},{"id":"76a2b0b2.eb177","type":"switch","z":"1635ef5e.c89941","name":"if Brightness = 0","property":"Brightness","propertyType":"flow","rules":[{"t":"eq","v":"0","vt":"num"}],"checkall":"true","repair":false,"outputs":1,"x":440,"y":2480,"wires":[["29877013.a6c8e"]]},{"id":"47e447d5.ae6cf8","type":"http in","z":"1635ef5e.c89941","name":"","url":"/hell","method":"get","upload":false,"swaggerDoc":"","x":180,"y":2940,"wires":[["c04ac374.b1154"]]},{"id":"be4824c5.b0edf8","type":"template","z":"1635ef5e.c89941","name":"page","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"<html>\n    <head></head>\n    <body>\n        <h1>\n            <ul>\n                {{#payload}}\n                  <li>{{.}}</li>\n                {{/payload}}\n            </ul>\n        </h1>\n    </body>\n</html>","x":570,"y":2940,"wires":[["9a6592c7.f8b4c","aa15bbd4.f8e678"]]},{"id":"9a6592c7.f8b4c","type":"http response","z":"1635ef5e.c89941","name":"","x":770,"y":2940,"wires":[]},{"id":"aa15bbd4.f8e678","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":590,"y":2840,"wires":[]},{"id":"c04ac374.b1154","type":"change","z":"1635ef5e.c89941","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"[\"Nick\", \"Dave\", \"Claire\"]","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":2940,"wires":[["be4824c5.b0edf8"]]},{"id":"3b17392c.98d2c6","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"2","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":3100,"wires":[["c0d23169.31aa4","e1b7b300.cad39"]]},{"id":"950231e5.51c72","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":3100,"wires":[]},{"id":"c0d23169.31aa4","type":"function","z":"1635ef5e.c89941","name":"","func":"msg.payload = +msg.payload;\nreturn msg;","outputs":1,"noerr":0,"x":410,"y":3100,"wires":[["950231e5.51c72"]]},{"id":"e1b7b300.cad39","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":550,"y":3040,"wires":[]},{"id":"b19eb758.dde148","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"50","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":3300,"wires":[["893fc5d0.50f708"]]},{"id":"b1e81cee.e3912","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"9","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":3380,"wires":[["893fc5d0.50f708"]]},{"id":"893fc5d0.50f708","type":"switch","z":"1635ef5e.c89941","name":"<10","property":"payload","propertyType":"msg","rules":[{"t":"lt","v":"10","vt":"num"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":330,"y":3340,"wires":[["c91784f8.29a298"],["8bcc9ae0.51c4d8"]],"outputLabels":["<10",">=10"]},{"id":"c91784f8.29a298","type":"change","z":"1635ef5e.c89941","name":"set Alert true","rules":[{"t":"set","p":"alert","pt":"flow","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":3300,"wires":[["e5d8bb62.114f48"]]},{"id":"8bcc9ae0.51c4d8","type":"change","z":"1635ef5e.c89941","name":"set Alert false","rules":[{"t":"set","p":"alert","pt":"flow","to":"false","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":520,"y":3380,"wires":[["e5d8bb62.114f48"]]},{"id":"f094b848.9bf4f8","type":"rbe","z":"1635ef5e.c89941","name":"","func":"rbe","gap":"10%","start":"","inout":"in","property":"payload","x":930,"y":3320,"wires":[["85990ba3.25ba98"]]},{"id":"c2620f75.be95e","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":930,"y":3500,"wires":[]},{"id":"d3b76772.e8c5f8","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"90","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":3240,"wires":[["893fc5d0.50f708"]]},{"id":"e5d8bb62.114f48","type":"change","z":"1635ef5e.c89941","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"alert","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":740,"y":3320,"wires":[["f094b848.9bf4f8"]]},{"id":"85990ba3.25ba98","type":"switch","z":"1635ef5e.c89941","name":"only is true","property":"payload","propertyType":"msg","rules":[{"t":"true"}],"checkall":"true","repair":false,"outputs":1,"x":950,"y":3400,"wires":[["c2620f75.be95e"]]},{"id":"77d3a533.c2b78c","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":3440,"wires":[["893fc5d0.50f708"]]},{"id":"97f00785.111a68","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":3580,"wires":[["e4d80491.e3d8c8","1acd56b0.817e29"]]},{"id":"e4d80491.e3d8c8","type":"function","z":"1635ef5e.c89941","name":"x1000","func":"msg.delay = msg.payload * 1000;\nreturn msg;","outputs":1,"noerr":0,"x":250,"y":3700,"wires":[["60b34692.68f2d8"]]},{"id":"1acd56b0.817e29","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":530,"y":3600,"wires":[]},{"id":"bdb155dd.db6d18","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"5","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":3620,"wires":[["e4d80491.e3d8c8","1acd56b0.817e29"]]},{"id":"60b34692.68f2d8","type":"delay","z":"1635ef5e.c89941","name":"","pauseType":"delayv","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":400,"y":3700,"wires":[["1acd56b0.817e29"]]},{"id":"25fb3f80.416e7","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":340,"y":3940,"wires":[["27cc7fb7.cc04a"]]},{"id":"27cc7fb7.cc04a","type":"function","z":"1635ef5e.c89941","name":"","func":"let sensor_data = 50.5;\n\nconst msg1 = {};\nconst msg2 = {};\n\nmsg1.payload = sensor_data;\nmsg2.payload = {\"var\": sensor_data};\n\nreturn [msg1, msg2];","outputs":2,"noerr":0,"x":520,"y":3960,"wires":[["493fa496.c88aec"],["85dc47d6.d97ae8"]]},{"id":"493fa496.c88aec","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":3920,"wires":[]},{"id":"85dc47d6.d97ae8","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":4000,"wires":[]},{"id":"9a883320.19c69","type":"function","z":"1635ef5e.c89941","name":"","func":"msg.payload = Math.round(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":4140,"wires":[["9a23db80.451788"]]},{"id":"9a23db80.451788","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":730,"y":4160,"wires":[]},{"id":"93575041.5707b","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"20.49","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":330,"y":4120,"wires":[["9a883320.19c69"]]},{"id":"5db69cf1.c04594","type":"function","z":"1635ef5e.c89941","name":"","func":"msg.payload = {\"name\":msg.payload.firstName, \"lat\":58.590495, \"lon\":49.5865483};\nreturn msg;","outputs":1,"noerr":0,"x":540,"y":4320,"wires":[["27dc368c.9a888a"]]},{"id":"3f8ba909.e77a66","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"test","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":270,"y":4380,"wires":[["d9c3cf41.a6d25"]]},{"id":"27dc368c.9a888a","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":4320,"wires":[]},{"id":"796d4787.0d86b8","type":"function","z":"1635ef5e.c89941","name":"","func":"const temp = {};\n\ntemp.name=msg.payload.firstName;\ntemp.lat=58.590495;\ntemp.lon=49.5865483;\n\nmsg.payload=temp;\n\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":4380,"wires":[["f95e1283.69c91"]]},{"id":"f95e1283.69c91","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":4380,"wires":[]},{"id":"d9c3cf41.a6d25","type":"function","z":"1635ef5e.c89941","name":"","func":"msg.payload = {\n    \"name\": msg.payload,\n    \"lat\":58.590495,\n    \"lon\":49.5865483\n}\n\nreturn msg;","outputs":1,"noerr":0,"x":550,"y":4440,"wires":[["8ca9d822.dce198"]]},{"id":"8ca9d822.dce198","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":4440,"wires":[]},{"id":"2123ce74.eb2742","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"firstName\":\"test\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":310,"y":4320,"wires":[["5db69cf1.c04594","796d4787.0d86b8"]]},{"id":"bfd9fd74.1c40c","type":"function","z":"1635ef5e.c89941","name":"","func":"var operation = msg.payload.action;\n\nif (operation === \"right\"){msg.payload = 1}\nif (operation === \"left\"){msg.payload = 2}\nreturn msg;","outputs":1,"noerr":0,"x":600,"y":4680,"wires":[["a690d66.f6c8d28"]]},{"id":"11745506.65677b","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"action\":\"right\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":360,"y":4640,"wires":[["bfd9fd74.1c40c","163d7b9a.924b44"]]},{"id":"a690d66.f6c8d28","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":820,"y":4720,"wires":[]},{"id":"6e60c8b1.921ed8","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"{\"action\":\"left\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":350,"y":4700,"wires":[["bfd9fd74.1c40c","163d7b9a.924b44"]]},{"id":"163d7b9a.924b44","type":"switch","z":"1635ef5e.c89941","name":"","property":"payload.action","propertyType":"msg","rules":[{"t":"eq","v":"right","vt":"str"},{"t":"eq","v":"left","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":550,"y":4840,"wires":[["2a522b0a.f31924"],["9b5c55f6.177428"]]},{"id":"2a522b0a.f31924","type":"change","z":"1635ef5e.c89941","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"1","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":740,"y":4800,"wires":[["6ef0443c.762f2c"]]},{"id":"9b5c55f6.177428","type":"change","z":"1635ef5e.c89941","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"2","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":740,"y":4840,"wires":[["6ef0443c.762f2c"]]},{"id":"6ef0443c.762f2c","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":940,"y":4820,"wires":[]},{"id":"aa419569.cb6e68","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":140,"wires":[]},{"id":"bee407a5.eaad78","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"","payload":"[\"a\", \"b\", \"c\", \"d\", \"e\"]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":140,"wires":[["60c2a4e9.6db60c","449d9c5.2e74964","1ce10496.fd519b","8b7d45e5.7bc0a8"]]},{"id":"60c2a4e9.6db60c","type":"function","z":"5b0c3533.c576cc","name":"some","func":"msg.topic = \"some\";\nmsg.payload = msg.payload.some(item => item === \"d\")\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":140,"wires":[["aa419569.cb6e68"]]},{"id":"311a3a64.fb0f96","type":"function","z":"5b0c3533.c576cc","name":"reduce","func":"msg.topic = \"reduce\";\nmsg.payload = msg.payload.reduce((total, value) => total * value)\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":420,"wires":[["b85c8b1b.8703f8"]]},{"id":"b85c8b1b.8703f8","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":420,"wires":[]},{"id":"5d017978.fd0338","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"","payload":"[1, 2, 3, 4, 5]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":420,"wires":[["311a3a64.fb0f96","80245d3c.3f9aa","50426638.5fa128","f4c5dce9.111a3","aa8e4952.7c0b08"]]},{"id":"7017f007.0b4e","type":"function","z":"5b0c3533.c576cc","name":"flat","func":"msg.payload = msg.payload.flat();\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":800,"wires":[["804a09f9.51a598"]]},{"id":"449d9c5.2e74964","type":"function","z":"5b0c3533.c576cc","name":"every","func":"msg.topic = \"every\";\nmsg.payload = msg.payload.every(item => item === \"d\")\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":200,"wires":[["94463aa.77d75c8"]]},{"id":"94463aa.77d75c8","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":200,"wires":[]},{"id":"3c223d88.b40d22","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"","payload":"[\"d\", \"d\", \"d\", \"d\", \"d\"]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":200,"wires":[["449d9c5.2e74964","60c2a4e9.6db60c","1ce10496.fd519b","8b7d45e5.7bc0a8"]]},{"id":"80245d3c.3f9aa","type":"function","z":"5b0c3533.c576cc","name":"map","func":"msg.topic = \"map\";\nmsg.payload = msg.payload.map(item => item * item)\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":480,"wires":[["fd092d53.6e3e5"]]},{"id":"fd092d53.6e3e5","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":480,"wires":[]},{"id":"a0f747dd.ddb408","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"","payload":"[[1, 2], [3, 4], 5]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":120,"y":760,"wires":[["804a09f9.51a598","7017f007.0b4e"]]},{"id":"804a09f9.51a598","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":760,"wires":[]},{"id":"a07b6e55.0305","type":"function","z":"5b0c3533.c576cc","name":"flatMap","func":"msg.payload = msg.payload.flatMap(item => item * item)\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":900,"wires":[["d96afb8e.6a5628"]]},{"id":"d96afb8e.6a5628","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":860,"wires":[]},{"id":"f400e7df.5b6d18","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"","payload":"[[1], [2], [3], [4], [5]]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":860,"wires":[["a07b6e55.0305","d96afb8e.6a5628"]]},{"id":"1416b364.b7863d","type":"function","z":"5b0c3533.c576cc","name":"reverse","func":"msg.topic = \"reverse\";\nmsg.payload = msg.payload.reverse();\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":1020,"wires":[["cef74507.069788","374b5251.e0c66e"]]},{"id":"cef74507.069788","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":960,"wires":[]},{"id":"a38a7b30.4e2b28","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"","payload":"[\"a\", \"b\", \"c\", \"d\", \"e\"]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":150,"y":960,"wires":[["1416b364.b7863d","cef74507.069788"]]},{"id":"e176531c.f9396","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"","payload":"[1, 2, 3, 4, 5]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":1020,"wires":[["1416b364.b7863d"]]},{"id":"50426638.5fa128","type":"function","z":"5b0c3533.c576cc","name":"forEach","func":"msg.topic = \"forEach\";\nconst myAwesomeArray = [];\n\nmsg.payload.forEach(item => myAwesomeArray.push(item * item));\nmsg.payload = myAwesomeArray;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":540,"wires":[["90a3e667.c7e368"]]},{"id":"90a3e667.c7e368","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":540,"wires":[]},{"id":"1ce10496.fd519b","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":370,"y":80,"wires":[]},{"id":"8b7d45e5.7bc0a8","type":"function","z":"5b0c3533.c576cc","name":"filter","func":"msg.topic = \"filter\";\nmsg.payload = msg.payload.filter(item => item === \"d\")\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":260,"wires":[["82b8f633.fdfd48"]]},{"id":"82b8f633.fdfd48","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":260,"wires":[]},{"id":"ae1a3cf2.16f29","type":"comment","z":"5b0c3533.c576cc","name":"some","info":"Этот метод проверяет, удовлетворяет ли какой-либо элемент массива условию, заданному в передаваемой функции. Он вернет значение true, если хотя бы один элемент совпадет с проверяемой функцией, и значение false — если нет.","x":750,"y":140,"wires":[]},{"id":"66a94da0.283c24","type":"comment","z":"5b0c3533.c576cc","name":"every","info":"Этот метод проверяет, удовлетворяют ли все элементы массива условию, заданному в передаваемой функции. Он вернет значение true, если каждый элемент совпадет с проверяемой функцией, и значение false — если нет.","x":750,"y":200,"wires":[]},{"id":"6daf5d71.7cf524","type":"comment","z":"5b0c3533.c576cc","name":"filter","info":"Этот метод принимает функцию в качестве параметра и возвращает новый массив, содержащий все элементы массива, для которого функция фильтрации передавалась в качестве аргумента, и возвращает ее со значением true.","x":750,"y":260,"wires":[]},{"id":"21b9f30f.a8a67c","type":"comment","z":"5b0c3533.c576cc","name":"reduce","info":"Этот метод принимает функцию, которая имеет в качестве аргумента аккумулятор и значение. Он применяет функцию к аккумулятору и каждому значению массива, чтобы в результате вернуть только одно значение.","x":750,"y":420,"wires":[]},{"id":"1562dc20.07c4b4","type":"comment","z":"5b0c3533.c576cc","name":"map","info":"Этот метод принимает функцию в качестве параметра и создает новый массив с результатом вызова указанной функции для каждого элемента массива. Он всегда будет возвращать одинаковое количество элементов.","x":750,"y":480,"wires":[]},{"id":"92f1134c.c15b5","type":"comment","z":"5b0c3533.c576cc","name":"forEach","info":"Этот метод применяет функцию к каждому элементу массива. Похоже на цикл. Не создает новый массив.","x":750,"y":540,"wires":[]},{"id":"374b5251.e0c66e","type":"function","z":"5b0c3533.c576cc","name":"sort","func":"msg.topic = \"sort\";\nmsg.payload = msg.payload.sort();\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":1100,"wires":[["3e0bd76.2f9ba28"]]},{"id":"3e0bd76.2f9ba28","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":1100,"wires":[]},{"id":"f4c5dce9.111a3","type":"function","z":"5b0c3533.c576cc","name":"map and filter","func":"msg.topic = \"map and filter\";\n\nfunction doIt(item) {\n    if (item * item > 10) \n        return item * item\n    else \n        return null\n}\n\nmsg.payload = msg.payload.map(item => {\n   return doIt(item);\n}).filter(item => item !== null);\nreturn msg;\n","outputs":1,"noerr":0,"x":380,"y":600,"wires":[["be0cf2f5.bc514"]]},{"id":"be0cf2f5.bc514","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":600,"wires":[]},{"id":"9ef30ceb.6bb96","type":"ui_template","z":"9ab1c0c7.d7f57","group":"ac7da121.c616b","name":"OPEN-CLOSED SIGN","order":2,"width":"0","height":"0","format":"<md-button class=\"vibrate filled touched bigfont rounded\" style=\"background-color:#333333\" ng-click=\"send({payload: msg.payload })\"> \n\n\n<svg  width=\"260px\" height=\"90px\" version=\"1.1\" viewBox=\"0 0 800 200\">\n <g id=\"Button_Long\">\n  \n  <rect fill=\"#333333\" width=\"800\" height=\"200\"/>\n  <g ng-style=\"{fill: (msg.payload.set || 0) ? 'lime' : 'red'}\">\n    <rect width=\"800\" height=\"200\" rx=\"80\" ry=\"80\"/>\n  </g>\n  \n  <rect fill=\"#333333\" x=\"11\" y=\"10\" width=\"778\" height=\"180\" rx=\"90\" ry=\"90\"/>\n  <g ng-style=\"{fill: (msg.payload.set || 0) ? 'lime' : 'red'}\">\n      \n    <text x=\"400\" y=\"125\" style=\"text-anchor:middle\"  font-weight=\"bold\" font-size=\"80\" font-family=\"Arial\">{{msg.payload.set ? msg.payload.on : msg.payload.off}} </text>\n    </g>\n  </g>\n</svg>\n\n\n</md-button>\n","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":false,"templateScope":"local","x":560,"y":200,"wires":[["570514d4.119dcc","64134305.a38afc"]]},{"id":"570514d4.119dcc","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"console":"false","complete":"false","x":790,"y":200,"wires":[]},{"id":"b8b138a0.335248","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":150,"y":120,"wires":[["8ddfa4e6.9391a8"]]},{"id":"8ddfa4e6.9391a8","type":"function","z":"9ab1c0c7.d7f57","name":"set text button","func":"msg.payload = {\n    \"on\": \"Открыто\",\n    \"off\": \"Закрыто\"\n}\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":120,"wires":[["64134305.a38afc"]]},{"id":"64134305.a38afc","type":"function","z":"9ab1c0c7.d7f57","name":"n = !n","func":"flow.set(\"state\", !flow.get(\"state\") || false);\nmsg.payload = {...msg.payload, set: flow.get(\"state\")};\nreturn msg;","outputs":1,"noerr":0,"x":570,"y":120,"wires":[["9ef30ceb.6bb96"]]},{"id":"27efb1c2.654a6e","type":"ui_template","z":"9ab1c0c7.d7f57","d":true,"group":"2b7fbbc4.52b474","name":"","order":1,"width":0,"height":0,"format":"<div ng-bind-html=\"msg.payload\"></div>\n\n<style type=\"text/css\">\n   body { margin: 0; }\n   /*#sidebar, #content { position: absolute; } */\n   #sidebar, #content { overflow: auto; padding: 10px; }\n   #header {\n    height: 80px; /* Высота слоя */\n    background: #FEDFC0; border-bottom: 2px solid #7B5427;\n   }\n   #header h1 { padding: 20px; margin: 0; }\n   #sidebar { \n    width: 150px; background: #ECF5E4; border-right: 1px solid #231F20;\n    top: 82px; /* Расстояние от верхнего края */\n    bottom: 0; /* Расстояние снизу  */\n   }\n   #content {\n    top: 82px; /* Расстояние от верхнего края */\n    left: 170px; /* Расстояние от левого края */\n    bottom: 0; right: 0;\n   }\n </style>\n \n \n  <div id=\"header\"><h1>Плов народов мира</h1></div>\n  <div id=\"sidebar\">\n   <p>Плов по-фергански</p><p>Плов узбекский</p>\n   <p>Плов сибирский</p><p>Плов итальянский</p>\n   <p>Плов эстонский</p><p>Плов по-американски</p>\n   <p>Плов по-индейски</p>\n  </div>\n  <div id=\"content\">\n   <h2>Плов по-фергански</h2>\n   <p>Положить в казан нарезанное кусочками мясо и поджарить его до \n   образования корочки. Нашинкованный кольцами лук жарить вместе \n   с мясом до красноватого цвета, затем добавить морковь, нарезанную \n   соломкой. Положить половину соли, всё перемешать и жарить, пока \n   морковь не приобретёт золотисто-коричневый цвет. После этого налить \n   половину необходимого количества воды и дать закипеть.</p> \n   <p>Засыпать ровным слоем рис, усилить огонь и тотчас налить воду, \n   чтобы она накрыла рис на 1–1,5 см. Как только вода выпарится, плов \n   при помощи шумовки собрать к середине горкой, проколоть палочкой в \n   нескольких местах так, чтобы вода, находящаяся на поверхности, \n   прошла на дно. Затем накрыть плов и дать ему упреть 20–25 мин.</p>\n   <p>Тщательно перемешайте готовый плов, переложите в большое блюдо, \n   сверху разложите мясо.</p>\n  </div>\n\n","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":260,"y":220,"wires":[[]]},{"id":"72a340b7.2b3a4","type":"trigger","z":"9ab1c0c7.d7f57","op1":"1","op2":"0","op1type":"str","op2type":"str","duration":"0","extend":false,"units":"s","reset":"true","bytopic":"all","name":"","x":620,"y":480,"wires":[["15cf97e5.8d9198"]]},{"id":"15cf97e5.8d9198","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":870,"y":480,"wires":[]},{"id":"6ac4f1ff.5f30a","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":360,"y":480,"wires":[["72a340b7.2b3a4"]]},{"id":"148467dd.9f26e8","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"return { \"reset\" : true };","outputs":1,"noerr":0,"x":370,"y":540,"wires":[["72a340b7.2b3a4"]]},{"id":"eb010f93.759c1","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":200,"y":540,"wires":[["148467dd.9f26e8"]]},{"id":"3e5a5387.a72bdc","type":"change","z":"9ab1c0c7.d7f57","name":"Reset trigger","rules":[{"t":"set","p":"reset","pt":"msg","to":"true","tot":"bool"}],"action":"","property":"","from":"","to":"","reg":false,"x":350,"y":660,"wires":[["72a340b7.2b3a4"]]},{"id":"f7f5537c.8e948","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":660,"wires":[["3e5a5387.a72bdc"]]},{"id":"f401aa47.84be08","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"msg.reset = {};\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":600,"wires":[["72a340b7.2b3a4"]]},{"id":"b6331bd4.ef4758","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":200,"y":600,"wires":[["f401aa47.84be08"]]},{"id":"959d086b.dc2858","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":370,"y":720,"wires":[["72a340b7.2b3a4"]]},{"id":"5efef819.a4cac8","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":860,"wires":[["86d5061d.4a7da8"]]},{"id":"86d5061d.4a7da8","type":"function","z":"9ab1c0c7.d7f57","name":"['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб']","func":"var weekday = ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'];\nvar date = new Date();\nvar day = date.getDay();\nvar dayName = weekday[3];\n//msg.payload = weekday[new Date().getDay()];\nmsg.payload = dayName;\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":900,"wires":[["492bf322.b7962c"]]},{"id":"492bf322.b7962c","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":740,"y":920,"wires":[]},{"id":"4484155e.19543c","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":760,"y":1120,"wires":[]},{"id":"83688329.91b83","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"{\"test\":3}","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":240,"y":1100,"wires":[["75bad8e.1c23028","4484155e.19543c"]]},{"id":"75bad8e.1c23028","type":"json","z":"9ab1c0c7.d7f57","name":"","property":"payload","action":"","pretty":false,"x":530,"y":1160,"wires":[["4484155e.19543c"]]},{"id":"77669e9f.82093","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":1020,"wires":[["d835600c.38d7e"]]},{"id":"d835600c.38d7e","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"msg.payload = '{\"state\":\"ON\"}';\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":1020,"wires":[["4484155e.19543c","75bad8e.1c23028"]]},{"id":"414bf68e.e25ef8","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"\"{\"state\":\"ON\", \"test\":5}\"","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":210,"y":1380,"wires":[["694647c6.cdf7a8","a515fe76.1c20d","5307dbb4.400e94"]]},{"id":"7aab1b04.bca574","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"msg.payload = JSON.parse(msg.payload.slice(1, -1));\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":1220,"wires":[[]]},{"id":"8aa3bec5.ac81f","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":710,"y":1440,"wires":[]},{"id":"694647c6.cdf7a8","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":900,"y":1400,"wires":[]},{"id":"85a05b36.903f38","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"msg.payload = String(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":370,"y":1220,"wires":[["7aab1b04.bca574"]]},{"id":"bc0b3ccc.cc1ff","type":"function","z":"9ab1c0c7.d7f57","name":"JSON.parse","func":"function getUsers(userModel) {\n  return typeof userModel === \"string\" ? \n     JSON.parse(userModel)\n     :\n     userModel;\n}\n\nmsg.payload = getUsers(msg.payload);\n\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":1500,"wires":[["330c14c6.92b94c"]]},{"id":"330c14c6.92b94c","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":760,"y":1500,"wires":[]},{"id":"c443dee5.acc48","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"{\"test\":\"JSON\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":1520,"wires":[["bc0b3ccc.cc1ff","8aa3bec5.ac81f","a515fe76.1c20d","5307dbb4.400e94"]]},{"id":"40292b02.fca944","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"{\"test\":\"string\"}","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":1460,"wires":[["8aa3bec5.ac81f","bc0b3ccc.cc1ff","a515fe76.1c20d","5307dbb4.400e94"]]},{"id":"a515fe76.1c20d","type":"json","z":"9ab1c0c7.d7f57","name":"","property":"payload","action":"","pretty":false,"x":550,"y":1340,"wires":[["694647c6.cdf7a8"]]},{"id":"da874535.d9d908","type":"function","z":"9ab1c0c7.d7f57","name":"create obj (toJSON)","func":"msg.payload = { \n    firstName: \"Prateek\", \n    lastName: \"Singh\", \n    возраст: 26, \n    toJSON () { \n        return { \n            fullName: `${this.firstName} ${this.lastName}` \n        };\n    }\n};\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"x":500,"y":1640,"wires":[["f2fdb06a.e0f34","4ded6a18.821ca4","a515fe76.1c20d"]]},{"id":"4b5c2350.f9582c","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":220,"y":1640,"wires":[["da874535.d9d908"]]},{"id":"5307dbb4.400e94","type":"function","z":"9ab1c0c7.d7f57","name":"JSON.stringify","func":"msg.payload =JSON.stringify(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":1800,"wires":[["5e0a67d4.facbe8","c6bf05cb.b49a98"]]},{"id":"883fc083.80d35","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":870,"y":1800,"wires":[]},{"id":"5e0a67d4.facbe8","type":"json","z":"9ab1c0c7.d7f57","name":"","property":"payload","action":"","pretty":false,"x":670,"y":1800,"wires":[["883fc083.80d35"]]},{"id":"2b05da56.f3e5d6","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":240,"y":1820,"wires":[["5307dbb4.400e94"]]},{"id":"29964924.674556","type":"function","z":"9ab1c0c7.d7f57","name":"fabrica","func":"function createFrog(name) {\n  const children = []\n  \n  return {\n    name: name,\n    addChild(frog) {\n      children.push(frog);\n      flow.set(\"frog\", frog);\n    },\n  }\n}\n\nconst mikeTheFrog = createFrog('mike');\n//msg.payload = mikeTheFrog.addChild('test');\n//msg.payload = createFrog('mike');\nmsg.payload = mikeTheFrog;\nreturn msg;","outputs":1,"noerr":0,"x":430,"y":2060,"wires":[["5526d9be.27bfb8","a1c914a4.b0b7f8","30615ea7.2125a2"]]},{"id":"5a89a604.8b8c38","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":280,"y":2060,"wires":[["29964924.674556"]]},{"id":"63b0384b.b69488","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":2140,"wires":[]},{"id":"72214789.bd2848","type":"function","z":"9ab1c0c7.d7f57","name":"prototype","func":"function Frog(name, gender) {\n  this.name = name\n  this.gender = gender\n}\n\nFrog.prototype.leap = function(feet) {\n  flow.set('leap', `Leaping ${feet}ft into the air`);\n}\nmsg.payload = Frog;\nreturn msg;","outputs":1,"noerr":0,"x":340,"y":2160,"wires":[["22ad437e.a55e7c","30615ea7.2125a2","bee92c2a.7015f","543ec26b.e5829c"]]},{"id":"ab79131c.1e727","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":2160,"wires":[["72214789.bd2848"]]},{"id":"a098d0e6.d361b","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"function createSpecies(type, name, gender) {\n  if (type === 'frog') {\n    return createFrog(name, gender)\n  } else if (type === 'human') {\n    return createHuman(name, gender)\n  } else if (type === undefined) {\n    throw new Error('Cannot create a species with an unknown type')\n  }\n}\n\nmsg.payload = createSpecies('frog', 'sally', 'female')\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":2580,"wires":[["a8bd608a.4f47a"]]},{"id":"7bf5a3ee.40ef0c","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":180,"y":2580,"wires":[["a098d0e6.d361b"]]},{"id":"a8bd608a.4f47a","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":610,"y":2580,"wires":[]},{"id":"5526d9be.27bfb8","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.name","targetType":"msg","x":630,"y":2100,"wires":[]},{"id":"a1c914a4.b0b7f8","type":"function","z":"9ab1c0c7.d7f57","name":"function","func":"msg.payload.addChild(\"test\");\nreturn msg;","outputs":1,"noerr":0,"x":600,"y":2140,"wires":[["63b0384b.b69488"]]},{"id":"30615ea7.2125a2","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":610,"y":2060,"wires":[]},{"id":"9586c967.10c308","type":"function","z":"9ab1c0c7.d7f57","name":"leap 2","func":"msg.payload.leap(2);\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":2240,"wires":[[]]},{"id":"8a400258.1e4a8","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.gender","targetType":"msg","x":640,"y":2280,"wires":[]},{"id":"22ad437e.a55e7c","type":"function","z":"9ab1c0c7.d7f57","name":"Petr","func":"msg.payload = new msg.payload(\"Petr\", \"Male\");\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":2240,"wires":[["5526d9be.27bfb8","8a400258.1e4a8","9586c967.10c308"]]},{"id":"543ec26b.e5829c","type":"function","z":"9ab1c0c7.d7f57","name":"Lida","func":"msg.payload = new msg.payload(\"Lida\", \"feMale\");\nreturn msg;","outputs":1,"noerr":0,"x":330,"y":2280,"wires":[["5526d9be.27bfb8","8a400258.1e4a8","612ab1e5.ce7dc"]]},{"id":"6a2dc4ea.c643bc","type":"switch","z":"9ab1c0c7.d7f57","name":"","property":"payload.type","propertyType":"msg","rules":[{"t":"eq","v":"frog","vt":"str"},{"t":"eq","v":"human","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":3,"x":470,"y":2640,"wires":[[],[],[]]},{"id":"bee92c2a.7015f","type":"function","z":"9ab1c0c7.d7f57","name":"foo = 3333","func":"msg.payload.prototype.foo = 3333;\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":2200,"wires":[["596b0afe.ddc384"]]},{"id":"596b0afe.ddc384","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":770,"y":2200,"wires":[]},{"id":"612ab1e5.ce7dc","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.foo","targetType":"msg","x":620,"y":2320,"wires":[]},{"id":"cf6cdc91.6f78b","type":"function","z":"9ab1c0c7.d7f57","name":"class","func":"class Person{\n\n  constructor(name){\n    this.name = name;\n  }\n  \n  logName(){\n    flow.set('class',\"log\" + this.name);\n  }\n}\n\nmsg.payload = Person;\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":2400,"wires":[["9d7c11d4.92e0f","8202d43a.897b68"]]},{"id":"47fce350.5a267c","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":160,"y":2400,"wires":[["cf6cdc91.6f78b"]]},{"id":"9d7c11d4.92e0f","type":"function","z":"9ab1c0c7.d7f57","name":"Ivan","func":"const ivan = new msg.payload('Ivan');\nmsg.payload = ivan;\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":2380,"wires":[["a981be83.8eed7","d9d97e75.67a25"]]},{"id":"a981be83.8eed7","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.name","targetType":"msg","x":770,"y":2380,"wires":[]},{"id":"8202d43a.897b68","type":"function","z":"9ab1c0c7.d7f57","name":"Marya","func":"const marya = new msg.payload('Marya');\nmarya.logName();\nmsg.payload = marya;\nreturn msg;","outputs":1,"noerr":0,"x":530,"y":2440,"wires":[["a981be83.8eed7","d9d97e75.67a25"]]},{"id":"d9d97e75.67a25","type":"function","z":"9ab1c0c7.d7f57","name":"logName","func":"var msg1 = {};\nmsg1.payload = {\n    name: msg.payload.name,\n    log: \"log\" + msg.payload.name};\n    node.send(msg1);\nreturn;","outputs":1,"noerr":0,"x":740,"y":2440,"wires":[["8afb6e8.8ee4d9"]]},{"id":"8afb6e8.8ee4d9","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":930,"y":2440,"wires":[]},{"id":"aa8e4952.7c0b08","type":"function","z":"5b0c3533.c576cc","name":"map => object","func":"msg.topic = \"map => object\";\nmsg.payload = msg.payload.map(item => ({\n    'item': item,\n    'propA': item * item,\n    'propB': item + ' B'\n}))\nreturn msg;\n","outputs":1,"noerr":0,"x":380,"y":660,"wires":[["de9df6d0.6ef318"]]},{"id":"de9df6d0.6ef318","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":570,"y":660,"wires":[]},{"id":"8594b7d2.d17238","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"msg.payload = context.flow.keys();\nreturn msg;","outputs":1,"noerr":0,"x":800,"y":2700,"wires":[["b0145d80.a67f3"]]},{"id":"5dc560cc.2decc","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":620,"y":2700,"wires":[["8594b7d2.d17238"]]},{"id":"b0145d80.a67f3","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":2700,"wires":[]},{"id":"e51e0baf.6c96d8","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"function step00() {\n  var raz = Array.prototype.slice.call(document.querySelectorAll('input[type=\"text\"], input:not([type])'));  // если текстовые поля больше 5px\n  msg.payload = raz;\n    // raz[0].value = 'Иванова';\n    // raz[1].value = 'Наталья';\n    // raz[2].value = 'test@test.ru';\n    // raz[3].value = '+7(123)456-78-90';\n    //raz[4].value = '000000';\n    //raz[5].value = 'ОТДЕЛОМ УФМС РОССИИ ПО ...';\n    //raz[6].value = '01.01.2009';\n    // for (var i = 0; i < 3; i++) {  // эмулировать (имитировать) действия посетителя\n    //   raz[i].dispatchEvent(new Event(\"change\"));\n    //   raz[i].dispatchEvent(new Event(\"change\"));\n    //   raz[i].dispatchEvent(new Event(\"keydown\"));\n    //   raz[i].dispatchEvent(new Event(\"keyup\"));\n    // }\n   // requestAnimationFrame(step01);  // запустить следующую функцию\n  \n}\nstep00();\nreturn msg;","outputs":1,"noerr":0,"x":380,"y":2980,"wires":[["ff38fe08.a31fb"]]},{"id":"5c1a1816.bb4218","type":"http request","z":"9ab1c0c7.d7f57","name":"","method":"GET","ret":"txt","url":"","x":530,"y":2880,"wires":[["e51e0baf.6c96d8"]]},{"id":"7002408a.32c61","type":"inject","z":"9ab1c0c7.d7f57","name":"cars on craigslist","topic":"","payload":"https://сатвика.рф/","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"","x":200,"y":2880,"wires":[["8b6bef4f.5bd79"]]},{"id":"8b6bef4f.5bd79","type":"change","z":"9ab1c0c7.d7f57","name":"","rules":[{"t":"set","p":"url","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":2880,"wires":[["5c1a1816.bb4218"]]},{"id":"ff38fe08.a31fb","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"console":"false","complete":"false","x":690,"y":2980,"wires":[]},{"id":"870cd61a.93bb48","type":"function","z":"9ab1c0c7.d7f57","name":"create obj (send picture)","func":"msg.payload = {\n    \"chatId\": 123456789,\n    \"messageId\": 1,\n    \"type\": \"photo\",\n    \"content\": \"foo.jpeg\"\n}\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"x":310,"y":3120,"wires":[["bb866abb.9a5e68"]]},{"id":"78bb9d20.b61934","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":3040,"wires":[["870cd61a.93bb48"]]},{"id":"bb866abb.9a5e68","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.chatId","targetType":"msg","x":610,"y":3120,"wires":[]},{"id":"7fe68d4e.a49b84","type":"function","z":"1635ef5e.c89941","name":"add prop to obj","func":"const user = { id: 100, name: 'Howard Moon' };\nconst password = msg.payload;\nconst userWithPassword = {\n  ...user,\n  id: 100,\n  ...(password && { password })\n};\nmsg.payload = userWithPassword;\nreturn msg;","outputs":1,"noerr":0,"x":900,"y":2260,"wires":[["5b154a4c.8c5434"]]},{"id":"83d219a4.fc6788","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"Password","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":680,"y":2260,"wires":[["7fe68d4e.a49b84"]]},{"id":"5b154a4c.8c5434","type":"debug","z":"1635ef5e.c89941","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":940,"y":2160,"wires":[]},{"id":"2acfadb5.0e9a32","type":"inject","z":"1635ef5e.c89941","name":"","topic":"","payload":"","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":670,"y":2300,"wires":[["7fe68d4e.a49b84"]]},{"id":"f2fdb06a.e0f34","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":840,"y":1580,"wires":[]},{"id":"c6bf05cb.b49a98","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":690,"y":1740,"wires":[]},{"id":"4ded6a18.821ca4","type":"function","z":"9ab1c0c7.d7f57","name":"JSON.stringify","func":"msg.payload = JSON.stringify(msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":780,"y":1660,"wires":[["c0aefba0.ea1e28"]]},{"id":"c0aefba0.ea1e28","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":990,"y":1660,"wires":[]},{"id":"b16abfdc.23af5","type":"http request","z":0,"name":"request work calendar","method":"GET","ret":"txt","paytoqs":false,"url":"https://data.gov.ru/api/json/dataset/7708660670-proizvcalendar/version/20151123T183036/content?access_token=8248049d3b80aced78befffb1893a35d","tls":"","persist":false,"proxy":"","authType":"","x":200,"y":240,"wires":[["ada23b8e.8d5ec8"]]},{"id":"ada23b8e.8d5ec8","type":"json","z":0,"name":"","property":"payload","action":"","pretty":false,"x":150,"y":320,"wires":[["352a8654.8eee0a"]]},{"id":"352a8654.8eee0a","type":"function","z":0,"name":"get this and next year","func":"const thisYear = new Date().getFullYear();\n\nconst nextAndThisYear = msg.payload.filter(x=>{\n    return x[\"Год/Месяц\"] === thisYear.toString() || x[\"Год/Месяц\"] === (thisYear + 1).toString();\n})\nconst newMsg = {payload: nextAndThisYear};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":340,"y":320,"wires":[["c9d988a2.d918d8"]]},{"id":"c9d988a2.d918d8","type":"function","z":0,"name":"transform","func":"const documents = [];\n\nmsg.payload.forEach(x=>{\n    const yearDocument = [];\n    \n    yearDocument[0] = x[\"Январь\"].split(',');\n    yearDocument[1] = x[\"Февраль\"].split(',');\n    yearDocument[2] = x[\"Март\"].split(',');\n    yearDocument[3] = x[\"Апрель\"].split(',');\n    yearDocument[4] = x[\"Май\"].split(',');\n    yearDocument[5] = x[\"Июнь\"].split(',');\n    yearDocument[6] = x[\"Июль\"].split(',');\n    yearDocument[7] = x[\"Август\"].split(',');\n    yearDocument[8] = x[\"Сентябрь\"].split(',');\n    yearDocument[9] = x[\"Октябрь\"].split(',');\n    yearDocument[10] = x[\"Ноябрь\"].split(',');\n    yearDocument[11] = x[\"Декабрь\"].split(',');\n    \n    documents.push(yearDocument);\n});\n\nmsg.payload = documents;\n\n\nreturn msg;","outputs":1,"noerr":0,"x":560,"y":320,"wires":[["c1239a7b.e0b1e8"]]},{"id":"c1239a7b.e0b1e8","type":"split","z":0,"name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":750,"y":320,"wires":[["96c2533c.d9c9"]]},{"id":"96c2533c.d9c9","type":"function","z":0,"name":"transform for db","func":"const newMsg = {};\nconst thisYear = new Date().getFullYear();\n\nnewMsg.payload = {\n    year: msg.parts.index === 0 ? thisYear : thisYear + 1,\n    monthes: msg.payload\n}\n\nreturn newMsg;","outputs":1,"noerr":0,"x":780,"y":400,"wires":[["cbe26338.3b20f","8364e2a8.481"]]},{"id":"cbe26338.3b20f","type":"function","z":0,"name":"set ready to save","func":"const $set = {$set: msg.payload};\nconst newMsg ={payload: $set, query: {year:msg.payload.year}};\nreturn newMsg;","outputs":1,"noerr":0,"x":990,"y":400,"wires":[[]]},{"id":"cba9e379.b25fb","type":"inject","z":0,"name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":140,"y":140,"wires":[["b16abfdc.23af5"]]},{"id":"8364e2a8.481","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":970,"y":240,"wires":[]},{"id":"4fba22ad.7712bc","type":"function","z":0,"name":"transform for db","func":"msg.originalPayload = msg.payload ? msg.payload : {};\nconst thisYear = new Date().getFullYear();\n\nmsg.payload = {\n    year: thisYear\n};\n\nreturn [msg];","outputs":1,"noerr":0,"x":420,"y":480,"wires":[["f05b97d1.b357e8","540055ea.9e1f3c","c733d5b4.adad88"]]},{"id":"f05b97d1.b357e8","type":"function","z":0,"name":"check if weekend","func":"const today = new Date();\nconst day = today.getDay();\nconst date = today.getDate();\nconst month = today.getMonth();\nconst year = today.getFullYear();\n\n//const thisYear = msg.payload[0];\nconst thisYear = msg.payload.year;\n\nif(!thisYear) return;\n\nconst thisMonth = thisYear.monthes[month];\n\nconst isWeekend = (day === 6) || (day === 0);\n\nmsg.payload = msg.originalPayload;\n//msg.payload = msg.payload[1];\n\nif(isWeekend) {\n    const checkDay = date + '*';\n    if(thisMonth.some(x=>x===checkDay)) {\n        return [null, msg];\n    }\n}\n\n if(!thisMonth.some(x=>x===date.toString() || x === date + '+')) {\n     return [null, msg];\n }\n\nreturn [msg, null];","outputs":2,"noerr":0,"x":670,"y":580,"wires":[["e150f3fb.5a482"],["3a4005e3.98efea"]]},{"id":"e150f3fb.5a482","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1000,"y":500,"wires":[]},{"id":"3a4005e3.98efea","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":560,"wires":[]},{"id":"ddce2779.3bcd58","type":"inject","z":0,"name":"","topic":"","payload":"какой то сигнал","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":200,"y":480,"wires":[["4fba22ad.7712bc"]]},{"id":"540055ea.9e1f3c","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"originalPayload","targetType":"msg","x":690,"y":480,"wires":[]},{"id":"c733d5b4.adad88","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":650,"y":520,"wires":[]},{"id":"224c0cc2.903cd4","type":"debug","z":0,"name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload[0]","targetType":"msg","x":490,"y":660,"wires":[]},{"id":"278f83d.28d907c","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"сигнал","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":270,"y":140,"wires":[["1d38b607.61c44a"]]},{"id":"1d38b607.61c44a","type":"subflow:3d8c54f9.690a4c","z":"f4459a62.9c06c8","name":"","env":[],"x":460,"y":200,"wires":[["495cca5c.2a4d44"],["8ce9133e.ea825"]],"outputLabels":["Weekend","Workday"]},{"id":"495cca5c.2a4d44","type":"debug","z":"f4459a62.9c06c8","name":"Weekend","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":660,"y":160,"wires":[]},{"id":"8ce9133e.ea825","type":"debug","z":"f4459a62.9c06c8","name":"Workday","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":660,"y":240,"wires":[]},{"id":"2c86e4c9.4c3adc","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"2","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":480,"wires":[["12ee1db.8b3a5e2"]]},{"id":"28a43837.844418","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"4","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":560,"wires":[["12ee1db.8b3a5e2"]]},{"id":"8209b415.eb7398","type":"counter","z":"e04c9865.8f9be8","name":"","init":"0","step":"1","lower":null,"upper":null,"mode":"increment","outputs":"1","x":360,"y":140,"wires":[["c52eaa00.3faf28"]]},{"id":"c52eaa00.3faf28","type":"switch","z":"e04c9865.8f9be8","name":"","property":"count","propertyType":"msg","rules":[{"t":"eq","v":"2","vt":"str"},{"t":"eq","v":"1","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":530,"y":140,"wires":[["655a1155.990f6","750d92bf.74eb5c"],["ad3fa9f8.6512d8"]]},{"id":"3d4f29a4.965f86","type":"function","z":"e04c9865.8f9be8","name":"msg.reset","func":"msg.reset = true;\nreturn msg;","outputs":1,"noerr":0,"x":360,"y":280,"wires":[["8dfd6098.a84d5"]]},{"id":"66f7e4d0.a66c2c","type":"inject","z":"e04c9865.8f9be8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":350,"y":340,"wires":[["3d4f29a4.965f86"]]},{"id":"8dfd6098.a84d5","type":"change","z":"e04c9865.8f9be8","name":"acc = 0","rules":[{"t":"set","p":"acc","pt":"flow","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":200,"wires":[["8209b415.eb7398"]]},{"id":"412471ef.4b193","type":"function","z":"e04c9865.8f9be8","name":"add","func":"flow.set(\"acc\", flow.get(\"acc\") + msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":190,"y":140,"wires":[["8209b415.eb7398"]]},{"id":"655a1155.990f6","type":"change","z":"e04c9865.8f9be8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"acc","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":700,"y":140,"wires":[["3d4f29a4.965f86","e8ec1e52.f3771"]]},{"id":"21216034.dc2a3","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":400,"wires":[["12ee1db.8b3a5e2"]]},{"id":"12ee1db.8b3a5e2","type":"subflow:e04c9865.8f9be8","z":"f4459a62.9c06c8","name":"","env":[{"name":"test","value":"222","type":"num"}],"x":580,"y":480,"wires":[["e7c3f481.8d7118"]]},{"id":"e7c3f481.8d7118","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":800,"y":480,"wires":[]},{"id":"bcc73d03.e93db","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"234","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":270,"y":200,"wires":[["1d38b607.61c44a"]]},{"id":"3f8698ab.5f4ab8","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"{\"JSON\":\"test\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":300,"y":260,"wires":[["1d38b607.61c44a"]]},{"id":"e842227.7593fe","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":270,"y":80,"wires":[["1d38b607.61c44a"]]},{"id":"52b9133d.90675c","type":"http request","z":"f4459a62.9c06c8","name":"request work calendar","method":"GET","ret":"txt","paytoqs":false,"url":"https://data.gov.ru/api/json/dataset/7708660670-proizvcalendar/version/20151123T183036/content?access_token=8248049d3b80aced78befffb1893a35d","tls":"","persist":false,"proxy":"","authType":"","x":240,"y":920,"wires":[["f2e563a.840eea"]]},{"id":"f2e563a.840eea","type":"json","z":"f4459a62.9c06c8","name":"","property":"payload","action":"","pretty":false,"x":310,"y":1000,"wires":[["34475cd4.6c26d4"]]},{"id":"34475cd4.6c26d4","type":"function","z":"f4459a62.9c06c8","name":"get this year","func":"const thisYear = new Date().getFullYear();\n\nconst ThisYear = msg.payload.filter(x => x[\"Год/Месяц\"] === thisYear.toString());\nconst newMsg = {payload: ThisYear};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":490,"y":1000,"wires":[["f624819a.a5091"]]},{"id":"f624819a.a5091","type":"function","z":"f4459a62.9c06c8","name":"transform","func":"const documents = [];\n\nmsg.payload.forEach(x=>{\n    const yearDocument = [];\n    \n    yearDocument[0] = x[\"Январь\"].split(',');\n    yearDocument[1] = x[\"Февраль\"].split(',');\n    yearDocument[2] = x[\"Март\"].split(',');\n    yearDocument[3] = x[\"Апрель\"].split(',');\n    yearDocument[4] = x[\"Май\"].split(',');\n    yearDocument[5] = x[\"Июнь\"].split(',');\n    yearDocument[6] = x[\"Июль\"].split(',');\n    yearDocument[7] = x[\"Август\"].split(',');\n    yearDocument[8] = x[\"Сентябрь\"].split(',');\n    yearDocument[9] = x[\"Октябрь\"].split(',');\n    yearDocument[10] = x[\"Ноябрь\"].split(',');\n    yearDocument[11] = x[\"Декабрь\"].split(',');\n    \n    documents.push(yearDocument);\n});\n\nmsg.payload = documents;\n\n\nreturn msg;","outputs":1,"noerr":0,"x":660,"y":1000,"wires":[["bf3a1cfa.f4075"]]},{"id":"bf3a1cfa.f4075","type":"split","z":"f4459a62.9c06c8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":810,"y":1000,"wires":[["4adf7c08.38ac04"]]},{"id":"4adf7c08.38ac04","type":"function","z":"f4459a62.9c06c8","name":"isWeekend","func":"const today = new Date();\nconst day = today.getDay();\nconst date = today.getDate();\nconst month = today.getMonth();\n\nconst thisMonth = msg.payload[month];\nconst isWeekend = (day === 6) || (day === 0);\nmsg.topic = false;\nif(!isWeekend) {\n    const checkDay = date + '*';\n    if(thisMonth.some(x => x===checkDay)) {\n        return msg;\n    }\n}\nif(!thisMonth.some(x => x===date.toString() || x === date + '+')) {\n    return msg;\n}\nmsg.topic = true;\nreturn msg;\n","outputs":1,"noerr":0,"x":190,"y":1120,"wires":[["86eb23d4.b210e"]],"outputLabels":["isWeekend"]},{"id":"262817a8.73f358","type":"switch","z":"f4459a62.9c06c8","name":"Weekend","property":"topic","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":620,"y":1120,"wires":[[],[]]},{"id":"86eb23d4.b210e","type":"change","z":"f4459a62.9c06c8","name":"set originalPayload","rules":[{"t":"set","p":"payload","pt":"msg","to":"originalPayload","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":1120,"wires":[["262817a8.73f358"]]},{"id":"16a6b80d.c48da8","type":"catch","z":"3d8c54f9.690a4c","name":"","scope":["6ca4c303.3d01dc","ff2a048f.b08938"],"uncaught":false,"x":130,"y":40,"wires":[["38cd9698.3d7eba"]]},{"id":"fb82c5ca.e80448","type":"pushbullet","z":"3d8c54f9.690a4c","config":"59d81e7a.0963d","pushtype":"","title":"","chan":"","name":"Node-Red notification","x":640,"y":40,"wires":[]},{"id":"38cd9698.3d7eba","type":"function","z":"3d8c54f9.690a4c","name":"msg.error","func":"msg.topic = msg.error.source.name;\nmsg.payload = msg.error.message;\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":40,"wires":[["fb82c5ca.e80448"]]},{"id":"26031dfa.590082","type":"switch","z":"f4459a62.9c06c8","name":"Weekend","property":"weekend","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":740,"y":1580,"wires":[["5f02c65f.efd1c8"],["227e45b8.9fe8ea"]]},{"id":"5f02c65f.efd1c8","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":960,"y":1540,"wires":[]},{"id":"227e45b8.9fe8ea","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":true,"complete":"payload","targetType":"msg","x":960,"y":1600,"wires":[]},{"id":"9629d03a.86ad6","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"test2","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":1580,"wires":[["6b2d2aa9.963574","798c0dfa.1a6e34"]]},{"id":"2049b665.e15eca","type":"http request","z":"f4459a62.9c06c8","name":"request work calendar","method":"GET","ret":"txt","paytoqs":false,"url":"https://data.gov.ru/api/json/dataset/7708660670-proizvcalendar/version/20151123T183036/content?access_token=8248049d3b80aced78befffb1893a35d","tls":"","persist":false,"proxy":"","authType":"","x":220,"y":1280,"wires":[["549e4694.d23ec8"]]},{"id":"549e4694.d23ec8","type":"json","z":"f4459a62.9c06c8","name":"","property":"payload","action":"","pretty":false,"x":410,"y":1280,"wires":[["c3469b6f.5f5d28"]]},{"id":"c3469b6f.5f5d28","type":"function","z":"f4459a62.9c06c8","name":"get this year","func":"const thisYear = new Date().getFullYear();\n\nconst ThisYear = msg.payload.filter(x => x[\"Год/Месяц\"] === thisYear.toString());\nconst newMsg = {payload: ThisYear};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":570,"y":1280,"wires":[["7758f3c1.8972cc"]]},{"id":"7758f3c1.8972cc","type":"function","z":"f4459a62.9c06c8","name":"transform","func":"const documents = [];\n\nmsg.payload.forEach(x=>{\n    const yearDocument = [];\n    \n    yearDocument[0] = x[\"Январь\"].split(',');\n    yearDocument[1] = x[\"Февраль\"].split(',');\n    yearDocument[2] = x[\"Март\"].split(',');\n    yearDocument[3] = x[\"Апрель\"].split(',');\n    yearDocument[4] = x[\"Май\"].split(',');\n    yearDocument[5] = x[\"Июнь\"].split(',');\n    yearDocument[6] = x[\"Июль\"].split(',');\n    yearDocument[7] = x[\"Август\"].split(',');\n    yearDocument[8] = x[\"Сентябрь\"].split(',');\n    yearDocument[9] = x[\"Октябрь\"].split(',');\n    yearDocument[10] = x[\"Ноябрь\"].split(',');\n    yearDocument[11] = x[\"Декабрь\"].split(',');\n    \n    documents.push(yearDocument);\n});\n\nmsg.payload = documents;\n\n\nreturn msg;","outputs":1,"noerr":0,"x":740,"y":1280,"wires":[["b9c1be90.c2c41"]]},{"id":"48f577fa.8d9508","type":"split","z":"f4459a62.9c06c8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"payload.calendar","x":1030,"y":1280,"wires":[["19a90a2e.5de096"]]},{"id":"6b2d2aa9.963574","type":"function","z":"f4459a62.9c06c8","name":"isWeekend","func":"var thisMonth;\nconst today = new Date();\nconst day = today.getDay();\nconst date = today.getDate();\nconst month = today.getMonth();\n\nflow.get(\"calendar\", \"file\", function(err, calendar) {\n    if (err) {\n        node.error(err, msg);\n    } else {\n        thisMonth = calendar[month];\n    }\n});\n\nif (thisMonth) {\nconst isWeekend = (day === 6) || (day === 0);\nmsg.weekend = false;\nnode.status({fill:\"green\",shape:\"ring\",text:\"workday\"});\nif(!isWeekend) {\n    const checkDay = date + '*';\n    if(thisMonth.some(x => x===checkDay)) {\n        return msg;\n    }\n}\nif(!thisMonth.some(x => x===date.toString() || x === date + '+')) {\n    return msg;\n}\nmsg.weekend = true;\nnode.status({fill:\"red\",shape:\"ring\",text:\"weekend\"});\nreturn msg;\n}","outputs":1,"noerr":0,"x":550,"y":1580,"wires":[["143e471a.c189e9","26031dfa.590082","1f2af464.9b37bc"]],"outputLabels":["isWeekend"]},{"id":"a013fbbc.d7a0d8","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"00 00 * * *","once":false,"onceDelay":"1","x":190,"y":1220,"wires":[["2049b665.e15eca"]]},{"id":"b9ec1d5e.48875","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"1","x":190,"y":1340,"wires":[["2049b665.e15eca","5ce8697e.d45968"]]},{"id":"19a90a2e.5de096","type":"change","z":"f4459a62.9c06c8","name":"","rules":[{"t":"set","p":"#:(file)::calendar","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"flow"},{"t":"delete","p":"payload","pt":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":780,"y":1380,"wires":[["41737d04.4b4484"]]},{"id":"b9c1be90.c2c41","type":"switch","z":"f4459a62.9c06c8","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":890,"y":1280,"wires":[["48f577fa.8d9508"]]},{"id":"143e471a.c189e9","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":530,"y":1500,"wires":[]},{"id":"44738df7.f01364","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"3","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":1620,"wires":[["6b2d2aa9.963574","798c0dfa.1a6e34"]]},{"id":"5a25b29d.d82e3c","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"test1","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":170,"y":1540,"wires":[["6b2d2aa9.963574","798c0dfa.1a6e34"]]},{"id":"1f2af464.9b37bc","type":"function","z":"f4459a62.9c06c8","name":"","func":"const today = new Date();\nmsg.payload= today.getDate();\nreturn msg;","outputs":1,"noerr":0,"x":690,"y":1660,"wires":[["bb2a0091.4886f"]]},{"id":"bb2a0091.4886f","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":870,"y":1700,"wires":[]},{"id":"efcbc307.b5c91","type":"http request","z":"3d8c54f9.690a4c","name":"request work calendar","method":"GET","ret":"txt","paytoqs":false,"url":"https://data.gov.ru/api/json/dataset/7708660670-proizvcalendar/version/20151123T183036/content?access_token=8248049d3b80aced78befffb1893a35d","tls":"","persist":false,"proxy":"","authType":"","x":320,"y":140,"wires":[["b9142c36.46f92"]]},{"id":"b9142c36.46f92","type":"json","z":"3d8c54f9.690a4c","name":"","property":"payload","action":"","pretty":false,"x":510,"y":140,"wires":[["cf3a5133.fbf03"]]},{"id":"cf3a5133.fbf03","type":"function","z":"3d8c54f9.690a4c","name":"get this year","func":"const thisYear = new Date().getFullYear();\n\nconst ThisYear = msg.payload.filter(x => x[\"Год/Месяц\"] === thisYear.toString());\nconst newMsg = {payload: ThisYear};\n\nreturn newMsg;","outputs":1,"noerr":0,"x":670,"y":140,"wires":[["a6d897a2.46ca68"]]},{"id":"a6d897a2.46ca68","type":"function","z":"3d8c54f9.690a4c","name":"transform","func":"const documents = [];\n\nmsg.payload.forEach(x=>{\n    const yearDocument = [];\n    \n    yearDocument[0] = x[\"Январь\"].split(',');\n    yearDocument[1] = x[\"Февраль\"].split(',');\n    yearDocument[2] = x[\"Март\"].split(',');\n    yearDocument[3] = x[\"Апрель\"].split(',');\n    yearDocument[4] = x[\"Май\"].split(',');\n    yearDocument[5] = x[\"Июнь\"].split(',');\n    yearDocument[6] = x[\"Июль\"].split(',');\n    yearDocument[7] = x[\"Август\"].split(',');\n    yearDocument[8] = x[\"Сентябрь\"].split(',');\n    yearDocument[9] = x[\"Октябрь\"].split(',');\n    yearDocument[10] = x[\"Ноябрь\"].split(',');\n    yearDocument[11] = x[\"Декабрь\"].split(',');\n    \n    documents.push(yearDocument);\n});\n\nmsg.payload = documents;\n\n\nreturn msg;","outputs":1,"noerr":0,"x":840,"y":140,"wires":[["e3864eb6.9e3de"]]},{"id":"a38b6c8.aa5059","type":"split","z":"3d8c54f9.690a4c","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":610,"y":220,"wires":[["f0152a10.2f9fa8"]]},{"id":"51b7f1fb.5d55e","type":"inject","z":"3d8c54f9.690a4c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"00 00 * * *","once":false,"onceDelay":"1","x":130,"y":220,"wires":[["efcbc307.b5c91"]]},{"id":"daaaad02.70e52","type":"inject","z":"3d8c54f9.690a4c","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":"1","x":130,"y":300,"wires":[["efcbc307.b5c91","a80f7f53.04bea"]]},{"id":"e3864eb6.9e3de","type":"switch","z":"3d8c54f9.690a4c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":990,"y":140,"wires":[["a38b6c8.aa5059"]]},{"id":"d36b0ff8.9e958","type":"switch","z":"3d8c54f9.690a4c","name":"Weekend","property":"weekend","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":840,"y":380,"wires":[[],[]],"outputLabels":["Weekend","Workday"]},{"id":"de99ce4.97a623","type":"catch","z":"f4459a62.9c06c8","name":"","scope":["6b2d2aa9.963574"],"uncaught":false,"x":210,"y":1460,"wires":[["2049b665.e15eca"]]},{"id":"d8741d.9c56cbe","type":"catch","z":"3d8c54f9.690a4c","name":"","scope":["abf60dee.b3179"],"uncaught":false,"x":130,"y":100,"wires":[["efcbc307.b5c91","38cd9698.3d7eba"]]},{"id":"42c3002.e364d","type":"change","z":"e04c9865.8f9be8","name":"","rules":[{"t":"set","p":"status.text","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"status.fill","pt":"msg","to":"green","tot":"str"},{"t":"set","p":"status.shape","pt":"msg","to":"ring","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":200,"y":80,"wires":[[]]},{"id":"eb8f1c74.d85d1","type":"function","z":"f4459a62.9c06c8","name":"callback","func":"flow.get('count', function(err, count) {\n    if (err) {\n        node.error(err, msg);\n    } else {\n        msg.count = count;\n        node.send(msg);\n    }\n});\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":1820,"wires":[["5598e8ca.21c388","5d998030.4402d"]]},{"id":"14bd43ab.9a63dc","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":1820,"wires":[["eb8f1c74.d85d1"]]},{"id":"5598e8ca.21c388","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"count","targetType":"msg","x":700,"y":1820,"wires":[]},{"id":"5d5efe09.8afc4","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":300,"y":1740,"wires":[["28636c89.732694"]]},{"id":"28636c89.732694","type":"change","z":"f4459a62.9c06c8","name":"","rules":[{"t":"set","p":"count","pt":"flow","to":"$flowContext(\"count\") + 1\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":1740,"wires":[["eb8f1c74.d85d1"]]},{"id":"5d998030.4402d","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":700,"y":1860,"wires":[]},{"id":"141b4fdc.fac61","type":"status","z":"3d8c54f9.690a4c","name":"","scope":null,"x":380,"y":480,"wires":[[]]},{"id":"389c6f1d.7298a","type":"function","z":"f4459a62.9c06c8","name":"","func":"var thisMonth;\nflow.get(\"calendar\", \"file\", function(err, calendar) {\n    if (err) {\n        node.status({fill:\"red\",shape:\"ring\",text:\"error\"});\n        node.error(err, msg);\n    } else {\n        thisMonth = calendar[2];\n        //msg.payload = calendar;\n        //node.send(msg);\n    }\n});\nmsg.payload = thisMonth;\nreturn msg;","outputs":1,"noerr":0,"x":630,"y":1920,"wires":[["a45e5dd0.134a1"]]},{"id":"be99824c.9a6d1","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":480,"y":1920,"wires":[["389c6f1d.7298a"]]},{"id":"a45e5dd0.134a1","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":810,"y":1920,"wires":[]},{"id":"13a4e4f5.334ebb","type":"function","z":"3d8c54f9.690a4c","name":"isWeekend","func":"var thisMonth;\nconst today = new Date();\nconst day = today.getDay();\nconst date = today.getDate();\nconst month = today.getMonth();\n\nflow.get(\"calendar\", \"file\", function(err, calendar) {\n    if (err) {\n        node.error(err, msg);\n    } else {\n        thisMonth = calendar[month];\n    }\n});\n\nif (thisMonth) {\nconst isWeekend = (day === 6) || (day === 0);\nmsg.weekend = false;\nnode.status({fill:\"green\",shape:\"ring\",text:\"workday\"});\nif(!isWeekend) {\n    const checkDay = date + '*';\n    if(thisMonth.some(x => x===checkDay)) {\n        return msg;\n    }\n}\nif(!thisMonth.some(x => x===date.toString() || x === date + '+')) {\n    return msg;\n}\nmsg.weekend = true;\nnode.status({fill:\"red\",shape:\"ring\",text:\"weekend\"});\nreturn msg;\n}","outputs":1,"noerr":0,"x":630,"y":380,"wires":[["d36b0ff8.9e958"]],"outputLabels":["isWeekend"]},{"id":"798c0dfa.1a6e34","type":"change","z":"f4459a62.9c06c8","name":"","rules":[{"t":"set","p":"payload","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":1400,"wires":[[]]},{"id":"41737d04.4b4484","type":"switch","z":"f4459a62.9c06c8","name":"","property":"payload","propertyType":"msg","rules":[{"t":"istype","v":"undefined","vt":"undefined"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":750,"y":1460,"wires":[[],["6b2d2aa9.963574"]]},{"id":"5ce8697e.d45968","type":"change","z":"f4459a62.9c06c8","name":"","rules":[{"t":"delete","p":"payload","pt":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":470,"y":1340,"wires":[[]]},{"id":"f0152a10.2f9fa8","type":"change","z":"3d8c54f9.690a4c","name":"","rules":[{"t":"set","p":"#:(file)::calendar","pt":"flow","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"payload","tot":"flow"},{"t":"delete","p":"payload","pt":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":800,"y":220,"wires":[["3303cfe3.65a3e"]]},{"id":"325ad707.8f5d88","type":"change","z":"3d8c54f9.690a4c","name":"","rules":[{"t":"set","p":"payload","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":380,"y":380,"wires":[["13a4e4f5.334ebb"]]},{"id":"3303cfe3.65a3e","type":"switch","z":"3d8c54f9.690a4c","name":"","property":"payload","propertyType":"msg","rules":[{"t":"istype","v":"undefined","vt":"undefined"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":610,"y":300,"wires":[[],["13a4e4f5.334ebb"]]},{"id":"a80f7f53.04bea","type":"change","z":"3d8c54f9.690a4c","name":"","rules":[{"t":"delete","p":"payload","pt":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":370,"y":300,"wires":[[]]},{"id":"e578df7a.a5be5","type":"function","z":"f4459a62.9c06c8","name":"","func":"let obj = {\n\t\"1\": 1,\n\t0: 2\n}\n\nmsg.payload = (obj[\"0\"])\nreturn msg;","outputs":1,"noerr":0,"x":500,"y":700,"wires":[["fdc4067f.67def8"]]},{"id":"fdc4067f.67def8","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":700,"y":700,"wires":[]},{"id":"c4bc9272.a3b63","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":700,"wires":[["e578df7a.a5be5"]]},{"id":"5b620c1b.fb24c4","type":"function","z":"f4459a62.9c06c8","name":"","func":"for (var i = 0; i < 10; i++) {\n setTimeout( \n     () => {\n         msg.payload = i;\n         node.send(msg); \n     }, 0);\n}\n//return msg;","outputs":1,"noerr":0,"x":500,"y":780,"wires":[["fdc4067f.67def8"]]},{"id":"d2e134de.5a23f8","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":780,"wires":[["5b620c1b.fb24c4"]]},{"id":"6b0dffb.ce932","type":"function","z":"f4459a62.9c06c8","name":"","func":"var a = new Array(5, 50);\nvar b = new Array(5, 50);\n(a == b) ? msg.payload = true : msg.payload = false\nreturn msg;","outputs":1,"noerr":0,"x":510,"y":860,"wires":[["fdc4067f.67def8"]]},{"id":"a3464d9f.78339","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":300,"y":860,"wires":[["6b0dffb.ce932"]]},{"id":"dbb8e47.5e99c18","type":"function","z":"f4459a62.9c06c8","name":"","func":"var a = Array(5, 50);\na[a.length] = 0;\nmsg.payload = a.length\nnode.send(msg); ","outputs":1,"noerr":0,"x":500,"y":620,"wires":[["fdc4067f.67def8"]]},{"id":"1af85787.b3a938","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":320,"y":620,"wires":[["dbb8e47.5e99c18"]]},{"id":"ef4fb5a4.9b9e28","type":"function","z":"f4459a62.9c06c8","name":"","func":"const today = new Date();\nif (today.getDate() == 25) node.send(msg);\n//return msg;","outputs":1,"noerr":0,"x":500,"y":2040,"wires":[["2cf79ad2.15d336"]]},{"id":"2cf79ad2.15d336","type":"debug","z":"f4459a62.9c06c8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":730,"y":2040,"wires":[]},{"id":"55793f04.0489c","type":"inject","z":"f4459a62.9c06c8","name":"","topic":"","payload":"Тест","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":250,"y":2040,"wires":[["ef4fb5a4.9b9e28"]]},{"id":"f7ba5eee.f76a7","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"auto","payloadType":"str","repeat":"","crontab":"","once":true,"onceDelay":"1","x":190,"y":340,"wires":[["ed834ea1.608d"]]},{"id":"ed834ea1.608d","type":"bigtimer","z":"97eec2ac.3243f","outtopic":"timer1","outpayload1":"true","outpayload2":"false","name":"Big Timer","comment":"timer1","lat":"50","lon":"50","starttime":"690","endtime":"705","starttime2":"0","endtime2":"0","startoff":0,"endoff":0,"startoff2":0,"endoff2":0,"offs":0,"outtext1":"","outtext2":"","timeout":"1440","sun":false,"mon":false,"tue":false,"wed":false,"thu":false,"fri":false,"sat":false,"jan":false,"feb":false,"mar":false,"apr":false,"may":false,"jun":false,"jul":false,"aug":false,"sep":false,"oct":false,"nov":false,"dec":false,"day1":"26","month1":"3","day2":"27","month2":"3","day3":"29","month3":"3","day4":0,"month4":0,"day5":0,"month5":0,"day6":0,"month6":0,"day7":"","month7":"","day8":"","month8":"","day9":"","month9":"","day10":"","month10":"","day11":"","month11":"","day12":"","month12":"","d1":0,"w1":0,"d2":0,"w2":0,"d3":0,"w3":0,"d4":0,"w4":0,"d5":0,"w5":0,"d6":0,"w6":0,"xday1":"","xmonth1":"","xday2":0,"xmonth2":0,"xday3":0,"xmonth3":0,"xday4":0,"xmonth4":0,"xday5":0,"xmonth5":0,"xday6":0,"xmonth6":0,"xd1":"0","xw1":"0","xd2":0,"xw2":0,"xd3":0,"xw3":0,"xd4":0,"xw4":0,"xd5":0,"xw5":0,"xd6":0,"xw6":0,"suspend":false,"random":false,"repeat":false,"atstart":true,"odd":false,"even":false,"x":420,"y":240,"wires":[["6ceef4ee.42e40c"],["57a6c8ee.ff7cc8"],[]]},{"id":"6ceef4ee.42e40c","type":"debug","z":"97eec2ac.3243f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":630,"y":180,"wires":[]},{"id":"4c63bd9a.d02b34","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"on","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":400,"wires":[["ed834ea1.608d"]]},{"id":"57a6c8ee.ff7cc8","type":"debug","z":"97eec2ac.3243f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":650,"y":240,"wires":[]},{"id":"ecd117ee.3c0db8","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"sync","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":240,"wires":[["ed834ea1.608d"]]},{"id":"c43c3efe.d33cb","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"off","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":440,"wires":[["ed834ea1.608d"]]},{"id":"e8ec1e52.f3771","type":"function","z":"e04c9865.8f9be8","name":"","func":"node.status({fill:\"blue\",shape:\"ring\",text:msg.payload});\nreturn msg;","outputs":1,"noerr":0,"x":910,"y":140,"wires":[[]]},{"id":"c21e00ba.b6976","type":"status","z":"e04c9865.8f9be8","name":"","scope":null,"x":200,"y":40,"wires":[[]]},{"id":"ad3fa9f8.6512d8","type":"function","z":"e04c9865.8f9be8","name":"","func":"node.status({});","outputs":1,"noerr":0,"x":850,"y":240,"wires":[[]]},{"id":"750d92bf.74eb5c","type":"delay","z":"e04c9865.8f9be8","name":"","pauseType":"delay","timeout":"3","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":660,"y":240,"wires":[["ad3fa9f8.6512d8"]]},{"id":"c57b0d06.b27e3","type":"remote-xy in","z":"97eec2ac.3243f","name":"switch_1","dashboard":"a843ff36.26c3c","index":"2","x":120,"y":620,"wires":[["f1705029.58992","b69bb484.5f69e8"]]},{"id":"eba0b4b2.225048","type":"remote-xy out","z":"97eec2ac.3243f","name":"led_1_r","dashboard":"a843ff36.26c3c","index":"0","x":980,"y":400,"wires":[]},{"id":"342ad13.2afcc2e","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"0","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":650,"y":400,"wires":[["74ee7766.1e8ed8"]]},{"id":"f1705029.58992","type":"debug","z":"97eec2ac.3243f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":370,"y":560,"wires":[]},{"id":"4fd04991.b2a938","type":"remote-xy in","z":"97eec2ac.3243f","name":"button_1","dashboard":"a843ff36.26c3c","index":"0","x":120,"y":560,"wires":[["f1705029.58992","7c38803f.b06e3"]]},{"id":"c6a9180d.17ed18","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"100","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":650,"y":460,"wires":[["74ee7766.1e8ed8"]]},{"id":"818a91eb.38c47","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"50","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":650,"y":520,"wires":[["74ee7766.1e8ed8"]]},{"id":"c4ae837b.f66ad","type":"debug","z":"97eec2ac.3243f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":890,"y":300,"wires":[]},{"id":"74ee7766.1e8ed8","type":"function","z":"97eec2ac.3243f","name":"","func":"node.send(msg);\n//return msg;","outputs":1,"noerr":0,"x":810,"y":400,"wires":[["eba0b4b2.225048","c4ae837b.f66ad","69500819.f728b8","482aa190.c46db"]]},{"id":"e2fd0698.40afe8","type":"remote-xy in","z":"97eec2ac.3243f","name":"slider_1","dashboard":"a843ff36.26c3c","index":"1","x":110,"y":680,"wires":[["f1705029.58992","482aa190.c46db"]]},{"id":"69500819.f728b8","type":"remote-xy out","z":"97eec2ac.3243f","name":"level_1","dashboard":"a843ff36.26c3c","index":"2","x":980,"y":460,"wires":[]},{"id":"482aa190.c46db","type":"remote-xy out","z":"97eec2ac.3243f","name":"level_2","dashboard":"a843ff36.26c3c","index":"3","x":980,"y":540,"wires":[]},{"id":"d54d6fdb.68f58","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"-100","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":650,"y":340,"wires":[["74ee7766.1e8ed8"]]},{"id":"7c38803f.b06e3","type":"switch","z":"97eec2ac.3243f","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":470,"y":680,"wires":[["f0bb4bf4.c4aac8"],["65b9f42c.091fec"]]},{"id":"65b9f42c.091fec","type":"change","z":"97eec2ac.3243f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"127","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":680,"y":700,"wires":[["ad51d981.06fec8","eba0b4b2.225048"]]},{"id":"ad51d981.06fec8","type":"remote-xy out","z":"97eec2ac.3243f","name":"led_2_g","dashboard":"a843ff36.26c3c","index":"1","x":940,"y":680,"wires":[]},{"id":"f0bb4bf4.c4aac8","type":"change","z":"97eec2ac.3243f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"0","tot":"num"}],"action":"","property":"","from":"","to":"","reg":false,"x":671,"y":654,"wires":[["ad51d981.06fec8","eba0b4b2.225048"]]},{"id":"b69bb484.5f69e8","type":"switch","z":"97eec2ac.3243f","name":"","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"0","vt":"num"},{"t":"eq","v":"1","vt":"num"}],"checkall":"true","repair":false,"outputs":2,"x":310,"y":760,"wires":[["c5b6a3ac.f9ed9"],[]]},{"id":"c5b6a3ac.f9ed9","type":"exec","z":"97eec2ac.3243f","command":"shutdown /s /f","addpay":false,"append":"","useSpawn":"false","timer":"","oldrc":false,"name":"","x":550,"y":780,"wires":[[],[],[]]},{"id":"eb584775.a254e8","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"INSERT INTO FoTr(name, lat, lon, Speed, Temperature, Akkum, Battery, Uptime) VALUES (\"FoTr\",'40', '30', '14.5', '26.5', '11.99', '4.11', '0');","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":3460,"wires":[["48731236.796a8c","20eb3025.f1d52"]]},{"id":"48731236.796a8c","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":330,"y":3400,"wires":[]},{"id":"20eb3025.f1d52","type":"change","z":"9ab1c0c7.d7f57","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"INSERT INTO FoTr(name, ","fromt":"str","to":"","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":") VALUES (\"FoTr\",","fromt":"str","to":",","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":");","fromt":"str","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":340,"y":3460,"wires":[["2ecf0809.19e9a8"]]},{"id":"2ecf0809.19e9a8","type":"split","z":"9ab1c0c7.d7f57","name":"","splt":",","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":530,"y":3460,"wires":[["52503ac2.85d9c4"]]},{"id":"542de1d8.2be88","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"msg.payload = parseFloat(msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":350,"y":3600,"wires":[[]]},{"id":"b1fc354f.165dc8","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":" 4.11","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":3600,"wires":[["542de1d8.2be88"]]},{"id":"52503ac2.85d9c4","type":"change","z":"9ab1c0c7.d7f57","name":"","rules":[{"t":"change","p":"payload","pt":"msg","from":"'","fromt":"str","to":"","tot":"str"},{"t":"change","p":"payload","pt":"msg","from":" ","fromt":"str","to":"","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":720,"y":3460,"wires":[["eda8c6b5.747018"]]},{"id":"eda8c6b5.747018","type":"join","z":"9ab1c0c7.d7f57","name":"","mode":"custom","build":"array","property":"payload","propertyType":"msg","key":"payload","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"num","reduceFixup":"","x":890,"y":3460,"wires":[["4604d12a.af2bd"]]},{"id":"689cecb0.74ab04","type":"function","z":"9ab1c0c7.d7f57","name":"create obj (toJSON)","func":"msg.payload = { \n    firstName: \"Prateek\", \n    lastName: \"Singh\", \n    возраст: 26, \n    toJSON () { \n        return { \n            fullName: `${this.firstName} ${this.lastName}` \n        };\n    }\n};\n/* type can be one of the following\nphoto\naudio\nvideo\nsticker\nvoice\ndocument\n*/\n\nreturn msg;","outputs":1,"noerr":0,"x":280,"y":3680,"wires":[[]]},{"id":"65515d45.50ba64","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":830,"y":3540,"wires":[]},{"id":"4604d12a.af2bd","type":"function","z":"9ab1c0c7.d7f57","name":"","func":"const arr1 = msg.payload.slice(0, 7);\nconst arr2 = msg.payload.slice(7, 14);\n//msg.payload = Object.assign(...arr1.map((n, i) => ({ [n]: arr2[i] })));\nmsg.payload = arr1.reduce((acc, n, i) => (acc[n] = parseFloat(arr2[i]), acc), {});\nreturn msg;","outputs":1,"noerr":0,"x":610,"y":3540,"wires":[["65515d45.50ba64"]]},{"id":"ccabf442.4c6a48","type":"function","z":"5b0c3533.c576cc","name":"Create obj from too array","func":"const arr1 = msg.payload;\nconst arr2 = msg.topic;\n//msg.payload = Object.assign(...arr1.map((n, i) => ({ [n]: arr2[i] })));\n//msg.payload = arr1.reduce((acc, n, i) => ({ ...acc, [n]: arr2[i] }), {})\nmsg.payload = arr1.reduce((acc, n, i) => (acc[n] = parseInt(arr2[i]), acc), {});\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":340,"wires":[["3ad41993.e90f06"]]},{"id":"a671225a.c5eec","type":"inject","z":"5b0c3533.c576cc","name":"","topic":"12345","payload":"[\"a\", \"b\", \"c\", \"d\", \"e\"]","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":190,"y":340,"wires":[["ccabf442.4c6a48"]]},{"id":"3ad41993.e90f06","type":"debug","z":"5b0c3533.c576cc","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":690,"y":340,"wires":[]},{"id":"59e27e98.d716e","type":"template","z":"9ab1c0c7.d7f57","name":"","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<!DOCTYPE html>\n<html>\n<head>\n<title>Отслеживание нажатия клавиш на JAVASCRIPT</title>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n</head>\n<body>\n\n<script language=\"javascript\" type=\"text/javascript\">\n document.onkeydown = function checkKeycode(event)\n {\n  var keycode;\n  if(!event) var event = window.event;\n  if (event.keyCode) keycode = event.keyCode; // для IE\n  else if(event.which) keycode = event.which; // для всех браузеров\n  //msg.payload = keycode;\n  alert(\"keycode: \"+keycode); // Выводим сообщение\n  //return msg;\n  // Тут можно написать функции при нажатии нужных клавиш\n }\n</script>\n\n</body>\n</html>","output":"str","x":660,"y":280,"wires":[[]]},{"id":"3847f66e.54759a","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":890,"y":380,"wires":[]},{"id":"9c967e61.c8c8a","type":"ui_template","z":"9ab1c0c7.d7f57","d":true,"group":"8b7266fe.98fd18","name":"","order":1,"width":0,"height":0,"format":"<p>{{msg.payload}}</p>\n\n<script>\nvar theScope = scope;\n document.onkeydown = function checkKeycode(event)\n {\n  let keycode;\n  if(!event) var event = window.event;\n  if(event.which) keycode = event.which;\n \n    theScope.send({payload:{keycode:keycode, keyaction:\"Down\"}});\n }\n \n document.onkeyup = function checkKeycode(event)\n {\n  let keycode;\n  if(!event) var event = window.event;\n  if(event.which) keycode = event.which;\n \n    theScope.send({payload:{keycode:keycode, keyaction:\"Up\"}});\n }\n \n</script>\n","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","x":660,"y":360,"wires":[["3847f66e.54759a","a4c57318.f9982"]]},{"id":"ebf8c08.276674","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"test","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"","x":430,"y":380,"wires":[["9c967e61.c8c8a"]]},{"id":"a4c57318.f9982","type":"function","z":"9ab1c0c7.d7f57","name":"=>","func":"\nreturn msg;","outputs":1,"noerr":0,"x":650,"y":420,"wires":[["9c967e61.c8c8a"]]},{"id":"484a8485.5412dc","type":"debug","z":"9ab1c0c7.d7f57","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":620,"wires":[]},{"id":"72593593.9dbd5c","type":"ui_template","z":"9ab1c0c7.d7f57","group":"8b7266fe.98fd18","name":"","order":1,"width":0,"height":0,"format":"<p>{{msg.payload}}</p>\n\n<script>\nvar theScope = scope;\n\n\n    document.addEventListener('keydown', function(event) {\n        //theScope.send({payload:event.key});\n        theScope.send({payload:{key:event.key, keyaction:\"Down\"}});\n        });\n\n    document.addEventListener('keyup', function(event) {\n        //theScope.send({payload:\"Up\"});\n        theScope.send({payload:{key:event.key, keyaction:\"Up\"}});\n        });\n\n</script>\n","storeOutMessages":false,"fwdInMessages":false,"resendOnRefresh":true,"templateScope":"local","x":780,"y":600,"wires":[["484a8485.5412dc","6a84e5b8.ff448c"]]},{"id":"c4e96ffe.309e8","type":"inject","z":"9ab1c0c7.d7f57","name":"","topic":"","payload":"test","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":"","x":550,"y":620,"wires":[["72593593.9dbd5c"]]},{"id":"6a84e5b8.ff448c","type":"function","z":"9ab1c0c7.d7f57","name":"=>","func":"\nreturn msg;","outputs":1,"noerr":0,"x":770,"y":660,"wires":[["72593593.9dbd5c"]]},{"id":"6629ec8a.6f8934","type":"function","z":"97eec2ac.3243f","name":"??","func":"msg.payload = msg.payload ?? 10;\nreturn msg;","outputs":1,"noerr":0,"x":590,"y":1040,"wires":[["88b1f83c.75e928"]]},{"id":"f36713bf.10d33","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"1","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":290,"y":1040,"wires":[["5719f81a.35bc98","6629ec8a.6f8934"]]},{"id":"88b1f83c.75e928","type":"debug","z":"97eec2ac.3243f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":1040,"wires":[]},{"id":"5719f81a.35bc98","type":"function","z":"97eec2ac.3243f","name":"undefined","func":"msg.payload = undefined;\nreturn msg;","outputs":1,"noerr":0,"x":440,"y":1000,"wires":[["6629ec8a.6f8934","fa55b360.c2d16"]]},{"id":"fa55b360.c2d16","type":"debug","z":"97eec2ac.3243f","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":750,"y":1000,"wires":[]},{"id":"cb30250b.105458","type":"function","z":"97eec2ac.3243f","name":"user?. ??","func":"msg.payload = msg.payload?.user?.name ?? \"Bot\";\nreturn msg;","outputs":1,"noerr":0,"x":600,"y":1120,"wires":[["88b1f83c.75e928"]]},{"id":"630a4c86.d15bb4","type":"function","z":"97eec2ac.3243f","name":"user: {}","func":"msg.payload = {\n  user: {}\n};\nreturn msg;","outputs":1,"noerr":0,"x":400,"y":1120,"wires":[["cb30250b.105458"]]},{"id":"79548908.166448","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":200,"y":1120,"wires":[["630a4c86.d15bb4"]]},{"id":"a6684e7.0558db","type":"function","z":"97eec2ac.3243f","name":"user: {\"name\":\"Petr\",\"age\":18}","func":"msg.payload = {\n  user: {\"name\":\"Petr\",\"age\":18},\n};\nreturn msg;","outputs":1,"noerr":0,"x":470,"y":1180,"wires":[["cb30250b.105458"]]},{"id":"5fb77a59.e70b04","type":"inject","z":"97eec2ac.3243f","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":200,"y":1180,"wires":[["a6684e7.0558db"]]},{"id":"e81facee.98b88","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":true,"onceDelay":0.1,"x":310,"y":60,"wires":[["efb27f0a.9715f"]]},{"id":"efb27f0a.9715f","type":"function","z":"4a63d848.fb1dd8","name":"set \"alarm\"","func":"msg.payload = {\n    \"buttonCodes\":{\n        \"disarm\": {\n            \"pult1knopka1\": 121,\n            \"pult2knopka1\": 122\n        },\n        \"arm\": {\n            \"pult1knopka2\": 111,\n            \"pult2knopka2\": 112\n        }\n    }\n}\n\n\n\nflow.set(\"alarm\", msg.payload);\nreturn msg;","outputs":1,"noerr":0,"x":520,"y":60,"wires":[["b6b0a449.2beed8","6d49e47c.0df31c","609fa300.333bdc"]]},{"id":"7f80c7f4.c083c8","type":"split","z":"4a63d848.fb1dd8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":550,"y":420,"wires":[["664a4517.8f643c"]]},{"id":"664a4517.8f643c","type":"split","z":"4a63d848.fb1dd8","name":"","splt":"\\n","spltType":"str","arraySplt":1,"arraySpltType":"len","stream":false,"addname":"","x":370,"y":500,"wires":[["2e5ec666.24d51a"]]},{"id":"2e5ec666.24d51a","type":"function","z":"4a63d848.fb1dd8","name":"filter","func":"msg.payload = Object.entries(msg.payload).filter(item => Object.values(item).includes(msg.topic));\nreturn msg;\n","outputs":1,"noerr":0,"x":510,"y":500,"wires":[["1b82e190.e0e31e"]]},{"id":"d4f8a2ff.23cf3","type":"debug","z":"4a63d848.fb1dd8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload[0][0]","targetType":"msg","x":910,"y":580,"wires":[]},{"id":"1b82e190.e0e31e","type":"switch","z":"4a63d848.fb1dd8","name":"","property":"payload","propertyType":"msg","rules":[{"t":"nempty"}],"checkall":"true","repair":false,"outputs":1,"x":690,"y":540,"wires":[["d4f8a2ff.23cf3","2fb266cd.01219a"]]},{"id":"9f64e570.72b558","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"111","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":420,"wires":[["8db9b743.2fcd98"]]},{"id":"8db9b743.2fcd98","type":"change","z":"4a63d848.fb1dd8","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"payload","tot":"msg"},{"t":"set","p":"payload","pt":"msg","to":"alarm","tot":"flow"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":420,"wires":[["7f80c7f4.c083c8"]]},{"id":"b56c2709.d583b8","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"112","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":480,"wires":[["8db9b743.2fcd98"]]},{"id":"fc08ac70.ea461","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"121","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":540,"wires":[["8db9b743.2fcd98"]]},{"id":"dbb26bf8.1fe868","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"122","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":130,"y":600,"wires":[["8db9b743.2fcd98"]]},{"id":"2fb266cd.01219a","type":"debug","z":"4a63d848.fb1dd8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload[0][1]","targetType":"msg","x":910,"y":620,"wires":[]},{"id":"b6b0a449.2beed8","type":"debug","z":"4a63d848.fb1dd8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload.buttonCodes.arm","targetType":"msg","x":950,"y":100,"wires":[]},{"id":"6d49e47c.0df31c","type":"function","z":"4a63d848.fb1dd8","name":"","func":"msg.payload = Object.values(flow.get(\"alarm\").buttonCodes.arm);\nreturn msg;\n\n\n\n//.includes(input))\n","outputs":1,"noerr":0,"x":800,"y":40,"wires":[["9f0a789.f65c688"]]},{"id":"9f0a789.f65c688","type":"debug","z":"4a63d848.fb1dd8","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1020,"y":40,"wires":[]},{"id":"82764498.2a9c98","type":"debug","z":"4a63d848.fb1dd8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":160,"wires":[]},{"id":"609fa300.333bdc","type":"change","z":"4a63d848.fb1dd8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload in $each($flowContext(\"alarm\").buttonCodes.arm, function($k, $v) {$v})\t\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":160,"wires":[["82764498.2a9c98"]]},{"id":"9b71a151.46b6c","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"111","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":510,"y":140,"wires":[["14ffc725.aac389"]]},{"id":"80c4715e.21783","type":"debug","z":"4a63d848.fb1dd8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","x":1010,"y":220,"wires":[]},{"id":"14ffc725.aac389","type":"change","z":"4a63d848.fb1dd8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"(\t$data := $flowContext(\"alarm\").buttonCodes.arm;\t$arrcode := $each($data, function($v, $k) {$v = payload ? $k : false});\t$filter($arrcode, function($i) {$boolean($i)})\t)\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":820,"y":220,"wires":[["80c4715e.21783"]]},{"id":"fee7d38b.08f0b","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"112","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":510,"y":200,"wires":[["14ffc725.aac389"]]},{"id":"474dddd3.bc60a4","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"121","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":510,"y":260,"wires":[["14ffc725.aac389"]]},{"id":"373cf51d.f6120a","type":"inject","z":"4a63d848.fb1dd8","name":"","topic":"","payload":"122","payloadType":"num","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":510,"y":320,"wires":[["14ffc725.aac389"]]}]